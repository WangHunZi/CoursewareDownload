<!DOCTYPE html><html>
<head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>M4: C Read-Eval-Print-Loop (crepl)</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/><link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"/><meta name="next-head-count" content="5"/><link rel="preload" href="../../../_next/static/css/e993edd6a18ef4f0.css" as="style"/><link rel="stylesheet" href="../../../_next/static/css/e993edd6a18ef4f0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="../../../_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="../../../_next/static/chunks/webpack-f73d82589f972e7d.js" defer=""></script><script src="../../../_next/static/chunks/framework-66d32731bdd20e83.js" defer=""></script><script src="../../../_next/static/chunks/main-3929bf55b0f13a18.js" defer=""></script><script src="../../../_next/static/chunks/pages/_app-00b06920b385caf1.js" defer=""></script><script src="../../../_next/static/chunks/pages/%5b%5b...index%5d%5d-877ec949b69be209.js" defer=""></script><script src="../../../_next/static/a2FwJzUPGFGc0QcwaUr13/_buildManifest.js" defer=""></script><script src="../../../_next/static/a2FwJzUPGFGc0QcwaUr13/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="bg-slate-300/10"><div class="sticky top-0 z-40 w-full backdrop-blur flex-none border-b border-slate-900/10 bg-white/75 supports-backdrop-blur:bg-white/60"><div class="max-w-8xl mx-auto"><div class="py-4 border-b border-slate-900/10 lg:px-8 lg:border-0 dark:border-slate-300/10 mx-4 lg:mx-0"><div class="relative flex items-center"><a href="../../../index.html">Yanyan's wiki</a><form class="text-xs text-slate-500">Â forÂ <input type="text" name="token" class="font-mono text-xs w-16" maxLength="8"/></form><div class="relative hidden lg:flex items-center ml-4 pl-4 border-l"><nav class="text-sm leading-6 font-semibold text-slate-700 dark:text-slate-200"><ul class="flex space-x-8"><li><a class="hover:text-sky-500 dark:hover:text-sky-400" href="../../2025/index.html">æ“ä½œç³»ç»Ÿ (2025 æ˜¥)</a></li></ul></nav></div></div></div></div></div><div class="container mx-auto max-w-5xl flex flex-col min-h-screen px-4"><div class="wiki bg-neutral-200/10"><h1>M4: C Read-Eval-Print-Loop (crepl)</h1>
<div class="box yellow-box"><div><span class="float-left text-4xl mr-3 mt-2">â°</span><span class="font-serif text-lg border-b border-slate-600"><b>Soft Deadline: 2024 å¹´ 5 æœˆ 19 æ—¥ 23:59:59</b></span><div class="font-serif pt-2"><p><strong><red>ä½ éœ€è¦é¦–å…ˆé˜…è¯»<a href="Labs.html">å®éªŒé¡»çŸ¥</a>ï¼Œå…¶ä¸­åŒ…å«äº†ä»£ç è·å–æ–¹æ³•ã€æäº¤æ–¹æ³•ã€å¦‚ä½•æŸ¥çœ‹æäº¤ç»“æœç­‰</red></strong>ã€‚åœ¨å‘½ä»¤è¡Œä¸­ <code>git pull origin M4</code> ä¸‹è½½æ¡†æ¶ä»£ç ã€‚</p></div></div></div>
<div class="box slate-box"><div><span class="float-left text-4xl mr-3 mt-2">âš–ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>M4 - crepl</b></span><div class="font-serif pt-2"><p>è¯·è¾“å…¥ Token ç™»å½•ã€‚</p></div></div></div>
<h2>1. èƒŒæ™¯</h2>
<p>ç°ä»£ç¼–ç¨‹è¯­è¨€æä¾›äº¤äº’å¼è¯­è¨€è¿è¡Œç¯å¢ƒ <a href="https://en.wikipedia.org/wiki/Readâ€“evalâ€“print_loop">read-eval-print-loop</a> (REPL): python, node, å°±è¿ Java éƒ½å¼•å…¥äº† jshellã€‚ä¾‹å¦‚ Python Shell (ä»¥åŠæ›´æ–¹ä¾¿çš„ Jupyter Notebook) å¯ä»¥å¿«é€Ÿå¸®åŠ©å¤§å®¶è§£å†³é«˜ç­‰æ•°å­¦ä½œä¸šã€é«˜ç²¾åº¦è®¡ç®—ç­‰çƒ¦æ¼ï¼š</p>
<center><p><img src="../../img/python-repl.svg" alt=""/></p></center>
<p>ä½ ä¼šé¢„æœŸ C è¯­è¨€åŒæ ·ä¹Ÿå¯ä»¥å®ç° â€œäº¤äº’å¼â€ çš„ shellï¼Œæ”¯æŒå³æ—¶å®šä¹‰å‡½æ•°ï¼Œè€Œä¸”èƒ½è®¡ç®— C è¡¨è¾¾å¼çš„æ•°å€¼ã€‚å¦‚æœä½ è¾“å…¥ä¸€è¡Œä»£ç ï¼Œæ¯”å¦‚<code>strlen("Hello World")</code>ï¼Œè¿™æ®µä»£ç ä¼šç»å† gcc ç¼–è¯‘ã€åŠ¨æ€åŠ è½½ã€è°ƒç”¨æ‰§è¡Œï¼Œæœ€ç»ˆæŠŠä»£ç æ‰§è¡Œå¾—åˆ°çš„æ•°å€¼ <code>11</code> æ‰“å°åˆ°å±å¹•ä¸Šã€‚è¿™å°±æ˜¯æœ¬å®éªŒçš„å†…å®¹ã€‚</p>
<h2>2. å®éªŒæè¿°</h2>
<p><code>crepl</code> - é€è¡Œä» stdin ä¸­è¾“å…¥å•è¡Œ C è¯­è¨€ä»£ç ï¼Œå¹¶æ ¹æ®è¾“å…¥å†…å®¹åˆ†åˆ«å¤„ç†ï¼š</p>
<ul>
<li>å¦‚æœè¾“å…¥ä¸€ä¸ª C å‡½æ•°çš„å®šä¹‰ï¼Œåˆ™æŠŠå‡½æ•°ç¼–è¯‘å¹¶åŠ è½½åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­ï¼›</li>
<li>å¦‚æœè¾“å…¥æ˜¯ä¸€ä¸ª C è¯­è¨€è¡¨è¾¾å¼ï¼Œåˆ™æŠŠå®ƒçš„å€¼è¾“å‡ºã€‚</li>
</ul>
<h3>æ€»è§ˆ</h3>
<center>crepl</center>
<h3>æè¿°</h3>
<p>è§£é‡Šæ‰§è¡Œæ¯ä¸€è¡Œæ ‡å‡†è¾“å…¥ä¸­çš„ C <span class="red">â€œå•è¡Œâ€</span> ä»£ç  (å‡è®¾æˆ‘ä»¬åªä½¿ç”¨ <code>int</code> ç±»å‹ï¼Œå³æ‰€æœ‰è¾“å…¥çš„è¡¨è¾¾å¼éƒ½æ˜¯æ•´æ•°ï¼›å®šä¹‰å‡½æ•°çš„è¿”å›å€¼ä¹Ÿæ°¸è¿œæ˜¯æ•´æ•°)ï¼Œåˆ†å¦‚ä¸‹ä¸¤ç§æƒ…å†µï¼š</p>
<h4>(1) å‡½æ•°</h4>
<p>ä¸ºäº†ç®€åŒ–å®éªŒä¸æ“ä½œç³»ç»Ÿæ— å…³çš„ç»†èŠ‚ï¼Œå¦‚æœè¾“å…¥çš„å­—ç¬¦ä¸² (ä¸€è¡Œ) ä»¥ <code>int</code> å¼€å¤´ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</p>
<pre><code class="hljs language-c"><span class="hljs-type">int</span> <span class="hljs-title function_">fib</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> { <span class="hljs-keyword">return</span> (n <= <span class="hljs-number">1</span>) ? <span class="hljs-number">1</span> : fib(n - <span class="hljs-number">1</span>) + fib(n - <span class="hljs-number">2</span>); }
</code></pre>
<p>å‡½æ•°æ¥æ”¶è‹¥å¹² <code>int</code> ç±»å‹çš„å‚æ•°ï¼Œè¿”å›ä¸€ä¸ª <code>int</code> æ•°å€¼ã€‚å¦‚æœä¸€è¡Œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒå°†ä¼šç»è¿‡ gcc ç¼–è¯‘ï¼Œå¹¶è¢«åŠ è½½åˆ°å½“å‰è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­ã€‚å‡½æ•°å¯ä»¥å¼•ç”¨ä¹‹å‰å®šä¹‰è¿‡çš„å‡½æ•°ã€‚</p>
<h4>(2) è¡¨è¾¾å¼</h4>
<p>å¦‚æœä¸€è¡Œä¸æ˜¯ä»¥ <code>int</code> å¼€å¤´ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºè¿™ä¸€è¡Œæ˜¯ä¸€ä¸ª C è¯­è¨€çš„<strong>è¡¨è¾¾å¼</strong>ï¼Œå…¶ç±»å‹ä¸º <code>int</code>ï¼Œä¾‹å¦‚</p>
<pre><code class="hljs language-c"><span class="hljs-number">1</span> + <span class="hljs-number">2</span> || (fib(<span class="hljs-number">3</span>) * fib(<span class="hljs-number">4</span>))
</code></pre>
<div class="box blue-box"><div><span class="float-left text-4xl mr-3 mt-2">ğŸ—’ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>å®éªŒè¦æ±‚ï¼šå‡½æ•°å’Œè¡¨è¾¾å¼å‡å¯ä»¥è°ƒç”¨ä¹‹å‰å®šä¹‰è¿‡çš„å‡½æ•°</b></span><div class="font-serif pt-2"><p>è¿™å¯¹äºäº¤äº’å¼çš„ C Shell æ¥è¯´æ˜¯ â€œè‡ªç„¶â€ çš„éœ€æ±‚ã€‚æˆ‘ä»¬å‡è®¾ï¼Œå‡½æ•°å’Œè¡¨è¾¾å¼éƒ½ä¸ä¼šè®¿é—®å…¨å±€çš„çŠ¶æ€ (å˜é‡) æˆ–è°ƒç”¨ä»»ä½•åº“å‡½æ•°ã€‚å¦‚æœä¸€è¡Œæ—¢ä¸æ˜¯åˆæ³•çš„å‡½æ•° (ä¾‹å¦‚è°ƒç”¨äº†ä¸å…è®¸è°ƒç”¨çš„å‡½æ•°)ï¼Œä¹Ÿä¸æ˜¯åˆæ³•çš„è¡¨è¾¾å¼ï¼Œ<code>crepl</code> å¯ä»¥ä¸ä¿è¯å®ƒä»¬æ‰§è¡Œçš„ç»“æœ (ä¸ä¸€å®šè¦æŠ¥å‘Šé”™è¯¯ï¼Œä¾‹å¦‚ä½ çš„ç¨‹åºä¾ç„¶å¯ä»¥ç…§å¸¸ç¼–è¯‘æˆ–æ‰§è¡Œï¼Œä½†ä½ çš„ç¨‹åºè¦å°½é‡ä¸ä¼š crash)ï¼›é‡å¤å®šä¹‰é‡åå‡½æ•°ä½ ä¹Ÿå¯ä»¥å½“åš undefined behavior ä¸å¿…åšå‡ºè¿‡å¤šå¤„ç†â€”â€”æˆ‘ä»¬çš„æµ‹è¯•ç”¨ä¾‹ä¸­æ²¡æœ‰è¿™æ ·çš„æƒ…å†µã€‚</p></div></div></div>
<div class="box red-box"><div><span class="float-left text-4xl mr-3 mt-2">âš ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>å®ç°äº¤äº’å¼çš„ REPL</b></span><div class="font-serif pt-2"><p>åœ¨æœ¬å®éªŒä¸­ï¼Œæˆ‘ä»¬è¦æ±‚ä½ å®ç°äº¤äº’å¼çš„ REPLï¼Œå³ä¸»è¿›ç¨‹èƒ½å³æ—¶è·å¾—æ‰€æœ‰è¡¨è¾¾å¼çš„å€¼ï¼Œå› æ­¤è¯·ä¿è¯ä½ <strong>åœ¨æ¥æ”¶åˆ°è¡¨è¾¾å¼åç«‹å³æ‰“å°ï¼Œå¹¶ä½¿ç”¨ <code>fflush(stdout)</code> æ¸…ç©ºç¼“å†²åŒº</strong>ã€‚å·æ‡’çš„åšæ³•æ˜¯æŠŠæ‰€æœ‰è¡¨è¾¾å¼æ‹¼æ¥èµ·æ¥æˆä¸€ä¸ªç¨‹åºæ‰“å°ï¼›ä½†æœ¬å®éªŒä¸­ä¸èƒ½è¿™ä¹ˆåšã€‚</p></div></div></div>
<p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬çš„å‚è€ƒå®ç°ï¼š</p>
<center><p><img src="../../img/crepl-demo.gif" alt=""/></p></center>
<p>æˆ‘ä»¬çš„å‚è€ƒå®ç°è°ƒç”¨äº† pygments å®ç°äº†è¯­æ³•é«˜äº®ï¼Œå±•ç¤ºäº†ä¸€ç§å¯èƒ½æ€§ï¼Œä½†ä½ å®Œå…¨æ²¡æœ‰åšè¿™ä»¶äº‹æƒ…çš„å¿…è¦ï¼Œæˆ‘ä»¬ä¹Ÿä¸é¼“åŠ±è¿™ä¹ˆåšã€‚æˆ‘ä»¬å¯¹å¤§å®¶åªæœ‰æœ€ç®€çš„å®éªŒè¦æ±‚ï¼šä½ åªè¦ä½ ä¸ºæ¯ä¸€ä¸ªå‡½æ•°æˆ–è¡¨è¾¾å¼è¾“å‡ºä¸€è¡Œ (åŒ…å«ç»“æœ) å³å¯ï¼Œä¾‹å¦‚ä½ å¯ä»¥æŠŠä½ çš„ crepl å®ç°æˆè¿™æ ·ï¼š</p>
<pre><code class="hljs language-text">$ ./crepl-64
int gcd(int a, int b) { return b ? gcd(b, a % b) : a; }
OK.
gcd(256, 144) * gcd(56, 84)
= 448.
</code></pre>
<p>è¿™ä¸ªå®éªŒè¡¨æ˜ï¼Œç¼–è¯‘å’Œè§£é‡Šå¹¶æ²¡æœ‰æ˜ç¡®çš„è¾¹ç•Œâ€”â€”åœ¨ OpenJDK çš„å®ç°ä¸­ï¼Œå³ä¾¿æ˜¯ â€œè§£é‡Šå™¨â€ ä¹Ÿæ˜¯ç¼–è¯‘çš„ (åªæ˜¯æ²¡æœ‰ç»è¿‡ä¼˜åŒ–)ã€‚åŠ¨æ€ (just-in-time) æŠ€æœ¯åœ¨ç¨‹åºè¿è¡Œæ—¶ (è€Œéç¨‹åºæ‰§è¡Œå‰) è¿›è¡Œç¼–è¯‘ï¼Œå¹¶å°†ç¼–è¯‘å¾—åˆ°çš„äºŒè¿›åˆ¶ä»£ç  (æŒ‡ä»¤/æ•°æ®) åŠ¨æ€åŠ è½½ã€‚å…¶ä¸­æœ€æˆåŠŸçš„æ¡ˆä¾‹ä¹‹ä¸€æ˜¯ Sun (ç°åœ¨æ˜¯ Oracle) çš„ Java è™šæ‹Ÿæœº <a href="https://wiki.openjdk.java.net/display/HotSpot/Main">HotSpot</a> (ç°åœ¨æ˜¯OpenJDKçš„ä¸€éƒ¨åˆ†)ï¼Œå®ƒä½¿ Java å½»åº•æ‘†è„±äº† â€œæ€§èƒ½ä½ä¸‹â€ çš„è¯Ÿç—…ï¼Œä¹Ÿæ˜¯å¼•é¢† Web çƒ­æ½®çš„æ ¸å¿ƒåç«¯æŠ€æœ¯ã€‚å¦ä¸€ä¸ªæœ€æˆåŠŸçš„æ¡ˆä¾‹æ˜¯ JavaScript çš„ <a href="https://v8.dev/">V8 å¼•æ“</a>ã€‚å€ŸåŠ© Webkit/v8ï¼ŒChrome æˆåŠŸåœ°æŠŠå¾®è½¯å…¬å¸çš„ Internet Explorer æ‹–ä¸‹ç¥å›ï¼Œå¹¶ä¸”å¥ å®šäº† Google åœ¨äº’è”ç½‘æŠ€æœ¯é¢†åŸŸçš„éœ¸ä¸»åœ°ä½ã€‚</p>
<h2>3. æ­£ç¡®æ€§æ ‡å‡†</h2>
<p>ä½ åªè¦èƒ½æ­£ç¡®è§£æå•è¡Œçš„å‡½æ•° (ä»¥ <code>int</code> å¼€å¤´)ï¼Œå¹¶ä¸”é»˜è®¤å…¶ä»–è¾“å…¥éƒ½æ˜¯è¡¨è¾¾å¼å³å¯ã€‚æˆ‘ä»¬å¯èƒ½ä¼šè¾“å…¥ä¸åˆæ³•çš„ C ä»£ç  (ä¾‹å¦‚ä¸åˆæ³•çš„è¡¨è¾¾å¼)ï¼›ä½ çš„ç¨‹åºåº”è¯¥ç»™å‡ºé”™è¯¯æç¤ºè€Œä¸åº”è¯¥ crashã€‚ä½ å¯ä»¥åšå‡ºæ¯”è¾ƒå‹å¥½çš„å‡è®¾â€”â€”ä¸åƒä¹‹å‰çš„å®éªŒï¼Œä¼šä¸ºäº† â€œå¼ºè¿«â€ ä½ æŒæ¡æŸäº›çŸ¥è¯†è€Œä½¿ä½ ç–¯ç‹‚ Wrong Answerã€‚è¿™ä¸ªå®éªŒçº¯å±æ”¾æ¾ï¼ŒOnline Judge æ²¡æœ‰åˆéš¾ä½ çš„æµ‹è¯•ç”¨ä¾‹ï¼Œéƒ½å’Œ demo ä¸­çš„å·®ä¸å¤šã€‚</p>
<ul>
<li>æ³¨æ„æˆ‘ä»¬å…è®¸å‡½æ•°å’Œè¡¨è¾¾å¼è°ƒç”¨ä¹‹å‰ (åœ¨ crepl ä¸­) å®šä¹‰è¿‡çš„å‡½æ•°ï¼›</li>
<li>ä½ å¯ä»¥å‡è®¾æˆ‘ä»¬è¾“å…¥çš„å‘½ä»¤/è¡¨è¾¾å¼æ•°é‡ä¸è¶…è¿‡ 100 ä¸ªï¼›</li>
<li>æ³¨æ„ä½ å¤„åœ¨çš„è¿è¡Œç›®å½•å¯èƒ½æ²¡æœ‰å†™å…¥çš„æƒé™ã€‚å»ºè®®ä½ å°†åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶éƒ½æ”¾åœ¨ <code>/tmp/</code> ç›®å½•ä¸‹ã€‚å»ºè®®ä½¿ç”¨ <code>mkstemp</code> family API åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼›</li>
<li>ä¸»è¿›ç¨‹ç¡®å®æ±‚å‡ºäº†æ‰€æœ‰è¡¨è¾¾å¼çš„å€¼ã€‚</li>
<li>ç¦æ­¢ä½¿ç”¨ C æ ‡å‡†åº“ system å’Œ popenã€‚è¿™ç¨ç¨å¢åŠ äº†å®éªŒçš„éš¾åº¦ï¼Œä¸è¿‡å¹¶æ²¡æœ‰å¢åŠ å¤šå°‘ã€‚è¯·æŠŠè¿™ä¸ªé™åˆ¶ç†è§£æˆå¼ºè¿«å¤§å®¶æŒæ¡æ“ä½œç³»ç»ŸçŸ¥è¯†çš„è®­ç»ƒã€‚</li>
</ul>
<div class="box red-box"><div><span class="float-left text-4xl mr-3 mt-2">âš ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>å®ç¦æ­¢ä½¿ç”¨ system() å’Œ popen()</b></span><div class="font-serif pt-2"><p>ä¸ºäº† â€œå¼ºè¿«â€ å¤§å®¶å®ç°æ­£ç¡®çš„ REPLï¼Œè°ƒç”¨ system å’Œ popen ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚å¥½æ¶ˆæ¯æ˜¯è¿™ä¸ªå®éªŒæˆ‘ä»¬ä¸ç¦æ­¢ <code>exec</code> family çš„ç³»ç»Ÿè°ƒç”¨ï¼šexecl, execlp, execle, execv, execvp, execvpe éƒ½æ˜¯å…è®¸çš„ã€‚</p></div></div></div>
<h2>4. å®éªŒæŒ‡å—</h2>
<h3>4.1 è§£æè¯»å…¥çš„å‘½ä»¤</h3>
<p>æ¡†æ¶ä»£ç é‡Œå·²ç»åŒ…å«äº†è¯»å…¥å‘½ä»¤çš„å¾ªç¯ (çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªå° shell)ï¼Œå®ƒæ‰“å°å‡ºä¸€ä¸ªæç¤ºç¬¦ï¼Œç„¶åæ¥å—è¾“å…¥å¹¶è§£æï¼š</p>
<pre><code class="hljs language-c"><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"crepl> "</span>);
    fflush(<span class="hljs-built_in">stdout</span>);

    <span class="hljs-keyword">if</span> (!fgets(line, <span class="hljs-keyword">sizeof</span>(line), <span class="hljs-built_in">stdin</span>)) {
        <span class="hljs-keyword">break</span>;
    }

    <span class="hljs-comment">// To be implemented.</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Got %zu chars.\n"</span>, <span class="hljs-built_in">strlen</span>(line));
}
</code></pre>
<p>å½“ä½ åœ¨ç»ˆç«¯é‡ŒæŒ‰ä¸‹ Ctrl-dï¼Œä¼šç»“æŸ stdin è¾“å…¥æµï¼Œfgets ä¼šå¾—åˆ° <code>NULL</code>ã€‚</p>
<p>è¿™æ®µä»£ç é‡Œä¸€ä¸ªæœ‰è¶£çš„å°ç»†èŠ‚æ˜¯å¯¹ fflush çš„è°ƒç”¨ï¼šä½ ä¼šå‘ç°æŠŠå®ƒå»æ‰å¯¹ç¨‹åºçš„è¿è¡Œå¹¶æ²¡æœ‰ä»€ä¹ˆå½±å“ã€‚ä½†å¦‚æœä½ åœ¨ fgets ä¹‹å‰æ’å…¥ä¸€äº›å»¶è¿Ÿï¼Œä¾‹å¦‚ <code>sleep(1)</code>ï¼Œä½ ä¼šå‘ç° fgets ä¼š flush stdout çš„ç¼“å†²åŒºã€‚ä½† C æ ‡å‡†å¹¶æ²¡æœ‰è§„å®šè¿™ä¸ªè¡Œä¸ºï¼Œglibc åªæ˜¯å› ä¸ºå¤§å®¶ç”¨é”™å¾—å¤ªå¤šï¼Œä¸ºå¤§å®¶è´´å¿ƒåœ°å…œäº†â€”â€”å…¶å® System é¢†åŸŸè¿™ç§ â€œäº‹å®è¡Œä¸ºâ€ å¹¶ä¸å°‘è§ï¼Œå¤§å®¶é”™å¾—å¤šäº†ï¼Œæˆ‘ä»¬çš„åº“å‡½æ•°ã€ç¼–è¯‘å™¨ç­‰ä¸å¾—ä¸åšå‡ºé˜²å¾¡æ€§çš„è¡Œä¸ºå®¹å¿å¤§å®¶çŠ¯é”™ã€‚ä¸€ä¸ªä¾‹å­æ˜¯æŸä¸€æ—¶æœŸæœ¬çš„ gcc ä¼šéå¸¸æ¿€è¿›åœ°å¯¹èƒ½è¯æ˜çš„ undefined behavior è¿›è¡Œä¼˜åŒ–ï¼Œä½†å´å¯¼è‡´ä¸å°‘ä»¥å‰ â€œæ­£ç¡®â€ å·¥ä½œçš„ä»£ç çš„å´©æºƒï¼Œåˆ°æ–°ç‰ˆæœ¬é‡Œåè€Œä¸å†åšè¿™äº›æ¿€è¿›çš„ä¼˜åŒ–äº†ã€‚</p>
<p>å›åˆ°å®éªŒï¼Œåœ¨ä¸Šé¢çš„ä»£ç é‡Œï¼Œå¦‚æœè¯»å…¥çš„å­—ç¬¦ä¸²ä»¥ <code>int</code> å¼€å¤´ï¼Œä½ å°±å¯ä»¥å‡è®¾æ˜¯ä¸€ä¸ªå‡½æ•°ï¼›å¦åˆ™å°±å¯ä»¥å‡è®¾æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚</p>
<h3>4.2 æŠŠå‡½æ•°ç¼–è¯‘æˆå…±äº«åº“</h3>
<p>è¿™ä¸ªå®éªŒæœ€æ ¸å¿ƒçš„æŠ€æœ¯å¤„ç†ï¼Œå°±æ˜¯åœ¨ç¨‹åºçš„å¤–éƒ¨ï¼Œé€šè¿‡å¦ä¸€ä¸ªè¿›ç¨‹å®Œæˆä¸€å°æ®µä»£ç åˆ°äºŒè¿›åˆ¶ä»£ç çš„ç¼–è¯‘ã€‚å¯¹äºä¸€ä¸ªä¸€è¡Œçš„å‡½æ•°ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-c"><span class="hljs-type">int</span> <span class="hljs-title function_">gcd</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> { <span class="hljs-keyword">return</span> b ? gcd(b, a % b) : a; }
</code></pre>
<p>ç¼–è¯‘å™¨å¯ä»¥å°†å®ƒç¿»è¯‘æˆå¦‚ä¸‹æŒ‡ä»¤åºåˆ—ï¼š</p>
<pre><code class="hljs language-assembly">   0:    endbr64 
   4:    mov    %edi,%eax
   6:    test   %esi,%esi
   8:    je     13
   a:    cltd   
   b:    idiv   %esi
   d:    mov    %esi,%eax
   f:    mov    %edx,%esi
  11:    jmp    6
  13:    ret    
</code></pre>
<p>æˆ‘åªè¦è¯•å›¾å°†è¿™äº›ä»£ç å°è£…åœ¨ä¸€ä¸ªåŠ¨æ€è¿æ¥åº“ (å…±äº«åº“, shared object) ä¸­ï¼Œè¿™ä¸ªåº“å°± (gdb çš„æ±‡ç¼–ä»£ç ) å°±å¯ä»¥è¢«å…¶ä»–ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ è½½äº†ã€‚æ²¡é”™ï¼Œä½ åªéœ€è¦ <a href="M2.html">M2 (libco)</a> ä¸­çš„ç¼–è¯‘é€‰é¡¹å³å¯ã€‚</p>
<div class="box blue-box"><div><span class="float-left text-4xl mr-3 mt-2">â˜•ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>é€‰å–åˆé€‚çš„è·¯å¾„å’Œæ–‡ä»¶å</b></span><div class="font-serif pt-2"><p>å¦‚æœä½ çš„å·¥å…·åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶ï¼Œæœ‰å¯èƒ½ä¼šå¤±è´¥â€”â€”ä¾‹å¦‚ï¼Œä½ å¯èƒ½åœ¨ä¸€ä¸ªæ²¡æœ‰è®¿é—®æƒé™çš„å·¥ä½œç›®å½•ä¸Š (ä¾‹å¦‚æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ <code>/</code>)ã€‚åœ¨ <code>/tmp</code> ä¸­åˆ›å»ºä¸´æ—¶æ–‡ä»¶æ˜¯æ›´å®‰å…¨çš„åšæ³•ã€‚æ­¤å¤–ï¼Œglibc è¿˜ä¸ºæˆ‘ä»¬æä¾›äº† <code>mkstemp</code> family API è°ƒç”¨ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆåç§°å”¯ä¸€çš„ä¸´æ—¶æ–‡ä»¶ã€‚</p></div></div></div>
<p>é™¤äº†ç¼–è¯‘å’Œå‘½åçš„é—®é¢˜ï¼Œå¤§å®¶å¯èƒ½ä¼šæ„Ÿåˆ°å›°æƒ‘æ˜¯ï¼Œå¦‚æœæˆ‘çš„å‡½æ•°è°ƒç”¨äº†å…¶ä»–å‡½æ•°æ€ä¹ˆåŠï¼Ÿ</p>
<pre><code class="hljs language-c"><span class="hljs-type">int</span> <span class="hljs-title function_">foo</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> bar() + baz(); }
</code></pre>
<p>ä½ ä¸å¦¨è¯•ç€ç¼–è¯‘è¿™ä¸ªç¨‹åºâ€¦â€¦å®ƒç«Ÿç„¶å¯ä»¥è¢«ç¼–è¯‘ï¼æ‰€ä»¥å¿½ç•¥æ‰€æœ‰çš„ warnings å°±å¥½äº†ï¼æœ€åï¼Œä¸ºäº†å·©å›ºå¤§å®¶åœ¨ä¸Šä¸€ä¸ªå®éªŒä¸­å­¦è¿‡çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬é™åˆ¶ä½ ä¸èƒ½ä½¿ç”¨ libc ä¸­çš„ system å’Œ popenâ€”â€”å®ƒä»¬ä¼šè®©å®éªŒå˜å¾—æœ‰äº›è¿‡äºç®€å•ã€‚</p>
<div class="box blue-box"><div><span class="float-left text-4xl mr-3 mt-2">â˜•ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>å¹¶ä¸æ€»æ˜¯å¯ä»¥ç¼–è¯‘ ğŸ˜‚</b></span><div class="font-serif pt-2"><p>æœ‰äº›ç¼–è¯‘å™¨ (ä¾‹å¦‚ Linux gcc/clang) ä¼šç»™å‡ºä¸€ä¸ªè­¦å‘Šï¼Œä½†è­¦å‘Šå˜›ï¼Œæˆ‘ä»¬å¯ä»¥æ— è§†ã€‚æœ‰äº›ç¼–è¯‘å™¨çš„é»˜è®¤è¡Œä¸ºåˆ™æ˜¯æ‹’ç»ç¼–è¯‘ (ä¾‹å¦‚ macOS clang)ã€‚ä½ çŒœæƒ³ç¼–è¯‘å™¨åº”è¯¥èƒ½è°ƒæ§è¿™ä¸ªè¡Œä¸ºã€‚äºæ˜¯ç”šè‡³ä¸ç”¨ç¿»æ‰‹å†Œï¼ŒAI å°±ä¼šå‘Šè¯‰ä½  <code>-Wno-implicit-function-declaration</code> èƒ½å¤Ÿç»•è¿‡è¿™ä¸ªæ£€æŸ¥ã€‚</p></div></div></div>
<h3>4.3 æŠŠè¡¨è¾¾å¼ç¼–è¯‘æˆå…±äº«åº“</h3>
<p>æŠŠå‡½æ•°ç¼–è¯‘æˆå…±äº«åº“æ˜¯å¸¸è§„æ“ä½œâ€”â€”åº“å‡½æ•°ã€‚ä½†è¡¨è¾¾å¼æ€ä¹ˆåŠï¼Ÿåˆç”¨åˆ°æˆ‘ä»¬è¿™é—¨è¯¾é‡Œåå¤ç”¨çš„å°æŠ€å·§äº†ï¼šæˆ‘ä»¬å¯ä»¥åšä¸€ä¸ª wrapper å‘€ï¼æ¯å½“æˆ‘ä»¬æ”¶åˆ°ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¾‹å¦‚ <code>gcd(256, 144)</code> çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ â€œäººå·¥ç”Ÿæˆâ€ ä¸€æ®µ C ä»£ç </p>
<pre><code class="hljs language-c"><span class="hljs-type">int</span> __expr_wrapper_4() {
    <span class="hljs-keyword">return</span> gcd(<span class="hljs-number">256</span>, <span class="hljs-number">144</span>);
}
</code></pre>
<p>æ³¨æ„åˆ°å‡½æ•°åé‡Œçš„æ•°å­—â€”â€”æˆ‘ä»¬é€šè¿‡åŠ ä¸Šæ•°å­—ä¸ºè¡¨è¾¾å¼ç”Ÿæˆä¸ä¸€æ ·çš„åå­—ã€‚æˆ‘ä»¬çš„è¡¨è¾¾å¼å˜æˆä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå®ƒç¼–è¯‘æˆå…±äº«åº“äº†ã€‚æŠŠåŠ¨æ€åº“åŠ è½½åˆ°åœ°å€ç©ºé—´å¹¶å¾—åˆ° <code>__expr_wrapper_4</code> çš„åœ°å€ï¼Œç›´æ¥è¿›è¡Œå‡½æ•°è°ƒç”¨å°±èƒ½å¾—åˆ°è¡¨è¾¾å¼çš„å€¼äº†ã€‚è¿™æ˜¯ä¸€ä¸ªå°å°çš„ hackâ€”â€”ä½†å®é™…ä¸ŠçœŸæ­£çš„ REPL ä¹Ÿä¼šç”¨ç±»ä¼¼çš„æ–¹å¼å¤„ç†åŠ¨æ€ç”Ÿæˆçš„ä»£ç ï¼šç»™å®ƒä¸€ä¸ªä¸´æ—¶çš„ â€œåå­—â€ã€‚</p>
<h3>4.4 å…±äº«åº“çš„åŠ è½½</h3>
<div class="box blue-box"><div><span class="float-left text-4xl mr-3 mt-2">â˜•ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>çœ‹çœ‹ GPT æ˜¯æ€ä¹ˆå›ç­”çš„ï¼Ÿ</b></span><div class="font-serif pt-2"><p>Q: æˆ‘æœ‰ä¸€ä¸ª .so æ–‡ä»¶ã€‚æˆ‘å¦‚ä½•åœ¨ C è¯­è¨€é‡ŒåŠ è½½å®ƒï¼Œå¹¶ä¸”è°ƒç”¨å…¶ä¸­å®šä¹‰çš„å‡½æ•°fooï¼Ÿ</p></div></div></div>
<p>GPT-4-turbo å›å¤ (æ— åˆ èŠ‚)ï¼šåœ¨ C è¯­è¨€ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨åŠ¨æ€é“¾æ¥åº“ (Dynamic Linking Library) çš„åŠŸèƒ½æ¥åŠ è½½ <code>.so</code> æ–‡ä»¶å¹¶è°ƒç”¨å…¶ä¸­çš„å‡½æ•°ã€‚<code>.so</code> æ–‡ä»¶æ˜¯åœ¨ç±» Unix ç³»ç»Ÿ (å¦‚ Linux) ä¸­ä½¿ç”¨çš„å…±äº«åº“ (Shared Library) æ ¼å¼ã€‚ä¸‹é¢æ˜¯å¦‚ä½•åœ¨Cè¯­è¨€ä¸­åŠ è½½ <code>.so</code> æ–‡ä»¶å¹¶è°ƒç”¨å…¶ä¸­çš„ <code>foo</code> å‡½æ•°çš„æ­¥éª¤ï¼š</p>
<ol>
<li><strong>åŒ…å«å¿…è¦çš„å¤´æ–‡ä»¶</strong>ï¼šä½ éœ€è¦åŒ…å« <code><dlfcn.h></code> å¤´æ–‡ä»¶ï¼Œå®ƒæä¾›äº†åŠ¨æ€åŠ è½½åº“æ‰€éœ€çš„ <code>dlopen</code>ã€<code>dlsym</code> å’Œ <code>dlclose</code> å‡½æ•°ã€‚</li>
<li><strong>æ‰“å¼€å…±äº«åº“</strong>ï¼šä½¿ç”¨ <code>dlopen()</code> å‡½æ•°åŠ è½½ <code>.so</code> æ–‡ä»¶ã€‚ä½ éœ€è¦æä¾›åº“çš„è·¯å¾„å’ŒåŠ è½½æ¨¡å¼ï¼ˆé€šå¸¸æ˜¯ <code>RTLD_LAZY</code> æˆ– <code>RTLD_NOW</code>ï¼‰ã€‚</li>
<li><strong>è·å–å‡½æ•°æŒ‡é’ˆ</strong>ï¼šä½¿ç”¨ <code>dlsym()</code> å‡½æ•°è·å–å…±äº«åº“ä¸­å‡½æ•°çš„åœ°å€ã€‚ä½ éœ€è¦æä¾› <code>dlopen</code> è¿”å›çš„å¥æŸ„å’Œå‡½æ•°åã€‚</li>
<li><strong>è°ƒç”¨å‡½æ•°</strong>ï¼šé€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°ã€‚</li>
<li><strong>å…³é—­å…±äº«åº“</strong>ï¼šä½¿ç”¨ <code>dlclose()</code> å…³é—­åŠ è½½çš„åº“ã€‚</li>
</ol>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºå¦‚ä½•å®ç°ä¸Šè¿°æ­¥éª¤ï¼š</p>
<pre><code class="hljs language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string"><stdio.h></span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string"><dlfcn.h></span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-type">void</span> *handle;
    <span class="hljs-type">void</span> (*foo)(<span class="hljs-type">void</span>);  <span class="hljs-comment">// å‡è®¾fooæ˜¯ä¸€ä¸ªæ— å‚æ•°ä¸”è¿”å›voidçš„å‡½æ•°</span>
    <span class="hljs-type">char</span> *error;

    <span class="hljs-comment">// æ‰“å¼€å…±äº«åº“</span>
    handle = dlopen(<span class="hljs-string">"libfoo.so"</span>, RTLD_LAZY);
    <span class="hljs-keyword">if</span> (!handle) {
        <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">"%s\n"</span>, dlerror());
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }

    <span class="hljs-comment">// æ¸…é™¤ç°æœ‰çš„é”™è¯¯</span>
    dlerror();

    <span class="hljs-comment">// è·å–fooå‡½æ•°çš„åœ°å€</span>
    *(<span class="hljs-type">void</span> **) (&foo) = dlsym(handle, <span class="hljs-string">"foo"</span>);
    <span class="hljs-keyword">if</span> ((error = dlerror()) != <span class="hljs-literal">NULL</span>)  {
        <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">"%s\n"</span>, error);
        dlclose(handle);
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }

    <span class="hljs-comment">// è°ƒç”¨å‡½æ•°</span>
    foo();

    <span class="hljs-comment">// å…³é—­å…±äº«åº“</span>
    dlclose(handle);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼š</p>
<ul>
<li>ç¡®ä¿åœ¨è°ƒç”¨ <code>dlopen()</code> æ—¶æä¾›æ­£ç¡®çš„åº“è·¯å¾„ã€‚å¦‚æœåº“ä¸åœ¨æ ‡å‡†è·¯å¾„ä¸­ï¼Œä½ éœ€è¦æä¾›å®Œæ•´è·¯å¾„ã€‚</li>
<li>ä½¿ç”¨ <code>dlsym()</code> æ—¶ï¼Œä½ éœ€è¦æ­£ç¡®åœ°å¤„ç†ç±»å‹è½¬æ¢ï¼Œç¡®ä¿å‡½æ•°æŒ‡é’ˆçš„ç±»å‹ä¸å®é™…å‡½æ•°çš„ç±»å‹åŒ¹é…ã€‚</li>
<li>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåº”è¯¥æ£€æŸ¥æ¯ä¸ªåŠ¨æ€é“¾æ¥å‡½æ•°çš„è¿”å›å€¼ä»¥ç¡®ä¿æ“ä½œæˆåŠŸã€‚</li>
</ul>
<div class="box red-box"><div><span class="float-left text-4xl mr-3 mt-2">âš ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>ç‚¹è¯„</b></span><div class="font-serif pt-2"><p>AI ç”Ÿæˆçš„ä»£ç ä¼šç»™ä½ ä¸€ç§ â€œæˆ‘ä¹Ÿè¡Œâ€ çš„é”™è§‰â€”â€”å®é™…ä¸Š jyy åœ¨æ—¶é—´å‹åŠ›ä¸‹ï¼Œé¢å¯¹å¿…é¡»å®Œæˆçš„ä»»åŠ¡ï¼Œä¹Ÿç»å¸¸è¢«è¿«ä¸åŠ æ€è€ƒåœ°ä½¿ç”¨ AI ç”Ÿæˆçš„å„ç±»ä»£ç /å‘½ä»¤ã€‚ä½†æ— è®ºå¦‚ä½•ï¼Œåœ¨å­¦ä¹ é˜¶æ®µï¼Œæ‰‹å†Œéƒ½æ˜¯ä¸å¯æ›¿ä»£çš„ï¼šå»è¯»ä¸€è¯» dlopen ç›¸å…³åº“å‡½æ•°çš„æ‰‹å†Œã€elf (5)ï¼Œâ€œéå†â€ å¼çš„å­¦ä¹ å¯ä»¥è®©ä½ ä¸ä»…äº†è§£ â€œè¿™ä¸€ä¸ªçŸ¥è¯†â€ï¼Œè¿˜å¯ä»¥å‘æ•£åœ°ç†è§£ä¸å®ƒç›¸å…³çš„æ¦‚å¿µä½“ç³»ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸æ¨èç›´æ¥è®© AI è§£å†³é—®é¢˜ã€‚å³ä¾¿ä½ ä½¿ç”¨äº† AI ç”Ÿæˆçš„ä»£ç ï¼Œå¥½å¥½ç ”è¯»å’Œå­¦ä¹ ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p></div></div></div></div></div><div class="bg-neutral-100 text-center text-neutral-600 dark:bg-neutral-600 dark:text-neutral-200 lg:text-left"><div class="bg-neutral-200 p-6 text-center dark:bg-neutral-700"><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons License: BY-NC 4.0</a><br/><a href="https://beian.miit.gov.cn/">è‹ ICP å¤‡ 2020049101 å·</a></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h1: \"h1\",\n    p: \"p\",\n    strong: \"strong\",\n    a: \"a\",\n    code: \"code\",\n    h2: \"h2\",\n    img: \"img\",\n    ul: \"ul\",\n    li: \"li\",\n    h3: \"h3\",\n    h4: \"h4\",\n    pre: \"pre\",\n    span: \"span\",\n    ol: \"ol\"\n  }, _provideComponents(), props.components), {Box, Submission} = _components;\n  if (!Box) _missingMdxReference(\"Box\", true);\n  if (!Submission) _missingMdxReference(\"Submission\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.h1, {\n      children: \"M4: C Read-Eval-Print-Loop (crepl)\"\n    }), \"\\n\", _jsx(Box, {\n      logo: \"â°\",\n      title: \"Soft Deadline: 2024 å¹´ 5 æœˆ 19 æ—¥ 23:59:59\",\n      children: _jsxs(_components.p, {\n        children: [_jsx(_components.strong, {\n          children: _jsxs(\"red\", {\n            children: [\"ä½ éœ€è¦é¦–å…ˆé˜…è¯»\", _jsx(_components.a, {\n              href: \"Labs.md\",\n              children: \"å®éªŒé¡»çŸ¥\"\n            }), \"ï¼Œå…¶ä¸­åŒ…å«äº†ä»£ç è·å–æ–¹æ³•ã€æäº¤æ–¹æ³•ã€å¦‚ä½•æŸ¥çœ‹æäº¤ç»“æœç­‰\"]\n          })\n        }), \"ã€‚åœ¨å‘½ä»¤è¡Œä¸­ \", _jsx(_components.code, {\n          children: \"git pull origin M4\"\n        }), \" ä¸‹è½½æ¡†æ¶ä»£ç ã€‚\"]\n      })\n    }), \"\\n\", _jsx(Submission, {\n      course: \"OS2024\",\n      module: \"M4\",\n      desc: \"M4 - crepl\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"1. èƒŒæ™¯\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"ç°ä»£ç¼–ç¨‹è¯­è¨€æä¾›äº¤äº’å¼è¯­è¨€è¿è¡Œç¯å¢ƒ \", _jsx(_components.a, {\n        href: \"https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop\",\n        children: \"read-eval-print-loop\"\n      }), \" (REPL): python, node, å°±è¿ Java éƒ½å¼•å…¥äº† jshellã€‚ä¾‹å¦‚ Python Shell (ä»¥åŠæ›´æ–¹ä¾¿çš„ Jupyter Notebook) å¯ä»¥å¿«é€Ÿå¸®åŠ©å¤§å®¶è§£å†³é«˜ç­‰æ•°å­¦ä½œä¸šã€é«˜ç²¾åº¦è®¡ç®—ç­‰çƒ¦æ¼ï¼š\"]\n    }), \"\\n\", _jsx(\"center\", {\n      children: _jsx(_components.p, {\n        children: _jsx(_components.img, {\n          src: \"../../img/python-repl.svg\",\n          alt: \"\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"ä½ ä¼šé¢„æœŸ C è¯­è¨€åŒæ ·ä¹Ÿå¯ä»¥å®ç° â€œäº¤äº’å¼â€ çš„ shellï¼Œæ”¯æŒå³æ—¶å®šä¹‰å‡½æ•°ï¼Œè€Œä¸”èƒ½è®¡ç®— C è¡¨è¾¾å¼çš„æ•°å€¼ã€‚å¦‚æœä½ è¾“å…¥ä¸€è¡Œä»£ç ï¼Œæ¯”å¦‚\", _jsx(_components.code, {\n        children: \"strlen(\\\"Hello World\\\")\"\n      }), \"ï¼Œè¿™æ®µä»£ç ä¼šç»å† gcc ç¼–è¯‘ã€åŠ¨æ€åŠ è½½ã€è°ƒç”¨æ‰§è¡Œï¼Œæœ€ç»ˆæŠŠä»£ç æ‰§è¡Œå¾—åˆ°çš„æ•°å€¼ \", _jsx(_components.code, {\n        children: \"11\"\n      }), \" æ‰“å°åˆ°å±å¹•ä¸Šã€‚è¿™å°±æ˜¯æœ¬å®éªŒçš„å†…å®¹ã€‚\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"2. å®éªŒæè¿°\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.code, {\n        children: \"crepl\"\n      }), \" - é€è¡Œä» stdin ä¸­è¾“å…¥å•è¡Œ C è¯­è¨€ä»£ç ï¼Œå¹¶æ ¹æ®è¾“å…¥å†…å®¹åˆ†åˆ«å¤„ç†ï¼š\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"å¦‚æœè¾“å…¥ä¸€ä¸ª C å‡½æ•°çš„å®šä¹‰ï¼Œåˆ™æŠŠå‡½æ•°ç¼–è¯‘å¹¶åŠ è½½åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­ï¼›\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"å¦‚æœè¾“å…¥æ˜¯ä¸€ä¸ª C è¯­è¨€è¡¨è¾¾å¼ï¼Œåˆ™æŠŠå®ƒçš„å€¼è¾“å‡ºã€‚\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"æ€»è§ˆ\"\n    }), \"\\n\", _jsx(\"center\", {\n      children: \"crepl\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"æè¿°\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"è§£é‡Šæ‰§è¡Œæ¯ä¸€è¡Œæ ‡å‡†è¾“å…¥ä¸­çš„ C \", _jsx(\"span\", {\n        class: \"red\",\n        children: \"â€œå•è¡Œâ€\"\n      }), \" ä»£ç  (å‡è®¾æˆ‘ä»¬åªä½¿ç”¨ \", _jsx(_components.code, {\n        children: \"int\"\n      }), \" ç±»å‹ï¼Œå³æ‰€æœ‰è¾“å…¥çš„è¡¨è¾¾å¼éƒ½æ˜¯æ•´æ•°ï¼›å®šä¹‰å‡½æ•°çš„è¿”å›å€¼ä¹Ÿæ°¸è¿œæ˜¯æ•´æ•°)ï¼Œåˆ†å¦‚ä¸‹ä¸¤ç§æƒ…å†µï¼š\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      children: \"(1) å‡½æ•°\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"ä¸ºäº†ç®€åŒ–å®éªŒä¸æ“ä½œç³»ç»Ÿæ— å…³çš„ç»†èŠ‚ï¼Œå¦‚æœè¾“å…¥çš„å­—ç¬¦ä¸² (ä¸€è¡Œ) ä»¥ \", _jsx(_components.code, {\n        children: \"int\"\n      }), \" å¼€å¤´ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-c\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"int\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"fib\"\n        }), _jsxs(_components.span, {\n          className: \"hljs-params\",\n          children: [\"(\", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"int\"\n          }), \" n)\"]\n        }), \" { \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" (n \u003c= \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \") ? \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \" : fib(n - \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \") + fib(n - \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \"); }\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"å‡½æ•°æ¥æ”¶è‹¥å¹² \", _jsx(_components.code, {\n        children: \"int\"\n      }), \" ç±»å‹çš„å‚æ•°ï¼Œè¿”å›ä¸€ä¸ª \", _jsx(_components.code, {\n        children: \"int\"\n      }), \" æ•°å€¼ã€‚å¦‚æœä¸€è¡Œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒå°†ä¼šç»è¿‡ gcc ç¼–è¯‘ï¼Œå¹¶è¢«åŠ è½½åˆ°å½“å‰è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­ã€‚å‡½æ•°å¯ä»¥å¼•ç”¨ä¹‹å‰å®šä¹‰è¿‡çš„å‡½æ•°ã€‚\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      children: \"(2) è¡¨è¾¾å¼\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"å¦‚æœä¸€è¡Œä¸æ˜¯ä»¥ \", _jsx(_components.code, {\n        children: \"int\"\n      }), \" å¼€å¤´ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºè¿™ä¸€è¡Œæ˜¯ä¸€ä¸ª C è¯­è¨€çš„\", _jsx(_components.strong, {\n        children: \"è¡¨è¾¾å¼\"\n      }), \"ï¼Œå…¶ç±»å‹ä¸º \", _jsx(_components.code, {\n        children: \"int\"\n      }), \"ï¼Œä¾‹å¦‚\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-c\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \" + \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"2\"\n        }), \" || (fib(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"3\"\n        }), \") * fib(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"4\"\n        }), \"))\\n\"]\n      })\n    }), \"\\n\", _jsx(Box, {\n      logo: \"ğŸ—’ï¸\",\n      title: \"å®éªŒè¦æ±‚ï¼šå‡½æ•°å’Œè¡¨è¾¾å¼å‡å¯ä»¥è°ƒç”¨ä¹‹å‰å®šä¹‰è¿‡çš„å‡½æ•°\",\n      children: _jsxs(_components.p, {\n        children: [\"è¿™å¯¹äºäº¤äº’å¼çš„ C Shell æ¥è¯´æ˜¯ â€œè‡ªç„¶â€ çš„éœ€æ±‚ã€‚æˆ‘ä»¬å‡è®¾ï¼Œå‡½æ•°å’Œè¡¨è¾¾å¼éƒ½ä¸ä¼šè®¿é—®å…¨å±€çš„çŠ¶æ€ (å˜é‡) æˆ–è°ƒç”¨ä»»ä½•åº“å‡½æ•°ã€‚å¦‚æœä¸€è¡Œæ—¢ä¸æ˜¯åˆæ³•çš„å‡½æ•° (ä¾‹å¦‚è°ƒç”¨äº†ä¸å…è®¸è°ƒç”¨çš„å‡½æ•°)ï¼Œä¹Ÿä¸æ˜¯åˆæ³•çš„è¡¨è¾¾å¼ï¼Œ\", _jsx(_components.code, {\n          children: \"crepl\"\n        }), \" å¯ä»¥ä¸ä¿è¯å®ƒä»¬æ‰§è¡Œçš„ç»“æœ (ä¸ä¸€å®šè¦æŠ¥å‘Šé”™è¯¯ï¼Œä¾‹å¦‚ä½ çš„ç¨‹åºä¾ç„¶å¯ä»¥ç…§å¸¸ç¼–è¯‘æˆ–æ‰§è¡Œï¼Œä½†ä½ çš„ç¨‹åºè¦å°½é‡ä¸ä¼š crash)ï¼›é‡å¤å®šä¹‰é‡åå‡½æ•°ä½ ä¹Ÿå¯ä»¥å½“åš undefined behavior ä¸å¿…åšå‡ºè¿‡å¤šå¤„ç†â€”â€”æˆ‘ä»¬çš„æµ‹è¯•ç”¨ä¾‹ä¸­æ²¡æœ‰è¿™æ ·çš„æƒ…å†µã€‚\"]\n      })\n    }), \"\\n\", _jsx(Box, {\n      logo: \"âš ï¸\",\n      title: \"å®ç°äº¤äº’å¼çš„ REPL\",\n      children: _jsxs(_components.p, {\n        children: [\"åœ¨æœ¬å®éªŒä¸­ï¼Œæˆ‘ä»¬è¦æ±‚ä½ å®ç°äº¤äº’å¼çš„ REPLï¼Œå³ä¸»è¿›ç¨‹èƒ½å³æ—¶è·å¾—æ‰€æœ‰è¡¨è¾¾å¼çš„å€¼ï¼Œå› æ­¤è¯·ä¿è¯ä½ \", _jsxs(_components.strong, {\n          children: [\"åœ¨æ¥æ”¶åˆ°è¡¨è¾¾å¼åç«‹å³æ‰“å°ï¼Œå¹¶ä½¿ç”¨ \", _jsx(_components.code, {\n            children: \"fflush(stdout)\"\n          }), \" æ¸…ç©ºç¼“å†²åŒº\"]\n        }), \"ã€‚å·æ‡’çš„åšæ³•æ˜¯æŠŠæ‰€æœ‰è¡¨è¾¾å¼æ‹¼æ¥èµ·æ¥æˆä¸€ä¸ªç¨‹åºæ‰“å°ï¼›ä½†æœ¬å®éªŒä¸­ä¸èƒ½è¿™ä¹ˆåšã€‚\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ä»¥ä¸‹æ˜¯æˆ‘ä»¬çš„å‚è€ƒå®ç°ï¼š\"\n    }), \"\\n\", _jsx(\"center\", {\n      children: _jsx(_components.p, {\n        children: _jsx(_components.img, {\n          src: \"../../img/crepl-demo.gif\",\n          alt: \"\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"æˆ‘ä»¬çš„å‚è€ƒå®ç°è°ƒç”¨äº† pygments å®ç°äº†è¯­æ³•é«˜äº®ï¼Œå±•ç¤ºäº†ä¸€ç§å¯èƒ½æ€§ï¼Œä½†ä½ å®Œå…¨æ²¡æœ‰åšè¿™ä»¶äº‹æƒ…çš„å¿…è¦ï¼Œæˆ‘ä»¬ä¹Ÿä¸é¼“åŠ±è¿™ä¹ˆåšã€‚æˆ‘ä»¬å¯¹å¤§å®¶åªæœ‰æœ€ç®€çš„å®éªŒè¦æ±‚ï¼šä½ åªè¦ä½ ä¸ºæ¯ä¸€ä¸ªå‡½æ•°æˆ–è¡¨è¾¾å¼è¾“å‡ºä¸€è¡Œ (åŒ…å«ç»“æœ) å³å¯ï¼Œä¾‹å¦‚ä½ å¯ä»¥æŠŠä½ çš„ crepl å®ç°æˆè¿™æ ·ï¼š\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"hljs language-text\",\n        children: \"$ ./crepl-64\\nint gcd(int a, int b) { return b ? gcd(b, a % b) : a; }\\nOK.\\ngcd(256, 144) * gcd(56, 84)\\n= 448.\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"è¿™ä¸ªå®éªŒè¡¨æ˜ï¼Œç¼–è¯‘å’Œè§£é‡Šå¹¶æ²¡æœ‰æ˜ç¡®çš„è¾¹ç•Œâ€”â€”åœ¨ OpenJDK çš„å®ç°ä¸­ï¼Œå³ä¾¿æ˜¯ â€œè§£é‡Šå™¨â€ ä¹Ÿæ˜¯ç¼–è¯‘çš„ (åªæ˜¯æ²¡æœ‰ç»è¿‡ä¼˜åŒ–)ã€‚åŠ¨æ€ (just-in-time) æŠ€æœ¯åœ¨ç¨‹åºè¿è¡Œæ—¶ (è€Œéç¨‹åºæ‰§è¡Œå‰) è¿›è¡Œç¼–è¯‘ï¼Œå¹¶å°†ç¼–è¯‘å¾—åˆ°çš„äºŒè¿›åˆ¶ä»£ç  (æŒ‡ä»¤/æ•°æ®) åŠ¨æ€åŠ è½½ã€‚å…¶ä¸­æœ€æˆåŠŸçš„æ¡ˆä¾‹ä¹‹ä¸€æ˜¯ Sun (ç°åœ¨æ˜¯ Oracle) çš„ Java è™šæ‹Ÿæœº \", _jsx(_components.a, {\n        href: \"https://wiki.openjdk.java.net/display/HotSpot/Main\",\n        children: \"HotSpot\"\n      }), \" (ç°åœ¨æ˜¯OpenJDKçš„ä¸€éƒ¨åˆ†)ï¼Œå®ƒä½¿ Java å½»åº•æ‘†è„±äº† â€œæ€§èƒ½ä½ä¸‹â€ çš„è¯Ÿç—…ï¼Œä¹Ÿæ˜¯å¼•é¢† Web çƒ­æ½®çš„æ ¸å¿ƒåç«¯æŠ€æœ¯ã€‚å¦ä¸€ä¸ªæœ€æˆåŠŸçš„æ¡ˆä¾‹æ˜¯ JavaScript çš„ \", _jsx(_components.a, {\n        href: \"https://v8.dev/\",\n        children: \"V8 å¼•æ“\"\n      }), \"ã€‚å€ŸåŠ© Webkit/v8ï¼ŒChrome æˆåŠŸåœ°æŠŠå¾®è½¯å…¬å¸çš„ Internet Explorer æ‹–ä¸‹ç¥å›ï¼Œå¹¶ä¸”å¥ å®šäº† Google åœ¨äº’è”ç½‘æŠ€æœ¯é¢†åŸŸçš„éœ¸ä¸»åœ°ä½ã€‚\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"3. æ­£ç¡®æ€§æ ‡å‡†\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"ä½ åªè¦èƒ½æ­£ç¡®è§£æå•è¡Œçš„å‡½æ•° (ä»¥ \", _jsx(_components.code, {\n        children: \"int\"\n      }), \" å¼€å¤´)ï¼Œå¹¶ä¸”é»˜è®¤å…¶ä»–è¾“å…¥éƒ½æ˜¯è¡¨è¾¾å¼å³å¯ã€‚æˆ‘ä»¬å¯èƒ½ä¼šè¾“å…¥ä¸åˆæ³•çš„ C ä»£ç  (ä¾‹å¦‚ä¸åˆæ³•çš„è¡¨è¾¾å¼)ï¼›ä½ çš„ç¨‹åºåº”è¯¥ç»™å‡ºé”™è¯¯æç¤ºè€Œä¸åº”è¯¥ crashã€‚ä½ å¯ä»¥åšå‡ºæ¯”è¾ƒå‹å¥½çš„å‡è®¾â€”â€”ä¸åƒä¹‹å‰çš„å®éªŒï¼Œä¼šä¸ºäº† â€œå¼ºè¿«â€ ä½ æŒæ¡æŸäº›çŸ¥è¯†è€Œä½¿ä½ ç–¯ç‹‚ Wrong Answerã€‚è¿™ä¸ªå®éªŒçº¯å±æ”¾æ¾ï¼ŒOnline Judge æ²¡æœ‰åˆéš¾ä½ çš„æµ‹è¯•ç”¨ä¾‹ï¼Œéƒ½å’Œ demo ä¸­çš„å·®ä¸å¤šã€‚\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"æ³¨æ„æˆ‘ä»¬å…è®¸å‡½æ•°å’Œè¡¨è¾¾å¼è°ƒç”¨ä¹‹å‰ (åœ¨ crepl ä¸­) å®šä¹‰è¿‡çš„å‡½æ•°ï¼›\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"ä½ å¯ä»¥å‡è®¾æˆ‘ä»¬è¾“å…¥çš„å‘½ä»¤/è¡¨è¾¾å¼æ•°é‡ä¸è¶…è¿‡ 100 ä¸ªï¼›\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"æ³¨æ„ä½ å¤„åœ¨çš„è¿è¡Œç›®å½•å¯èƒ½æ²¡æœ‰å†™å…¥çš„æƒé™ã€‚å»ºè®®ä½ å°†åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶éƒ½æ”¾åœ¨ \", _jsx(_components.code, {\n          children: \"/tmp/\"\n        }), \" ç›®å½•ä¸‹ã€‚å»ºè®®ä½¿ç”¨ \", _jsx(_components.code, {\n          children: \"mkstemp\"\n        }), \" family API åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼›\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"ä¸»è¿›ç¨‹ç¡®å®æ±‚å‡ºäº†æ‰€æœ‰è¡¨è¾¾å¼çš„å€¼ã€‚\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"ç¦æ­¢ä½¿ç”¨ C æ ‡å‡†åº“ system å’Œ popenã€‚è¿™ç¨ç¨å¢åŠ äº†å®éªŒçš„éš¾åº¦ï¼Œä¸è¿‡å¹¶æ²¡æœ‰å¢åŠ å¤šå°‘ã€‚è¯·æŠŠè¿™ä¸ªé™åˆ¶ç†è§£æˆå¼ºè¿«å¤§å®¶æŒæ¡æ“ä½œç³»ç»ŸçŸ¥è¯†çš„è®­ç»ƒã€‚\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(Box, {\n      logo: \"âš ï¸\",\n      title: \"å®ç¦æ­¢ä½¿ç”¨ system() å’Œ popen()\",\n      children: _jsxs(_components.p, {\n        children: [\"ä¸ºäº† â€œå¼ºè¿«â€ å¤§å®¶å®ç°æ­£ç¡®çš„ REPLï¼Œè°ƒç”¨ system å’Œ popen ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚å¥½æ¶ˆæ¯æ˜¯è¿™ä¸ªå®éªŒæˆ‘ä»¬ä¸ç¦æ­¢ \", _jsx(_components.code, {\n          children: \"exec\"\n        }), \" family çš„ç³»ç»Ÿè°ƒç”¨ï¼šexecl, execlp, execle, execv, execvp, execvpe éƒ½æ˜¯å…è®¸çš„ã€‚\"]\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"4. å®éªŒæŒ‡å—\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"4.1 è§£æè¯»å…¥çš„å‘½ä»¤\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"æ¡†æ¶ä»£ç é‡Œå·²ç»åŒ…å«äº†è¯»å…¥å‘½ä»¤çš„å¾ªç¯ (çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªå° shell)ï¼Œå®ƒæ‰“å°å‡ºä¸€ä¸ªæç¤ºç¬¦ï¼Œç„¶åæ¥å—è¾“å…¥å¹¶è§£æï¼š\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-c\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"while\"\n        }), \" (\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \") {\\n    \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"printf\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"crepl\u003e \\\"\"\n        }), \");\\n    fflush(\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"stdout\"\n        }), \");\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (!fgets(line, \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"sizeof\"\n        }), \"(line), \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"stdin\"\n        }), \")) {\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"break\"\n        }), \";\\n    }\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// To be implemented.\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"printf\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"Got %zu chars.\\\\n\\\"\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"strlen\"\n        }), \"(line));\\n}\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"å½“ä½ åœ¨ç»ˆç«¯é‡ŒæŒ‰ä¸‹ Ctrl-dï¼Œä¼šç»“æŸ stdin è¾“å…¥æµï¼Œfgets ä¼šå¾—åˆ° \", _jsx(_components.code, {\n        children: \"NULL\"\n      }), \"ã€‚\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"è¿™æ®µä»£ç é‡Œä¸€ä¸ªæœ‰è¶£çš„å°ç»†èŠ‚æ˜¯å¯¹ fflush çš„è°ƒç”¨ï¼šä½ ä¼šå‘ç°æŠŠå®ƒå»æ‰å¯¹ç¨‹åºçš„è¿è¡Œå¹¶æ²¡æœ‰ä»€ä¹ˆå½±å“ã€‚ä½†å¦‚æœä½ åœ¨ fgets ä¹‹å‰æ’å…¥ä¸€äº›å»¶è¿Ÿï¼Œä¾‹å¦‚ \", _jsx(_components.code, {\n        children: \"sleep(1)\"\n      }), \"ï¼Œä½ ä¼šå‘ç° fgets ä¼š flush stdout çš„ç¼“å†²åŒºã€‚ä½† C æ ‡å‡†å¹¶æ²¡æœ‰è§„å®šè¿™ä¸ªè¡Œä¸ºï¼Œglibc åªæ˜¯å› ä¸ºå¤§å®¶ç”¨é”™å¾—å¤ªå¤šï¼Œä¸ºå¤§å®¶è´´å¿ƒåœ°å…œäº†â€”â€”å…¶å® System é¢†åŸŸè¿™ç§ â€œäº‹å®è¡Œä¸ºâ€ å¹¶ä¸å°‘è§ï¼Œå¤§å®¶é”™å¾—å¤šäº†ï¼Œæˆ‘ä»¬çš„åº“å‡½æ•°ã€ç¼–è¯‘å™¨ç­‰ä¸å¾—ä¸åšå‡ºé˜²å¾¡æ€§çš„è¡Œä¸ºå®¹å¿å¤§å®¶çŠ¯é”™ã€‚ä¸€ä¸ªä¾‹å­æ˜¯æŸä¸€æ—¶æœŸæœ¬çš„ gcc ä¼šéå¸¸æ¿€è¿›åœ°å¯¹èƒ½è¯æ˜çš„ undefined behavior è¿›è¡Œä¼˜åŒ–ï¼Œä½†å´å¯¼è‡´ä¸å°‘ä»¥å‰ â€œæ­£ç¡®â€ å·¥ä½œçš„ä»£ç çš„å´©æºƒï¼Œåˆ°æ–°ç‰ˆæœ¬é‡Œåè€Œä¸å†åšè¿™äº›æ¿€è¿›çš„ä¼˜åŒ–äº†ã€‚\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"å›åˆ°å®éªŒï¼Œåœ¨ä¸Šé¢çš„ä»£ç é‡Œï¼Œå¦‚æœè¯»å…¥çš„å­—ç¬¦ä¸²ä»¥ \", _jsx(_components.code, {\n        children: \"int\"\n      }), \" å¼€å¤´ï¼Œä½ å°±å¯ä»¥å‡è®¾æ˜¯ä¸€ä¸ªå‡½æ•°ï¼›å¦åˆ™å°±å¯ä»¥å‡è®¾æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"4.2 æŠŠå‡½æ•°ç¼–è¯‘æˆå…±äº«åº“\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"è¿™ä¸ªå®éªŒæœ€æ ¸å¿ƒçš„æŠ€æœ¯å¤„ç†ï¼Œå°±æ˜¯åœ¨ç¨‹åºçš„å¤–éƒ¨ï¼Œé€šè¿‡å¦ä¸€ä¸ªè¿›ç¨‹å®Œæˆä¸€å°æ®µä»£ç åˆ°äºŒè¿›åˆ¶ä»£ç çš„ç¼–è¯‘ã€‚å¯¹äºä¸€ä¸ªä¸€è¡Œçš„å‡½æ•°ï¼Œæ¯”å¦‚ï¼š\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-c\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"int\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"gcd\"\n        }), _jsxs(_components.span, {\n          className: \"hljs-params\",\n          children: [\"(\", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"int\"\n          }), \" a, \", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"int\"\n          }), \" b)\"]\n        }), \" { \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" b ? gcd(b, a % b) : a; }\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ç¼–è¯‘å™¨å¯ä»¥å°†å®ƒç¿»è¯‘æˆå¦‚ä¸‹æŒ‡ä»¤åºåˆ—ï¼š\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"hljs language-assembly\",\n        children: \"   0:    endbr64 \\n   4:    mov    %edi,%eax\\n   6:    test   %esi,%esi\\n   8:    je     13\\n   a:    cltd   \\n   b:    idiv   %esi\\n   d:    mov    %esi,%eax\\n   f:    mov    %edx,%esi\\n  11:    jmp    6\\n  13:    ret    \\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"æˆ‘åªè¦è¯•å›¾å°†è¿™äº›ä»£ç å°è£…åœ¨ä¸€ä¸ªåŠ¨æ€è¿æ¥åº“ (å…±äº«åº“, shared object) ä¸­ï¼Œè¿™ä¸ªåº“å°± (gdb çš„æ±‡ç¼–ä»£ç ) å°±å¯ä»¥è¢«å…¶ä»–ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ è½½äº†ã€‚æ²¡é”™ï¼Œä½ åªéœ€è¦ \", _jsx(_components.a, {\n        href: \"M2.md\",\n        children: \"M2 (libco)\"\n      }), \" ä¸­çš„ç¼–è¯‘é€‰é¡¹å³å¯ã€‚\"]\n    }), \"\\n\", _jsx(Box, {\n      logo: \"â˜•ï¸\",\n      title: \"é€‰å–åˆé€‚çš„è·¯å¾„å’Œæ–‡ä»¶å\",\n      children: _jsxs(_components.p, {\n        children: [\"å¦‚æœä½ çš„å·¥å…·åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶ï¼Œæœ‰å¯èƒ½ä¼šå¤±è´¥â€”â€”ä¾‹å¦‚ï¼Œä½ å¯èƒ½åœ¨ä¸€ä¸ªæ²¡æœ‰è®¿é—®æƒé™çš„å·¥ä½œç›®å½•ä¸Š (ä¾‹å¦‚æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ \", _jsx(_components.code, {\n          children: \"/\"\n        }), \")ã€‚åœ¨ \", _jsx(_components.code, {\n          children: \"/tmp\"\n        }), \" ä¸­åˆ›å»ºä¸´æ—¶æ–‡ä»¶æ˜¯æ›´å®‰å…¨çš„åšæ³•ã€‚æ­¤å¤–ï¼Œglibc è¿˜ä¸ºæˆ‘ä»¬æä¾›äº† \", _jsx(_components.code, {\n          children: \"mkstemp\"\n        }), \" family API è°ƒç”¨ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆåç§°å”¯ä¸€çš„ä¸´æ—¶æ–‡ä»¶ã€‚\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"é™¤äº†ç¼–è¯‘å’Œå‘½åçš„é—®é¢˜ï¼Œå¤§å®¶å¯èƒ½ä¼šæ„Ÿåˆ°å›°æƒ‘æ˜¯ï¼Œå¦‚æœæˆ‘çš„å‡½æ•°è°ƒç”¨äº†å…¶ä»–å‡½æ•°æ€ä¹ˆåŠï¼Ÿ\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-c\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"int\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"foo\"\n        }), _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"()\"\n        }), \" { \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" bar() + baz(); }\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ä½ ä¸å¦¨è¯•ç€ç¼–è¯‘è¿™ä¸ªç¨‹åºâ€¦â€¦å®ƒç«Ÿç„¶å¯ä»¥è¢«ç¼–è¯‘ï¼æ‰€ä»¥å¿½ç•¥æ‰€æœ‰çš„ warnings å°±å¥½äº†ï¼æœ€åï¼Œä¸ºäº†å·©å›ºå¤§å®¶åœ¨ä¸Šä¸€ä¸ªå®éªŒä¸­å­¦è¿‡çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬é™åˆ¶ä½ ä¸èƒ½ä½¿ç”¨ libc ä¸­çš„ system å’Œ popenâ€”â€”å®ƒä»¬ä¼šè®©å®éªŒå˜å¾—æœ‰äº›è¿‡äºç®€å•ã€‚\"\n    }), \"\\n\", _jsx(Box, {\n      logo: \"â˜•ï¸\",\n      title: \"å¹¶ä¸æ€»æ˜¯å¯ä»¥ç¼–è¯‘ ğŸ˜‚\",\n      children: _jsxs(_components.p, {\n        children: [\"æœ‰äº›ç¼–è¯‘å™¨ (ä¾‹å¦‚ Linux gcc/clang) ä¼šç»™å‡ºä¸€ä¸ªè­¦å‘Šï¼Œä½†è­¦å‘Šå˜›ï¼Œæˆ‘ä»¬å¯ä»¥æ— è§†ã€‚æœ‰äº›ç¼–è¯‘å™¨çš„é»˜è®¤è¡Œä¸ºåˆ™æ˜¯æ‹’ç»ç¼–è¯‘ (ä¾‹å¦‚ macOS clang)ã€‚ä½ çŒœæƒ³ç¼–è¯‘å™¨åº”è¯¥èƒ½è°ƒæ§è¿™ä¸ªè¡Œä¸ºã€‚äºæ˜¯ç”šè‡³ä¸ç”¨ç¿»æ‰‹å†Œï¼ŒAI å°±ä¼šå‘Šè¯‰ä½  \", _jsx(_components.code, {\n          children: \"-Wno-implicit-function-declaration\"\n        }), \" èƒ½å¤Ÿç»•è¿‡è¿™ä¸ªæ£€æŸ¥ã€‚\"]\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"4.3 æŠŠè¡¨è¾¾å¼ç¼–è¯‘æˆå…±äº«åº“\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"æŠŠå‡½æ•°ç¼–è¯‘æˆå…±äº«åº“æ˜¯å¸¸è§„æ“ä½œâ€”â€”åº“å‡½æ•°ã€‚ä½†è¡¨è¾¾å¼æ€ä¹ˆåŠï¼Ÿåˆç”¨åˆ°æˆ‘ä»¬è¿™é—¨è¯¾é‡Œåå¤ç”¨çš„å°æŠ€å·§äº†ï¼šæˆ‘ä»¬å¯ä»¥åšä¸€ä¸ª wrapper å‘€ï¼æ¯å½“æˆ‘ä»¬æ”¶åˆ°ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¾‹å¦‚ \", _jsx(_components.code, {\n        children: \"gcd(256, 144)\"\n      }), \" çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ â€œäººå·¥ç”Ÿæˆâ€ ä¸€æ®µ C ä»£ç \"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-c\",\n        children: [_jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"int\"\n        }), \" __expr_wrapper_4() {\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" gcd(\", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"256\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"144\"\n        }), \");\\n}\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"æ³¨æ„åˆ°å‡½æ•°åé‡Œçš„æ•°å­—â€”â€”æˆ‘ä»¬é€šè¿‡åŠ ä¸Šæ•°å­—ä¸ºè¡¨è¾¾å¼ç”Ÿæˆä¸ä¸€æ ·çš„åå­—ã€‚æˆ‘ä»¬çš„è¡¨è¾¾å¼å˜æˆä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå®ƒç¼–è¯‘æˆå…±äº«åº“äº†ã€‚æŠŠåŠ¨æ€åº“åŠ è½½åˆ°åœ°å€ç©ºé—´å¹¶å¾—åˆ° \", _jsx(_components.code, {\n        children: \"__expr_wrapper_4\"\n      }), \" çš„åœ°å€ï¼Œç›´æ¥è¿›è¡Œå‡½æ•°è°ƒç”¨å°±èƒ½å¾—åˆ°è¡¨è¾¾å¼çš„å€¼äº†ã€‚è¿™æ˜¯ä¸€ä¸ªå°å°çš„ hackâ€”â€”ä½†å®é™…ä¸ŠçœŸæ­£çš„ REPL ä¹Ÿä¼šç”¨ç±»ä¼¼çš„æ–¹å¼å¤„ç†åŠ¨æ€ç”Ÿæˆçš„ä»£ç ï¼šç»™å®ƒä¸€ä¸ªä¸´æ—¶çš„ â€œåå­—â€ã€‚\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"4.4 å…±äº«åº“çš„åŠ è½½\"\n    }), \"\\n\", _jsx(Box, {\n      logo: \"â˜•ï¸\",\n      title: \"çœ‹çœ‹ GPT æ˜¯æ€ä¹ˆå›ç­”çš„ï¼Ÿ\",\n      children: _jsx(_components.p, {\n        children: \"Q: æˆ‘æœ‰ä¸€ä¸ª .so æ–‡ä»¶ã€‚æˆ‘å¦‚ä½•åœ¨ C è¯­è¨€é‡ŒåŠ è½½å®ƒï¼Œå¹¶ä¸”è°ƒç”¨å…¶ä¸­å®šä¹‰çš„å‡½æ•°fooï¼Ÿ\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"GPT-4-turbo å›å¤ (æ— åˆ èŠ‚)ï¼šåœ¨ C è¯­è¨€ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨åŠ¨æ€é“¾æ¥åº“ (Dynamic Linking Library) çš„åŠŸèƒ½æ¥åŠ è½½ \", _jsx(_components.code, {\n        children: \".so\"\n      }), \" æ–‡ä»¶å¹¶è°ƒç”¨å…¶ä¸­çš„å‡½æ•°ã€‚\", _jsx(_components.code, {\n        children: \".so\"\n      }), \" æ–‡ä»¶æ˜¯åœ¨ç±» Unix ç³»ç»Ÿ (å¦‚ Linux) ä¸­ä½¿ç”¨çš„å…±äº«åº“ (Shared Library) æ ¼å¼ã€‚ä¸‹é¢æ˜¯å¦‚ä½•åœ¨Cè¯­è¨€ä¸­åŠ è½½ \", _jsx(_components.code, {\n        children: \".so\"\n      }), \" æ–‡ä»¶å¹¶è°ƒç”¨å…¶ä¸­çš„ \", _jsx(_components.code, {\n        children: \"foo\"\n      }), \" å‡½æ•°çš„æ­¥éª¤ï¼š\"]\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"åŒ…å«å¿…è¦çš„å¤´æ–‡ä»¶\"\n        }), \"ï¼šä½ éœ€è¦åŒ…å« \", _jsx(_components.code, {\n          children: \"\u003cdlfcn.h\u003e\"\n        }), \" å¤´æ–‡ä»¶ï¼Œå®ƒæä¾›äº†åŠ¨æ€åŠ è½½åº“æ‰€éœ€çš„ \", _jsx(_components.code, {\n          children: \"dlopen\"\n        }), \"ã€\", _jsx(_components.code, {\n          children: \"dlsym\"\n        }), \" å’Œ \", _jsx(_components.code, {\n          children: \"dlclose\"\n        }), \" å‡½æ•°ã€‚\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"æ‰“å¼€å…±äº«åº“\"\n        }), \"ï¼šä½¿ç”¨ \", _jsx(_components.code, {\n          children: \"dlopen()\"\n        }), \" å‡½æ•°åŠ è½½ \", _jsx(_components.code, {\n          children: \".so\"\n        }), \" æ–‡ä»¶ã€‚ä½ éœ€è¦æä¾›åº“çš„è·¯å¾„å’ŒåŠ è½½æ¨¡å¼ï¼ˆé€šå¸¸æ˜¯ \", _jsx(_components.code, {\n          children: \"RTLD_LAZY\"\n        }), \" æˆ– \", _jsx(_components.code, {\n          children: \"RTLD_NOW\"\n        }), \"ï¼‰ã€‚\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"è·å–å‡½æ•°æŒ‡é’ˆ\"\n        }), \"ï¼šä½¿ç”¨ \", _jsx(_components.code, {\n          children: \"dlsym()\"\n        }), \" å‡½æ•°è·å–å…±äº«åº“ä¸­å‡½æ•°çš„åœ°å€ã€‚ä½ éœ€è¦æä¾› \", _jsx(_components.code, {\n          children: \"dlopen\"\n        }), \" è¿”å›çš„å¥æŸ„å’Œå‡½æ•°åã€‚\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"è°ƒç”¨å‡½æ•°\"\n        }), \"ï¼šé€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°ã€‚\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"å…³é—­å…±äº«åº“\"\n        }), \"ï¼šä½¿ç”¨ \", _jsx(_components.code, {\n          children: \"dlclose()\"\n        }), \" å…³é—­åŠ è½½çš„åº“ã€‚\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºå¦‚ä½•å®ç°ä¸Šè¿°æ­¥éª¤ï¼š\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"hljs language-c\",\n        children: [_jsxs(_components.span, {\n          className: \"hljs-meta\",\n          children: [\"#\", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"include\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\u003cstdio.h\u003e\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"hljs-meta\",\n          children: [\"#\", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"include\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\u003cdlfcn.h\u003e\"\n          })]\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"int\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-title function_\",\n          children: \"main\"\n        }), _jsx(_components.span, {\n          className: \"hljs-params\",\n          children: \"()\"\n        }), \" {\\n    \", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"void\"\n        }), \" *handle;\\n    \", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"void\"\n        }), \" (*foo)(\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"void\"\n        }), \");  \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// å‡è®¾fooæ˜¯ä¸€ä¸ªæ— å‚æ•°ä¸”è¿”å›voidçš„å‡½æ•°\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"char\"\n        }), \" *error;\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// æ‰“å¼€å…±äº«åº“\"\n        }), \"\\n    handle = dlopen(\", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"libfoo.so\\\"\"\n        }), \", RTLD_LAZY);\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" (!handle) {\\n        \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"fprintf\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"stderr\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"%s\\\\n\\\"\"\n        }), \", dlerror());\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \";\\n    }\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// æ¸…é™¤ç°æœ‰çš„é”™è¯¯\"\n        }), \"\\n    dlerror();\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// è·å–fooå‡½æ•°çš„åœ°å€\"\n        }), \"\\n    *(\", _jsx(_components.span, {\n          className: \"hljs-type\",\n          children: \"void\"\n        }), \" **) (\u0026foo) = dlsym(handle, \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"foo\\\"\"\n        }), \");\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"if\"\n        }), \" ((error = dlerror()) != \", _jsx(_components.span, {\n          className: \"hljs-literal\",\n          children: \"NULL\"\n        }), \")  {\\n        \", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"fprintf\"\n        }), \"(\", _jsx(_components.span, {\n          className: \"hljs-built_in\",\n          children: \"stderr\"\n        }), \", \", _jsx(_components.span, {\n          className: \"hljs-string\",\n          children: \"\\\"%s\\\\n\\\"\"\n        }), \", error);\\n        dlclose(handle);\\n        \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"1\"\n        }), \";\\n    }\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// è°ƒç”¨å‡½æ•°\"\n        }), \"\\n    foo();\\n\\n    \", _jsx(_components.span, {\n          className: \"hljs-comment\",\n          children: \"// å…³é—­å…±äº«åº“\"\n        }), \"\\n    dlclose(handle);\\n    \", _jsx(_components.span, {\n          className: \"hljs-keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"hljs-number\",\n          children: \"0\"\n        }), \";\\n}\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"æ³¨æ„\"\n      }), \"ï¼š\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"ç¡®ä¿åœ¨è°ƒç”¨ \", _jsx(_components.code, {\n          children: \"dlopen()\"\n        }), \" æ—¶æä¾›æ­£ç¡®çš„åº“è·¯å¾„ã€‚å¦‚æœåº“ä¸åœ¨æ ‡å‡†è·¯å¾„ä¸­ï¼Œä½ éœ€è¦æä¾›å®Œæ•´è·¯å¾„ã€‚\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"ä½¿ç”¨ \", _jsx(_components.code, {\n          children: \"dlsym()\"\n        }), \" æ—¶ï¼Œä½ éœ€è¦æ­£ç¡®åœ°å¤„ç†ç±»å‹è½¬æ¢ï¼Œç¡®ä¿å‡½æ•°æŒ‡é’ˆçš„ç±»å‹ä¸å®é™…å‡½æ•°çš„ç±»å‹åŒ¹é…ã€‚\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåº”è¯¥æ£€æŸ¥æ¯ä¸ªåŠ¨æ€é“¾æ¥å‡½æ•°çš„è¿”å›å€¼ä»¥ç¡®ä¿æ“ä½œæˆåŠŸã€‚\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(Box, {\n      logo: \"âš ï¸\",\n      title: \"ç‚¹è¯„\",\n      children: _jsx(_components.p, {\n        children: \"AI ç”Ÿæˆçš„ä»£ç ä¼šç»™ä½ ä¸€ç§ â€œæˆ‘ä¹Ÿè¡Œâ€ çš„é”™è§‰â€”â€”å®é™…ä¸Š jyy åœ¨æ—¶é—´å‹åŠ›ä¸‹ï¼Œé¢å¯¹å¿…é¡»å®Œæˆçš„ä»»åŠ¡ï¼Œä¹Ÿç»å¸¸è¢«è¿«ä¸åŠ æ€è€ƒåœ°ä½¿ç”¨ AI ç”Ÿæˆçš„å„ç±»ä»£ç /å‘½ä»¤ã€‚ä½†æ— è®ºå¦‚ä½•ï¼Œåœ¨å­¦ä¹ é˜¶æ®µï¼Œæ‰‹å†Œéƒ½æ˜¯ä¸å¯æ›¿ä»£çš„ï¼šå»è¯»ä¸€è¯» dlopen ç›¸å…³åº“å‡½æ•°çš„æ‰‹å†Œã€elf (5)ï¼Œâ€œéå†â€ å¼çš„å­¦ä¹ å¯ä»¥è®©ä½ ä¸ä»…äº†è§£ â€œè¿™ä¸€ä¸ªçŸ¥è¯†â€ï¼Œè¿˜å¯ä»¥å‘æ•£åœ°ç†è§£ä¸å®ƒç›¸å…³çš„æ¦‚å¿µä½“ç³»ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸æ¨èç›´æ¥è®© AI è§£å†³é—®é¢˜ã€‚å³ä¾¿ä½ ä½¿ç”¨äº† AI ç”Ÿæˆçš„ä»£ç ï¼Œå¥½å¥½ç ”è¯»å’Œå­¦ä¹ ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚\"\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}},"frontmatter":{"title":"M4: C Read-Eval-Print-Loop (crepl)"}},"__N_SSG":true},"page":"/[[...index]]","query":{"index":["OS","2024","labs","M4.md"]},"buildId":"a2FwJzUPGFGc0QcwaUr13","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body>
</html>