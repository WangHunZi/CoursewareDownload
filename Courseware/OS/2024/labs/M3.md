<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>M3: GPT-2 å¹¶è¡Œæ¨ç† (gpt.c)</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css"/><meta name="next-head-count" content="5"/><link rel="preload" href="../../../_next/static/css/e993edd6a18ef4f0.css" as="style"/><link rel="stylesheet" href="../../../_next/static/css/e993edd6a18ef4f0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="../../../_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="../../../_next/static/chunks/webpack-f73d82589f972e7d.js" defer=""></script><script src="../../../_next/static/chunks/framework-66d32731bdd20e83.js" defer=""></script><script src="../../../_next/static/chunks/main-3929bf55b0f13a18.js" defer=""></script><script src="../../../_next/static/chunks/pages/_app-00b06920b385caf1.js" defer=""></script><script src="../../../_next/static/chunks/pages/[[...index]]-877ec949b69be209.js" defer=""></script><script src="../../../_next/static/a2FwJzUPGFGc0QcwaUr13/_buildManifest.js" defer=""></script><script src="../../../_next/static/a2FwJzUPGFGc0QcwaUr13/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="bg-slate-300/10"><div class="sticky top-0 z-40 w-full backdrop-blur flex-none border-b border-slate-900/10 bg-white/75 supports-backdrop-blur:bg-white/60"><div class="max-w-8xl mx-auto"><div class="py-4 border-b border-slate-900/10 lg:px-8 lg:border-0 dark:border-slate-300/10 mx-4 lg:mx-0"><div class="relative flex items-center"><a href="../../../index.html">Yanyan&#x27;s wiki</a><form class="text-xs text-slate-500">Â forÂ <input type="text" name="token" class="font-mono text-xs w-16" maxLength="8"/></form><div class="relative hidden lg:flex items-center ml-4 pl-4 border-l"><nav class="text-sm leading-6 font-semibold text-slate-700 dark:text-slate-200"><ul class="flex space-x-8"><li><a class="hover:text-sky-500 dark:hover:text-sky-400" href="../../2025/index.html">æ“ä½œç³»ç»Ÿ (2025 æ˜¥)</a></li></ul></nav></div></div></div></div></div><div class="container mx-auto max-w-5xl flex flex-col min-h-screen px-4"><div class="wiki bg-neutral-200/10"><h1>M3: GPT-2 å¹¶è¡Œæ¨ç† (gpt.c)</h1>
<p>åœ¨äººå·¥æ™ºèƒ½æ—¶ä»£ï¼Œç‰¹åˆ«æ˜¯å¤§è¯­è¨€æ¨¡å‹å¿«é€Ÿå‘å±•çš„ä»Šå¤©ï¼Œæˆ‘ä»¬é¢„è§ä¸€ä¸ªæ›´åŠ æ™ºèƒ½å’Œäº’è”çš„ä¸–ç•Œã€‚AI å°†æ·±åˆ»æ”¹å˜æˆ‘ä»¬è·å–ä¿¡æ¯ã€è¿›è¡Œæ²Ÿé€šå’Œè§£å†³é—®é¢˜çš„æ–¹å¼ã€‚é‚£ä¹ˆï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆè—åœ¨ AI èƒŒåï¼Ÿ</p>
<div class="box yellow-box"><div><span class="float-left text-4xl mr-3 mt-2">â°</span><span class="font-serif text-lg border-b border-slate-600"><b>Soft Deadline: 2024 å¹´ 5 æœˆ 5 æ—¥ 23:59:59</b></span><div class="font-serif pt-2"><p><strong><red>ä½ éœ€è¦é¦–å…ˆé˜…è¯»<a href="Labs.md">å®éªŒé¡»çŸ¥</a>ï¼Œå…¶ä¸­åŒ…å«äº†ä»£ç è·å–æ–¹æ³•ã€æäº¤æ–¹æ³•ã€å¦‚ä½•æŸ¥çœ‹æäº¤ç»“æœç­‰</red></strong>ã€‚åœ¨å‘½ä»¤è¡Œä¸­ <code>git pull origin M3</code> ä¸‹è½½æ¡†æ¶ä»£ç ã€‚</p></div></div></div>
<div class="box red-box"><div><span class="float-left text-4xl mr-3 mt-2">âš ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>è¯·ä¸è¦å‚è€ƒ llm.c çš„å®ç°</b></span><div class="font-serif pt-2"><p>åœ¨ 2024 å­¦æœŸå¼€å§‹å‰ï¼Œjyy å°±å—åˆ° llama.cpp å¯å‘ï¼Œæœ‰äº†å®ç° â€œgpt-2.cppâ€ ä½œä¸ºå¹¶è¡Œç¼–ç¨‹å®éªŒçš„æƒ³æ³•ã€‚æ²¡æƒ³åˆ° Andrej Karpathy äº²æ‰‹ä¸‹åœºå®ç°äº† <a href="https://github.com/karpathy/llm.c">llm.c</a>ï¼Œå®ƒä½¿ç”¨äº† OpenMP è¿›è¡Œå¹¶è¡Œã€‚å¦‚æœä½  â€œå·çœ‹â€ åˆ°åº”è¯¥å¦‚ä½•åšå¹¶è¡Œï¼Œæœ¬æ¬¡å®éªŒçš„æ•ˆæœå°±æœ‰æŠ˜æ‰£ã€‚æœ¬æ¬¡å®éªŒéš¾åº¦ä¸é«˜ï¼Œè¯·éµå®ˆå­¦æœ¯è¯šä¿¡ï¼Œç‹¬ç«‹å®Œæˆå®éªŒã€‚</p></div></div></div>
<div class="box slate-box"><div><span class="float-left text-4xl mr-3 mt-2">âš–ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>M3 - gpt</b></span><div class="font-serif pt-2"><p>è¯·è¾“å…¥ Token ç™»å½•ã€‚</p></div></div></div>
<h2>1. èƒŒæ™¯</h2>
<p>å¤§å®¶çœ‹åˆ° jyy åœ¨ä¸Šè¯¾æ—¶ï¼Œç»å¸¸è°ƒç”¨ GPT-4 â€œé€ƒè¯¾â€ æ°´æ—¶é•¿ã€‚GPT è¿™æ ·çš„ â€œå¤§è¯­è¨€æ¨¡å‹â€ æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span></span></span>ï¼Œèƒ½å¤Ÿæ¥æ”¶ä¸€ä¸ª â€œéƒ¨åˆ†æ–‡æœ¬â€ï¼Œè¾“å‡º â€œæ–‡æœ¬å¯èƒ½çš„ä¸‹ä¸€ä¸ªå­—ç¬¦â€ã€‚è¿™ä¸ª â€œæ™ºèƒ½â€ å‡½æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span></span></span> å…·æœ‰æƒŠäººçš„åº”ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬ â€œä¸€åˆ‡â€ çš„ copilot (ç¼–ç¨‹ã€æ“ä½œç³»ç»Ÿä½¿ç”¨ã€ç”šè‡³æ˜¯è¯¾å ‚å­¦ä¹ )ï¼Œå’Œå¯ä»¥å„ç§æ›¿ä»£äººç±»çš„æ™ºèƒ½ agentã€‚è€Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span></span></span> è®­ç»ƒå¥½ä¹‹åï¼Œå°±ä¼šéƒ¨ç½²åœ¨äº‘ç«¯çš„æ¨ç†æœåŠ¡ï¼Œä»¥ API çš„å½¢å¼æä¾›æœåŠ¡ã€‚æˆ‘ä»¬é¢„è§ï¼ŒAI æ¨ç†æœåŠ¡å°†ä¼šå’Œæ°´ã€ç”µã€äº‘ä¸€æ ·æˆä¸ºäººç±»ç¤¾ä¼šçš„é‡è¦åŸºç¡€è®¾æ–½ã€‚</p>
<h2>2. å®éªŒæè¿°</h2>
<h3>2.1 æ€»è§ˆ</h3>
<center>gpt [<u>token</u>]â€¦</center>
<h3>2.2 æè¿°</h3>
<p>ä½¿ç”¨ <code>gpt2_124M</code> æ¨¡å‹å°†è¾“å…¥çš„ä»£è¡¨äº†ä¸€æ®µæ–‡æœ¬çš„ token (æ•´æ•°) åºåˆ—è¿›è¡Œè¡¥å…¨ï¼Œè¾“å‡ºåç»­å¯èƒ½çš„ tokens (åŒ…å«è¾“å…¥ï¼Œæ€»æœ‰æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">10</span></span></span></span> ä¸ª tokens)ï¼Œä½œä¸ºæ¦‚ç‡æ„ä¹‰ä¸Š â€œå¯èƒ½â€ çš„åç»­æ–‡æœ¬ã€‚</p>
<h3>2.3 è§£é‡Š</h3>
<p>GPT-2 æ˜¯ä¸€ä¸ªåŸºäº Transformer çš„æ—©æœŸæ¨¡å‹ï¼Œä½†å¥ å®šäº† OpenAI çš„æŠ€æœ¯åŸºç¡€ã€‚å¹¶è¡ŒåŒ–æ˜¯æé«˜å¤§è§„æ¨¡æ¨¡å‹è®¡ç®—æ•ˆç‡çš„å…³é”®æŠ€æœ¯ä¹‹ä¸€ã€‚gpt.c å®ç°äº†ç”Ÿæˆå¼äººå·¥æ™ºèƒ½çš„ â€œæ–‡æœ¬è¡¥å…¨â€ï¼Œæ¡†æ¶ä»£ç å·²ç»æä¾›äº†ä» <a href="https://github.com/karpathy/llm.c">llm.c</a> ä¸­è£å‰ªå‡ºçš„å®Œæ•´çš„ç¥ç»ç½‘ç»œæ¨ç† (inference) å®ç°ã€‚ä¸‹è½½ <code>gpt2_124M.bin</code> åˆ°å®éªŒç›®å½•å³å¯æ­£å¸¸å·¥ä½œï¼Œå®ç°æ–‡æœ¬çš„è¡¥å…¨ã€‚ä¸å®ƒäº¤äº’ï¼Œä½ å¯ä»¥æ„Ÿå—åˆ°è‡ªç„¶è¯­è¨€å¤„ç†çš„é£é€Ÿå‘å±• (GPT-2 æ˜¯ 2019 å¹´çš„æ¨¡å‹ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ 124M çš„å°ç‰ˆæœ¬æ¨¡å‹ï¼Œèƒ½åŠ›ä¸ä»Šå¤©çš„æ¨¡å‹æ— æ³•åŒ¹æ•Œï¼Œä½†ä¾ç„¶èƒ½çœ‹åˆ°å®ƒçš„ç¡®å¯ä»¥ç”Ÿæˆ â€œåˆæ³•â€ çš„å¥å­)ã€‚</p>
<div class="box red-box"><div><span class="float-left text-4xl mr-3 mt-2">âš ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>ä½ éœ€è¦æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹</b></span><div class="font-serif pt-2"><p>æ¨¡å‹æ–‡ä»¶è¾ƒå¤§ (~500MB)ï¼Œå› æ­¤ä½ éœ€è¦æ‰‹åŠ¨<a href="https://box.nju.edu.cn/f/da66441d8c6d48d6b848/">ä¸‹è½½åˆ°å®éªŒç›®å½•</a>ã€‚è¿™ä¸ªæ–‡ä»¶ä¸ä¼šè¢« git è¿½è¸ªï¼Œä¹Ÿä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚</p></div></div></div>
<p>æˆ‘ä»¬æä¾›äº†ä¸€ä¸ª Python çš„è„šæœ¬ chat.pyï¼Œå¯ä»¥ç›´æ¥è¾“å…¥ä¸€æ®µæ–‡æœ¬ï¼Œå®Œæˆ tokenizeï¼Œå¹¶ä¸”è°ƒç”¨ gpt å‘½ä»¤è¡Œå·¥å…·è¿›è¡Œè¡¥å…¨ï¼Œæ²¡é”™ï¼Œä½ çœŸçš„åœ¨å®éªŒä¸­ä½¿ç”¨äº†ä¸€ä¸ªèƒ½ç”Ÿæˆæ–‡æœ¬çš„å¤§è¯­è¨€æ¨¡å‹ï¼ä»£ç å·²ç»å…¨éƒ¨ç»™å¤§å®¶å‡†å¤‡å¥½ï¼Œå¹¶ä¸”å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼åœ¨ä¸‹é¢çš„ä¾‹å­é‡Œï¼Œæ•°å­—åºåˆ— â€œ31373 612â€ å°±æ˜¯ â€œLadies andâ€ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¯­è¨€æ¨¡å‹çš„ç¡®ä¸ºæˆ‘ä»¬ç”Ÿæˆäº†å¯é˜…è¯»çš„æ–‡æœ¬ï¼š</p>
<center> <img src="../../img/gpt.gif" alt=""/> </center>
<p>æ²¡é”™ï¼Œå³ä¾¿è¿™ä¹ˆå°çš„æ¨¡å‹ï¼Œå•çº¿ç¨‹çš„å®ç°åœ¨ CPU ä¸Šæ¨ç†éƒ½éå¸¸åƒåŠ›ï¼Œæ›´ä¸å¿…è¯´ä¹‹å â€œè¶…å¤§â€ çš„ GPT-3 (1750 äº¿å‚æ•°)ã€‚ç¥ç»ç½‘ç»œæ¨ç†ä¼˜åŒ–æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„ä¸»é¢˜ï¼›åœ¨è¿™é‡Œæˆ‘ä»¬è¯•ç€åšå‡ºå¹¶è¡ŒåŒ–çš„ç¬¬ä¸€æ­¥ï¼š</p>
<div class="box blue-box"><div><span class="float-left text-4xl mr-3 mt-2">ğŸ—’ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>å®éªŒè¦æ±‚ï¼šå°† gpt.c å¹¶è¡ŒåŒ–</b></span><div class="font-serif pt-2"><p>æˆ‘ä»¬çš„ gpt.c æ˜¯ä¸²è¡Œçš„ä»£ç  (ä½†åŠŸèƒ½æœªå˜)ï¼Œåªèƒ½åˆ©ç”¨å•ä¸ªå¤„ç†å™¨ã€‚ä½ éœ€è¦æ‰¾åˆ°ä»£ç ä¸­å¯å¹¶è¡Œ (å¹¶ä¸”æœ‰æ”¶ç›Š) çš„éƒ¨åˆ†ï¼Œæ”¹é€ æˆå¹¶è¡Œï¼Œä»è€Œè·å¾—ç›¸åº”çš„æ€§èƒ½æå‡ã€‚</p></div></div></div>
<p>åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¾å ‚ä¸Šçš„çº¿ç¨‹åº“ (thread.h å’Œ thread-sync.h)ï¼Œå…¶ä¸­åŒ…æ‹¬çº¿ç¨‹çš„åˆ›å»ºå’Œå›æ”¶ã€äº’æ–¥é”ã€ä¿¡å·é‡å’Œæ¡ä»¶å˜é‡ã€‚ä½ å¯ä»¥é€‰æ‹©ä½ å–œæ¬¢çš„æœºåˆ¶è¿›è¡ŒåŒæ­¥å’Œäº’æ–¥ã€‚</p>
<h2>3. æ­£ç¡®æ€§æ ‡å‡†</h2>
<div class="box blue-box"><div><span class="float-left text-4xl mr-3 mt-2">ğŸ—’ï¸</span><span class="font-serif text-lg border-b border-slate-600"><b>æ­£ç¡®æ€§ &amp; Scalability</b></span><div class="font-serif pt-2"><p>ä½ å¹¶è¡ŒåŒ–åçš„<strong>ç¨‹åºè¡Œä¸º</strong>åº”å½“ä¸æˆ‘ä»¬ç»™å‡ºçš„ä¸²è¡Œç¨‹åºä¿æŒä¸¥æ ¼ä¸€è‡´ (å¦‚æœä½ å¸Œæœ›åŠ¨æ‰‹ â€œç©ä¸€ç©â€ï¼Œå¯ä»¥ç›´æ¥ç§»æ­¥åŸ repo)ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¾“å…¥ + è¾“å‡ºæ€»å…± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">10</span></span></span></span> ä¸ª tokensã€‚ä½ åº”è¯¥ä¿æŒè¿™ä¸ªè¡Œä¸ºä¸å˜ã€‚</p><p>å¹¶è¡ŒåŒ–å¸¦æ¥çš„è®¡ç®—é¡ºåºè°ƒæ•´å¯èƒ½ä¼šè½»å¾®å½±å“æ•´ä¸ªç¥ç»ç½‘ç»œçš„æ¿€æ´»å‡½æ•°å‡½æ•°å€¼ï¼Œä½†åªè¦æœ€ç»ˆè¾“å‡ºçš„ token åºåˆ— (ç†è§£ä¸ºæ–‡æœ¬) ä¸€è‡´ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºæ­£ç¡®ã€‚ç›¸æ¯”äºä¸²è¡Œç¨‹åºï¼Œåœ¨ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> ä¸ªå¤„ç†å™¨çš„è®¡ç®—æœºä¸Šï¼Œé™¤å»æ¨¡å‹åŠ è½½æ—¶é—´ï¼Œä½ åº”å½“åœ¨æœ‰è¾ƒå¤šè½®æ¨ç†æ—¶å¾—åˆ°è¿‘ä¼¼çº¿æ€§ (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> å€) çš„åŠ é€Ÿæ¯”ã€‚</p></div></div></div>
<p>Online Judge è¯„æµ‹æ—¶ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>â‰¤</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">k \le 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">4</span></span></span></span>ã€‚å¯¹äºçœŸå®çš„ç¥ç»ç½‘ç»œè®­ç»ƒ/æ¨å¯¼ç³»ç»Ÿï¼ŒGPU è¿™ç±» SIMT çš„å¤§è§„æ¨¡å¹¶è¡Œå¤„ç†å™¨åœ¨èƒ½è€—æ¯”ä¸Šç›¸æ¯” CPU æœ‰å·¨å¤§çš„ä¼˜åŠ¿ã€‚å›é¡¾è¯¾ç¨‹ä¸­è®²è§£ SIMT æ—¶ï¼Œä¸€ä¸ªçº¿ç¨‹æŸå…±äº«ä¸€ä¸ª Program Counterï¼Œæ§åˆ¶å¤šä¸ªçº¿ç¨‹ â€œåŒæ­¥â€ æ‰§è¡ŒæŒ‡ä»¤ã€‚æ­¤æ—¶ï¼Œé’ˆå¯¹å¤§çŸ©é˜µã€å‘é‡çš„ load/storeï¼Œä¸€ä¸ªçº¿ç¨‹æŸå°±ä¼šç”Ÿæˆä¸€ä¸ªéå¸¸é•¿çš„å†…å­˜ load (coalesced memory access)ï¼Œç›¸æ¯” CPU â€œç¢¾ç¢äº†â€ çš„å†…å­˜-ç¼“å­˜ç³»ç»Ÿï¼Œå…·æœ‰é«˜å¾—å¤šçš„ç”µè·¯æ¯”å’Œèƒ½æ•ˆæ¯”ã€‚</p>
<p>åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä½ éœ€è¦é™æ€åˆ†é…å¥½çº¿ç¨‹ (ä¾‹å¦‚ 4 ä¸ª workers)ï¼Œç„¶åç”±è¿™äº›çº¿ç¨‹å®Œæˆè®¡ç®—ä»»åŠ¡ã€‚Online Judge æµ‹è¯•æ—¶çš„çº¿ç¨‹åº“ä¸åŒå­¦ä»¬å®éªŒä»£ç ä¸­çš„å®Œå…¨ä¸€æ ·ã€‚<strong>æˆ‘ä»¬åªä¼šå¤åˆ¶ä½ çš„å•ä¸ªæ–‡ä»¶ gpt.c è¿›è¡Œè¯„æµ‹</strong>ã€‚</p>
<h2>4. å®éªŒæŒ‡å—</h2>
<h3>4.1 GPT-2 å·¥ä½œåŸç†</h3>
<p>é¦–å…ˆï¼Œgpt.c çš„æºä»£ç å°±æ˜¯æœ€å¥½çš„è€å¸ˆï¼å®ƒå®ç°äº†å¯¹ç¥ç»ç½‘ç»œçš„ â€œçœŸæ­£æ•°å­¦ä¸¥æ ¼â€ çš„æè¿°â€”â€”å¦‚æœæˆ‘ä»¬çœ‹ PyTorch çš„ä»£ç ï¼Œå…¶ä¸­ä¼šæ¶‰åŠè®¸å¤šå†…ç½®çš„ç®—å­ï¼Œä½ å¯¹å…¶ä¸­çš„å®ç°å…¶å®å¹¶ä¸ 100% ç†è§£â€”â€”ä½†å¯¹äº C ä»£ç è¿™ç§è¯­ä¹‰ â€œæ‰å¹³â€ çš„è¯­è¨€æ¥è¯´ï¼Œä½ çœŸçš„å¯ä»¥å®Œå…¨ç†è§£å®ƒï¼æ­¤å¤–ï¼Œæˆ‘ä»¬ç»™ä¸€ä¸ª<a href="https://jalammar.github.io/illustrated-gpt2/">å¤–é“¾</a>ï¼Œä¹Ÿè¿˜æ¨è <a href="https://udlbook.github.io/udlbook/">Understanding Deep Learning</a>ã€‚</p>
<h3>4.2 å¯»æ‰¾å¹¶è¡Œçš„æœºä¼š</h3>
<p>å¦‚ä½•ä¼˜åŒ–ä½ çš„ä»£ç ï¼Ÿåœ¨å¼€å§‹ä»»ä½•ä¼˜åŒ–ä¹‹å‰ï¼Œé¦–å…ˆçœ‹ D. E. Knuth çš„åè¨€ï¼š</p>
<blockquote>
<p>Premature optimization is the root of all evil.</p>
</blockquote>
<p>â€œPrematureâ€ ä¸ä»…æŒ‡ä½ ä¸åº”è¯¥åœ¨å®ç°ä»£ç çš„è¿‡ç¨‹ä¸­åš â€œä»»æ„â€ çš„ä¼˜åŒ–ï¼Œå®ƒä»¬å¯èƒ½æ”¶æ•ˆç”šå¾®ï¼Œä½†å¤§å¹…ç ´åäº†ä½ ä»£ç çš„å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ç­‰ã€‚â€œPrematureâ€ åŒæ ·æŒ‡ä½ ä¸åº”è¯¥éšæ„åœ°å»åŠ¨ä½ çš„ä»£ç ï¼Œç„¶åå»åšä¸€äº›æƒ³å½“ç„¶çš„ä¼˜åŒ–ã€‚åŒæ ·ï¼Œè¿™äº›ä¼˜åŒ–å¯èƒ½ç ´åå¯è¯»æ€§ï¼Œè€Œä¸”å¾ˆå¯èƒ½æ²¡æœ‰ä»€ä¹ˆæ•ˆæœã€‚</p>
<div class="box purple-box"><div><span class="float-left text-4xl mr-3 mt-2">ğŸ’¡</span><span class="font-serif text-lg border-b border-slate-600"><b>æ€ä¹ˆåšå‡ºæ­£ç¡®çš„ä¼˜åŒ–ï¼Ÿ</b></span><div class="font-serif pt-2"><div class="py-1">ç»™å¤§å®¶ä¸€ä¸ªæç¤ºï¼šEverything is a state machine. å¦‚æœé¡ºç€è¿™ä¸ªæ€è·¯å‡ºå‘ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆè€ƒè™‘æ€§èƒ½ä¼˜åŒ–è¿™ä¸ªé—®é¢˜ï¼Ÿ</div><ol class="quiz-card p-0 ml-8 my-1"></ol></div></div></div>
<p>ç­”æ¡ˆæ˜¯ï¼šæˆ‘ä»¬åº”è¯¥è§‚å¯ŸçŠ¶æ€æœºçš„æ‰§è¡Œã€‚æ ¹æ®äºŒå…«å®šå¾‹ï¼Œç»å¤§éƒ¨åˆ†çš„æ—¶é—´åº”è¯¥æ˜¯æ¶ˆè€—åœ¨å°‘éƒ¨åˆ†æ“ä½œä¸Šçš„ã€‚å› æ­¤ï¼Œä½ é¦–å…ˆéœ€è¦ç†è§£ç¨‹åºçš„å“ªä¸ªéƒ¨åˆ†æ¶ˆè€—äº†æœ€å¤šçš„æ—¶é—´â€”â€”é’ˆå¯¹æ€§åœ°ï¼Œæˆ‘ä»¬ä¹Ÿåº”å½“è¯•å›¾ä¼˜åŒ– (å¹¶è¡ŒåŒ–) è¿™äº›ä»£ç â€”â€”ä½ å¯¹å ç”¨ 1% æ—¶é—´çš„ä»£ç ï¼Œå³ä¾¿ä¼˜åŒ–åˆ°æè‡´ä½¿è¿è¡Œæ—¶é—´å®Œå…¨ä¸º 0ï¼Œä½ çš„æ”¶ç›Šä¹Ÿè¿‘ä¹ä¸ºé›¶ã€‚</p>
<p>å½“ç„¶ï¼Œä½ éœ€è¦å·¥å…·ï¼šprofilerï¼Œç”¨äºé‡‡æ ·çŠ¶æ€æœºçš„æ‰§è¡Œï¼Œâ€œå¯†é›†â€ çš„é‡‡æ ·å°±èƒ½å¾—åˆ°ç¨‹åºæ¶ˆè€—æ—¶é—´çš„åºåˆ—ã€‚</p>
<blockquote>
<p>In <a href="https://en.wikipedia.org/wiki/Software_engineering">software engineering</a>, <strong>profiling</strong> (&quot;program profiling&quot;, &quot;software profiling&quot;) is a form of <a href="https://en.wikipedia.org/wiki/Dynamic_program_analysis">dynamic program analysis</a> that measures, for example, the space (memory) or time <a href="https://en.wikipedia.org/wiki/Computational_complexity_theory">complexity of a program</a>, the <a href="https://en.wikipedia.org/wiki/Instruction_set_simulator">usage of particular instructions</a>, or the frequency and duration of function calls. Most commonly, profiling information serves to aid <a href="https://en.wikipedia.org/wiki/Program_optimization">program optimization</a>.</p>
</blockquote>
<p>ä¾‹å¦‚ï¼ŒLinux perf å·¥å…·æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—ç”¨äºåˆ†æç¨‹åºæ€§èƒ½å’Œè·Ÿè¸ªç³»ç»Ÿäº‹ä»¶çš„åŠŸèƒ½ã€‚è¿™ä¸ªå·¥å…·æ˜¯å†…æ ¸ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œåˆ©ç”¨äº† Linux å†…æ ¸ä¸­çš„æ€§èƒ½è®¡æ•°å™¨å­ç³»ç»Ÿã€‚Perf å¯ä»¥å¸®åŠ©å¼€å‘è€…å’Œç³»ç»Ÿç®¡ç†å‘˜ç›‘æ§æ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½ï¼ŒåŒ…æ‹¬ç¡¬ä»¶å’Œè½¯ä»¶å±‚é¢ã€‚Perf å·¥å…·èƒ½å¤Ÿæµ‹é‡è½¯ä»¶äº‹ä»¶å¦‚å‡½æ•°è°ƒç”¨å’Œç¨‹åºæ‰§è¡Œæ—¶é—´ï¼Œå¹¶ä¸”èƒ½å¤Ÿç›‘æ§ç¡¬ä»¶äº‹ä»¶æ¯”å¦‚ CPU å‘¨æœŸæ•°ã€æŒ‡ä»¤æ•°ä»¥åŠç¼“å­˜å‘½ä¸­å’Œæœªå‘½ä¸­çš„æƒ…å†µã€‚è¿™ä½¿å¾—å®ƒéå¸¸é€‚åˆäºæ€§èƒ½è°ƒä¼˜å’Œå¯»æ‰¾ç“¶é¢ˆã€‚æ­¤å¤–ï¼Œperf æ”¯æŒäº‹ä»¶çš„å®æ—¶è¿½è¸ªï¼Œèƒ½å¤Ÿè®°å½•å’ŒæŠ¥å‘Šç³»ç»Ÿè¿è¡Œä¸­çš„å„ç§äº‹ä»¶ï¼Œå¦‚ä¸Šä¸‹æ–‡åˆ‡æ¢ã€ç³»ç»Ÿè°ƒç”¨ã€é¡µé”™è¯¯ç­‰ã€‚è¿™äº›åŠŸèƒ½ä½¿å¾— perf æˆä¸º Linux ç³»ç»Ÿæ€§èƒ½åˆ†æå’Œé—®é¢˜è¯Šæ–­çš„é‡è¦å·¥å…·ã€‚</p>
<center> <img src="../../img/perf-top.gif" alt=""/> </center>
<h3>4.3 ä½¿ç”¨çº¿ç¨‹åº“å®ç°å¹¶è¡Œ</h3>
<p>å¦‚æœä½ ä¸çŸ¥é“æ€ä¹ˆå®ç°å¹¶è¡Œï¼Œå¯ä»¥ä»æˆ‘ä»¬è¯¾å ‚çš„ä»£ç å…¥æ‰‹ï¼Œä¾‹å¦‚ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ï¼š</p>
<div class="box blue-box"><div><span class="float-left text-4xl mr-3 mt-2"><button class="hover:bg-blue-300 text-white font-bold px-2 rounded"><img class="w-10" src="../../img/vscode.svg"/></button></span><span class="font-serif text-lg border-b border-slate-600"><b></b></span><div class="font-serif pt-2"><div></div></div></div></div>
<p>æˆ‘ä»¬å·²ç»æåˆ°ï¼Œç”Ÿäº§è€…-æ¶ˆè´¹è€…å¯ä»¥è§£å†³å¤§å®¶ 99% çš„å¹¶è¡Œç¼–ç¨‹é—®é¢˜â€”â€”è¿™ä¸ªè‡ªç„¶ä¸ä¾‹å¤–ã€‚</p></div></div><div class="bg-neutral-100 text-center text-neutral-600 dark:bg-neutral-600 dark:text-neutral-200 lg:text-left"><div class="bg-neutral-200 p-6 text-center dark:bg-neutral-700"><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons License: BY-NC 4.0</a><br/><a href="https://beian.miit.gov.cn/">è‹ ICP å¤‡ 2020049101 å·</a></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h1: \"h1\",\n    p: \"p\",\n    strong: \"strong\",\n    a: \"a\",\n    code: \"code\",\n    h2: \"h2\",\n    span: \"span\",\n    math: \"math\",\n    semantics: \"semantics\",\n    mrow: \"mrow\",\n    mi: \"mi\",\n    annotation: \"annotation\",\n    h3: \"h3\",\n    mo: \"mo\",\n    mn: \"mn\",\n    img: \"img\",\n    blockquote: \"blockquote\"\n  }, _provideComponents(), props.components), {Box, Submission, Quiz, Demo} = _components;\n  if (!Box) _missingMdxReference(\"Box\", true);\n  if (!Demo) _missingMdxReference(\"Demo\", true);\n  if (!Quiz) _missingMdxReference(\"Quiz\", true);\n  if (!Submission) _missingMdxReference(\"Submission\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.h1, {\n      children: \"M3: GPT-2 å¹¶è¡Œæ¨ç† (gpt.c)\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"åœ¨äººå·¥æ™ºèƒ½æ—¶ä»£ï¼Œç‰¹åˆ«æ˜¯å¤§è¯­è¨€æ¨¡å‹å¿«é€Ÿå‘å±•çš„ä»Šå¤©ï¼Œæˆ‘ä»¬é¢„è§ä¸€ä¸ªæ›´åŠ æ™ºèƒ½å’Œäº’è”çš„ä¸–ç•Œã€‚AI å°†æ·±åˆ»æ”¹å˜æˆ‘ä»¬è·å–ä¿¡æ¯ã€è¿›è¡Œæ²Ÿé€šå’Œè§£å†³é—®é¢˜çš„æ–¹å¼ã€‚é‚£ä¹ˆï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆè—åœ¨ AI èƒŒåï¼Ÿ\"\n    }), \"\\n\", _jsx(Box, {\n      logo: \"â°\",\n      title: \"Soft Deadline: 2024 å¹´ 5 æœˆ 5 æ—¥ 23:59:59\",\n      children: _jsxs(_components.p, {\n        children: [_jsx(_components.strong, {\n          children: _jsxs(\"red\", {\n            children: [\"ä½ éœ€è¦é¦–å…ˆé˜…è¯»\", _jsx(_components.a, {\n              href: \"Labs.md\",\n              children: \"å®éªŒé¡»çŸ¥\"\n            }), \"ï¼Œå…¶ä¸­åŒ…å«äº†ä»£ç è·å–æ–¹æ³•ã€æäº¤æ–¹æ³•ã€å¦‚ä½•æŸ¥çœ‹æäº¤ç»“æœç­‰\"]\n          })\n        }), \"ã€‚åœ¨å‘½ä»¤è¡Œä¸­ \", _jsx(_components.code, {\n          children: \"git pull origin M3\"\n        }), \" ä¸‹è½½æ¡†æ¶ä»£ç ã€‚\"]\n      })\n    }), \"\\n\", _jsx(Box, {\n      logo: \"âš ï¸\",\n      title: \"è¯·ä¸è¦å‚è€ƒ llm.c çš„å®ç°\",\n      children: _jsxs(_components.p, {\n        children: [\"åœ¨ 2024 å­¦æœŸå¼€å§‹å‰ï¼Œjyy å°±å—åˆ° llama.cpp å¯å‘ï¼Œæœ‰äº†å®ç° â€œgpt-2.cppâ€ ä½œä¸ºå¹¶è¡Œç¼–ç¨‹å®éªŒçš„æƒ³æ³•ã€‚æ²¡æƒ³åˆ° Andrej Karpathy äº²æ‰‹ä¸‹åœºå®ç°äº† \", _jsx(_components.a, {\n          href: \"https://github.com/karpathy/llm.c\",\n          children: \"llm.c\"\n        }), \"ï¼Œå®ƒä½¿ç”¨äº† OpenMP è¿›è¡Œå¹¶è¡Œã€‚å¦‚æœä½  â€œå·çœ‹â€ åˆ°åº”è¯¥å¦‚ä½•åšå¹¶è¡Œï¼Œæœ¬æ¬¡å®éªŒçš„æ•ˆæœå°±æœ‰æŠ˜æ‰£ã€‚æœ¬æ¬¡å®éªŒéš¾åº¦ä¸é«˜ï¼Œè¯·éµå®ˆå­¦æœ¯è¯šä¿¡ï¼Œç‹¬ç«‹å®Œæˆå®éªŒã€‚\"]\n      })\n    }), \"\\n\", _jsx(Submission, {\n      course: \"OS2024\",\n      module: \"M3\",\n      desc: \"M3 - gpt\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"1. èƒŒæ™¯\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"å¤§å®¶çœ‹åˆ° jyy åœ¨ä¸Šè¯¾æ—¶ï¼Œç»å¸¸è°ƒç”¨ GPT-4 â€œé€ƒè¯¾â€ æ°´æ—¶é•¿ã€‚GPT è¿™æ ·çš„ â€œå¤§è¯­è¨€æ¨¡å‹â€ æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•° \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mi, {\n                  children: \"f\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"f\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.8889em\",\n                verticalAlign: \"-0.1944em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.10764em\"\n              },\n              children: \"f\"\n            })]\n          })\n        })]\n      }), \"ï¼Œèƒ½å¤Ÿæ¥æ”¶ä¸€ä¸ª â€œéƒ¨åˆ†æ–‡æœ¬â€ï¼Œè¾“å‡º â€œæ–‡æœ¬å¯èƒ½çš„ä¸‹ä¸€ä¸ªå­—ç¬¦â€ã€‚è¿™ä¸ª â€œæ™ºèƒ½â€ å‡½æ•° \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mi, {\n                  children: \"f\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"f\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.8889em\",\n                verticalAlign: \"-0.1944em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.10764em\"\n              },\n              children: \"f\"\n            })]\n          })\n        })]\n      }), \" å…·æœ‰æƒŠäººçš„åº”ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬ â€œä¸€åˆ‡â€ çš„ copilot (ç¼–ç¨‹ã€æ“ä½œç³»ç»Ÿä½¿ç”¨ã€ç”šè‡³æ˜¯è¯¾å ‚å­¦ä¹ )ï¼Œå’Œå¯ä»¥å„ç§æ›¿ä»£äººç±»çš„æ™ºèƒ½ agentã€‚è€Œ \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mi, {\n                  children: \"f\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"f\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.8889em\",\n                verticalAlign: \"-0.1944em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.10764em\"\n              },\n              children: \"f\"\n            })]\n          })\n        })]\n      }), \" è®­ç»ƒå¥½ä¹‹åï¼Œå°±ä¼šéƒ¨ç½²åœ¨äº‘ç«¯çš„æ¨ç†æœåŠ¡ï¼Œä»¥ API çš„å½¢å¼æä¾›æœåŠ¡ã€‚æˆ‘ä»¬é¢„è§ï¼ŒAI æ¨ç†æœåŠ¡å°†ä¼šå’Œæ°´ã€ç”µã€äº‘ä¸€æ ·æˆä¸ºäººç±»ç¤¾ä¼šçš„é‡è¦åŸºç¡€è®¾æ–½ã€‚\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"2. å®éªŒæè¿°\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"2.1 æ€»è§ˆ\"\n    }), \"\\n\", _jsxs(\"center\", {\n      children: [\"gpt [\", _jsx(\"u\", {\n        children: \"token\"\n      }), \"]â€¦\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"2.2 æè¿°\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"ä½¿ç”¨ \", _jsx(_components.code, {\n        children: \"gpt2_124M\"\n      }), \" æ¨¡å‹å°†è¾“å…¥çš„ä»£è¡¨äº†ä¸€æ®µæ–‡æœ¬çš„ token (æ•´æ•°) åºåˆ—è¿›è¡Œè¡¥å…¨ï¼Œè¾“å‡ºåç»­å¯èƒ½çš„ tokens (åŒ…å«è¾“å…¥ï¼Œæ€»æœ‰æœ‰ \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsx(_components.mi, {\n                  children: \"n\"\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsx(_components.mn, {\n                  children: \"10\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"n=10\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.4306em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"n\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6444em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"10\"\n            })]\n          })]\n        })]\n      }), \" ä¸ª tokens)ï¼Œä½œä¸ºæ¦‚ç‡æ„ä¹‰ä¸Š â€œå¯èƒ½â€ çš„åç»­æ–‡æœ¬ã€‚\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"2.3 è§£é‡Š\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"GPT-2 æ˜¯ä¸€ä¸ªåŸºäº Transformer çš„æ—©æœŸæ¨¡å‹ï¼Œä½†å¥ å®šäº† OpenAI çš„æŠ€æœ¯åŸºç¡€ã€‚å¹¶è¡ŒåŒ–æ˜¯æé«˜å¤§è§„æ¨¡æ¨¡å‹è®¡ç®—æ•ˆç‡çš„å…³é”®æŠ€æœ¯ä¹‹ä¸€ã€‚gpt.c å®ç°äº†ç”Ÿæˆå¼äººå·¥æ™ºèƒ½çš„ â€œæ–‡æœ¬è¡¥å…¨â€ï¼Œæ¡†æ¶ä»£ç å·²ç»æä¾›äº†ä» \", _jsx(_components.a, {\n        href: \"https://github.com/karpathy/llm.c\",\n        children: \"llm.c\"\n      }), \" ä¸­è£å‰ªå‡ºçš„å®Œæ•´çš„ç¥ç»ç½‘ç»œæ¨ç† (inference) å®ç°ã€‚ä¸‹è½½ \", _jsx(_components.code, {\n        children: \"gpt2_124M.bin\"\n      }), \" åˆ°å®éªŒç›®å½•å³å¯æ­£å¸¸å·¥ä½œï¼Œå®ç°æ–‡æœ¬çš„è¡¥å…¨ã€‚ä¸å®ƒäº¤äº’ï¼Œä½ å¯ä»¥æ„Ÿå—åˆ°è‡ªç„¶è¯­è¨€å¤„ç†çš„é£é€Ÿå‘å±• (GPT-2 æ˜¯ 2019 å¹´çš„æ¨¡å‹ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ 124M çš„å°ç‰ˆæœ¬æ¨¡å‹ï¼Œèƒ½åŠ›ä¸ä»Šå¤©çš„æ¨¡å‹æ— æ³•åŒ¹æ•Œï¼Œä½†ä¾ç„¶èƒ½çœ‹åˆ°å®ƒçš„ç¡®å¯ä»¥ç”Ÿæˆ â€œåˆæ³•â€ çš„å¥å­)ã€‚\"]\n    }), \"\\n\", _jsx(Box, {\n      logo: \"âš ï¸\",\n      title: \"ä½ éœ€è¦æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹\",\n      children: _jsxs(_components.p, {\n        children: [\"æ¨¡å‹æ–‡ä»¶è¾ƒå¤§ (~500MB)ï¼Œå› æ­¤ä½ éœ€è¦æ‰‹åŠ¨\", _jsx(_components.a, {\n          href: \"https://box.nju.edu.cn/f/da66441d8c6d48d6b848/\",\n          children: \"ä¸‹è½½åˆ°å®éªŒç›®å½•\"\n        }), \"ã€‚è¿™ä¸ªæ–‡ä»¶ä¸ä¼šè¢« git è¿½è¸ªï¼Œä¹Ÿä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"æˆ‘ä»¬æä¾›äº†ä¸€ä¸ª Python çš„è„šæœ¬ chat.pyï¼Œå¯ä»¥ç›´æ¥è¾“å…¥ä¸€æ®µæ–‡æœ¬ï¼Œå®Œæˆ tokenizeï¼Œå¹¶ä¸”è°ƒç”¨ gpt å‘½ä»¤è¡Œå·¥å…·è¿›è¡Œè¡¥å…¨ï¼Œæ²¡é”™ï¼Œä½ çœŸçš„åœ¨å®éªŒä¸­ä½¿ç”¨äº†ä¸€ä¸ªèƒ½ç”Ÿæˆæ–‡æœ¬çš„å¤§è¯­è¨€æ¨¡å‹ï¼ä»£ç å·²ç»å…¨éƒ¨ç»™å¤§å®¶å‡†å¤‡å¥½ï¼Œå¹¶ä¸”å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼åœ¨ä¸‹é¢çš„ä¾‹å­é‡Œï¼Œæ•°å­—åºåˆ— â€œ31373 612â€ å°±æ˜¯ â€œLadies andâ€ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¯­è¨€æ¨¡å‹çš„ç¡®ä¸ºæˆ‘ä»¬ç”Ÿæˆäº†å¯é˜…è¯»çš„æ–‡æœ¬ï¼š\"\n    }), \"\\n\", _jsxs(\"center\", {\n      children: [\" \", _jsx(_components.img, {\n        src: \"../../img/gpt.gif\",\n        alt: \"\"\n      }), \" \"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"æ²¡é”™ï¼Œå³ä¾¿è¿™ä¹ˆå°çš„æ¨¡å‹ï¼Œå•çº¿ç¨‹çš„å®ç°åœ¨ CPU ä¸Šæ¨ç†éƒ½éå¸¸åƒåŠ›ï¼Œæ›´ä¸å¿…è¯´ä¹‹å â€œè¶…å¤§â€ çš„ GPT-3 (1750 äº¿å‚æ•°)ã€‚ç¥ç»ç½‘ç»œæ¨ç†ä¼˜åŒ–æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„ä¸»é¢˜ï¼›åœ¨è¿™é‡Œæˆ‘ä»¬è¯•ç€åšå‡ºå¹¶è¡ŒåŒ–çš„ç¬¬ä¸€æ­¥ï¼š\"\n    }), \"\\n\", _jsx(Box, {\n      logo: \"ğŸ—’ï¸\",\n      title: \"å®éªŒè¦æ±‚ï¼šå°† gpt.c å¹¶è¡ŒåŒ–\",\n      children: _jsx(_components.p, {\n        children: \"æˆ‘ä»¬çš„ gpt.c æ˜¯ä¸²è¡Œçš„ä»£ç  (ä½†åŠŸèƒ½æœªå˜)ï¼Œåªèƒ½åˆ©ç”¨å•ä¸ªå¤„ç†å™¨ã€‚ä½ éœ€è¦æ‰¾åˆ°ä»£ç ä¸­å¯å¹¶è¡Œ (å¹¶ä¸”æœ‰æ”¶ç›Š) çš„éƒ¨åˆ†ï¼Œæ”¹é€ æˆå¹¶è¡Œï¼Œä»è€Œè·å¾—ç›¸åº”çš„æ€§èƒ½æå‡ã€‚\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¾å ‚ä¸Šçš„çº¿ç¨‹åº“ (thread.h å’Œ thread-sync.h)ï¼Œå…¶ä¸­åŒ…æ‹¬çº¿ç¨‹çš„åˆ›å»ºå’Œå›æ”¶ã€äº’æ–¥é”ã€ä¿¡å·é‡å’Œæ¡ä»¶å˜é‡ã€‚ä½ å¯ä»¥é€‰æ‹©ä½ å–œæ¬¢çš„æœºåˆ¶è¿›è¡ŒåŒæ­¥å’Œäº’æ–¥ã€‚\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"3. æ­£ç¡®æ€§æ ‡å‡†\"\n    }), \"\\n\", _jsxs(Box, {\n      logo: \"ğŸ—’ï¸\",\n      title: \"æ­£ç¡®æ€§ \u0026 Scalability\",\n      children: [_jsxs(_components.p, {\n        children: [\"ä½ å¹¶è¡ŒåŒ–åçš„\", _jsx(_components.strong, {\n          children: \"ç¨‹åºè¡Œä¸º\"\n        }), \"åº”å½“ä¸æˆ‘ä»¬ç»™å‡ºçš„ä¸²è¡Œç¨‹åºä¿æŒä¸¥æ ¼ä¸€è‡´ (å¦‚æœä½ å¸Œæœ›åŠ¨æ‰‹ â€œç©ä¸€ç©â€ï¼Œå¯ä»¥ç›´æ¥ç§»æ­¥åŸ repo)ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¾“å…¥ + è¾“å‡ºæ€»å…± \", _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"n\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mn, {\n                    children: \"10\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"n=10\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.4306em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"n\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"10\"\n              })]\n            })]\n          })]\n        }), \" ä¸ª tokensã€‚ä½ åº”è¯¥ä¿æŒè¿™ä¸ªè¡Œä¸ºä¸å˜ã€‚\"]\n      }), _jsxs(_components.p, {\n        children: [\"å¹¶è¡ŒåŒ–å¸¦æ¥çš„è®¡ç®—é¡ºåºè°ƒæ•´å¯èƒ½ä¼šè½»å¾®å½±å“æ•´ä¸ªç¥ç»ç½‘ç»œçš„æ¿€æ´»å‡½æ•°å‡½æ•°å€¼ï¼Œä½†åªè¦æœ€ç»ˆè¾“å‡ºçš„ token åºåˆ— (ç†è§£ä¸ºæ–‡æœ¬) ä¸€è‡´ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºæ­£ç¡®ã€‚ç›¸æ¯”äºä¸²è¡Œç¨‹åºï¼Œåœ¨ä¸€ä¸ª \", _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"k\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"k\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03148em\"\n                },\n                children: \"k\"\n              })]\n            })\n          })]\n        }), \" ä¸ªå¤„ç†å™¨çš„è®¡ç®—æœºä¸Šï¼Œé™¤å»æ¨¡å‹åŠ è½½æ—¶é—´ï¼Œä½ åº”å½“åœ¨æœ‰è¾ƒå¤šè½®æ¨ç†æ—¶å¾—åˆ°è¿‘ä¼¼çº¿æ€§ (\", _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"k\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"k\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03148em\"\n                },\n                children: \"k\"\n              })]\n            })\n          })]\n        }), \" å€) çš„åŠ é€Ÿæ¯”ã€‚\"]\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Online Judge è¯„æµ‹æ—¶ï¼Œ\", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsx(_components.mi, {\n                  children: \"k\"\n                }), _jsx(_components.mo, {\n                  children: \"â‰¤\"\n                }), _jsx(_components.mn, {\n                  children: \"4\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"k \\\\le 4\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.8304em\",\n                verticalAlign: \"-0.136em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.03148em\"\n              },\n              children: \"k\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"â‰¤\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6444em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"4\"\n            })]\n          })]\n        })]\n      }), \"ã€‚å¯¹äºçœŸå®çš„ç¥ç»ç½‘ç»œè®­ç»ƒ/æ¨å¯¼ç³»ç»Ÿï¼ŒGPU è¿™ç±» SIMT çš„å¤§è§„æ¨¡å¹¶è¡Œå¤„ç†å™¨åœ¨èƒ½è€—æ¯”ä¸Šç›¸æ¯” CPU æœ‰å·¨å¤§çš„ä¼˜åŠ¿ã€‚å›é¡¾è¯¾ç¨‹ä¸­è®²è§£ SIMT æ—¶ï¼Œä¸€ä¸ªçº¿ç¨‹æŸå…±äº«ä¸€ä¸ª Program Counterï¼Œæ§åˆ¶å¤šä¸ªçº¿ç¨‹ â€œåŒæ­¥â€ æ‰§è¡ŒæŒ‡ä»¤ã€‚æ­¤æ—¶ï¼Œé’ˆå¯¹å¤§çŸ©é˜µã€å‘é‡çš„ load/storeï¼Œä¸€ä¸ªçº¿ç¨‹æŸå°±ä¼šç”Ÿæˆä¸€ä¸ªéå¸¸é•¿çš„å†…å­˜ load (coalesced memory access)ï¼Œç›¸æ¯” CPU â€œç¢¾ç¢äº†â€ çš„å†…å­˜-ç¼“å­˜ç³»ç»Ÿï¼Œå…·æœ‰é«˜å¾—å¤šçš„ç”µè·¯æ¯”å’Œèƒ½æ•ˆæ¯”ã€‚\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä½ éœ€è¦é™æ€åˆ†é…å¥½çº¿ç¨‹ (ä¾‹å¦‚ 4 ä¸ª workers)ï¼Œç„¶åç”±è¿™äº›çº¿ç¨‹å®Œæˆè®¡ç®—ä»»åŠ¡ã€‚Online Judge æµ‹è¯•æ—¶çš„çº¿ç¨‹åº“ä¸åŒå­¦ä»¬å®éªŒä»£ç ä¸­çš„å®Œå…¨ä¸€æ ·ã€‚\", _jsx(_components.strong, {\n        children: \"æˆ‘ä»¬åªä¼šå¤åˆ¶ä½ çš„å•ä¸ªæ–‡ä»¶ gpt.c è¿›è¡Œè¯„æµ‹\"\n      }), \"ã€‚\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"4. å®éªŒæŒ‡å—\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"4.1 GPT-2 å·¥ä½œåŸç†\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"é¦–å…ˆï¼Œgpt.c çš„æºä»£ç å°±æ˜¯æœ€å¥½çš„è€å¸ˆï¼å®ƒå®ç°äº†å¯¹ç¥ç»ç½‘ç»œçš„ â€œçœŸæ­£æ•°å­¦ä¸¥æ ¼â€ çš„æè¿°â€”â€”å¦‚æœæˆ‘ä»¬çœ‹ PyTorch çš„ä»£ç ï¼Œå…¶ä¸­ä¼šæ¶‰åŠè®¸å¤šå†…ç½®çš„ç®—å­ï¼Œä½ å¯¹å…¶ä¸­çš„å®ç°å…¶å®å¹¶ä¸ 100% ç†è§£â€”â€”ä½†å¯¹äº C ä»£ç è¿™ç§è¯­ä¹‰ â€œæ‰å¹³â€ çš„è¯­è¨€æ¥è¯´ï¼Œä½ çœŸçš„å¯ä»¥å®Œå…¨ç†è§£å®ƒï¼æ­¤å¤–ï¼Œæˆ‘ä»¬ç»™ä¸€ä¸ª\", _jsx(_components.a, {\n        href: \"https://jalammar.github.io/illustrated-gpt2/\",\n        children: \"å¤–é“¾\"\n      }), \"ï¼Œä¹Ÿè¿˜æ¨è \", _jsx(_components.a, {\n        href: \"https://udlbook.github.io/udlbook/\",\n        children: \"Understanding Deep Learning\"\n      }), \"ã€‚\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"4.2 å¯»æ‰¾å¹¶è¡Œçš„æœºä¼š\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"å¦‚ä½•ä¼˜åŒ–ä½ çš„ä»£ç ï¼Ÿåœ¨å¼€å§‹ä»»ä½•ä¼˜åŒ–ä¹‹å‰ï¼Œé¦–å…ˆçœ‹ D. E. Knuth çš„åè¨€ï¼š\"\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"Premature optimization is the root of all evil.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"â€œPrematureâ€ ä¸ä»…æŒ‡ä½ ä¸åº”è¯¥åœ¨å®ç°ä»£ç çš„è¿‡ç¨‹ä¸­åš â€œä»»æ„â€ çš„ä¼˜åŒ–ï¼Œå®ƒä»¬å¯èƒ½æ”¶æ•ˆç”šå¾®ï¼Œä½†å¤§å¹…ç ´åäº†ä½ ä»£ç çš„å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ç­‰ã€‚â€œPrematureâ€ åŒæ ·æŒ‡ä½ ä¸åº”è¯¥éšæ„åœ°å»åŠ¨ä½ çš„ä»£ç ï¼Œç„¶åå»åšä¸€äº›æƒ³å½“ç„¶çš„ä¼˜åŒ–ã€‚åŒæ ·ï¼Œè¿™äº›ä¼˜åŒ–å¯èƒ½ç ´åå¯è¯»æ€§ï¼Œè€Œä¸”å¾ˆå¯èƒ½æ²¡æœ‰ä»€ä¹ˆæ•ˆæœã€‚\"\n    }), \"\\n\", _jsx(Quiz, {\n      title: \"æ€ä¹ˆåšå‡ºæ­£ç¡®çš„ä¼˜åŒ–ï¼Ÿ\",\n      question: \"ç»™å¤§å®¶ä¸€ä¸ªæç¤ºï¼šEverything is a state machine. å¦‚æœé¡ºç€è¿™ä¸ªæ€è·¯å‡ºå‘ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆè€ƒè™‘æ€§èƒ½ä¼˜åŒ–è¿™ä¸ªé—®é¢˜ï¼Ÿ\",\n      options: [],\n      answer: \"0\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ç­”æ¡ˆæ˜¯ï¼šæˆ‘ä»¬åº”è¯¥è§‚å¯ŸçŠ¶æ€æœºçš„æ‰§è¡Œã€‚æ ¹æ®äºŒå…«å®šå¾‹ï¼Œç»å¤§éƒ¨åˆ†çš„æ—¶é—´åº”è¯¥æ˜¯æ¶ˆè€—åœ¨å°‘éƒ¨åˆ†æ“ä½œä¸Šçš„ã€‚å› æ­¤ï¼Œä½ é¦–å…ˆéœ€è¦ç†è§£ç¨‹åºçš„å“ªä¸ªéƒ¨åˆ†æ¶ˆè€—äº†æœ€å¤šçš„æ—¶é—´â€”â€”é’ˆå¯¹æ€§åœ°ï¼Œæˆ‘ä»¬ä¹Ÿåº”å½“è¯•å›¾ä¼˜åŒ– (å¹¶è¡ŒåŒ–) è¿™äº›ä»£ç â€”â€”ä½ å¯¹å ç”¨ 1% æ—¶é—´çš„ä»£ç ï¼Œå³ä¾¿ä¼˜åŒ–åˆ°æè‡´ä½¿è¿è¡Œæ—¶é—´å®Œå…¨ä¸º 0ï¼Œä½ çš„æ”¶ç›Šä¹Ÿè¿‘ä¹ä¸ºé›¶ã€‚\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"å½“ç„¶ï¼Œä½ éœ€è¦å·¥å…·ï¼šprofilerï¼Œç”¨äºé‡‡æ ·çŠ¶æ€æœºçš„æ‰§è¡Œï¼Œâ€œå¯†é›†â€ çš„é‡‡æ ·å°±èƒ½å¾—åˆ°ç¨‹åºæ¶ˆè€—æ—¶é—´çš„åºåˆ—ã€‚\"\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsxs(_components.p, {\n        children: [\"In \", _jsx(_components.a, {\n          href: \"https://en.wikipedia.org/wiki/Software_engineering\",\n          children: \"software engineering\"\n        }), \", \", _jsx(_components.strong, {\n          children: \"profiling\"\n        }), \" (\\\"program profiling\\\", \\\"software profiling\\\") is a form of \", _jsx(_components.a, {\n          href: \"https://en.wikipedia.org/wiki/Dynamic_program_analysis\",\n          children: \"dynamic program analysis\"\n        }), \" that measures, for example, the space (memory) or time \", _jsx(_components.a, {\n          href: \"https://en.wikipedia.org/wiki/Computational_complexity_theory\",\n          children: \"complexity of a program\"\n        }), \", the \", _jsx(_components.a, {\n          href: \"https://en.wikipedia.org/wiki/Instruction_set_simulator\",\n          children: \"usage of particular instructions\"\n        }), \", or the frequency and duration of function calls. Most commonly, profiling information serves to aid \", _jsx(_components.a, {\n          href: \"https://en.wikipedia.org/wiki/Program_optimization\",\n          children: \"program optimization\"\n        }), \".\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ä¾‹å¦‚ï¼ŒLinux perf å·¥å…·æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—ç”¨äºåˆ†æç¨‹åºæ€§èƒ½å’Œè·Ÿè¸ªç³»ç»Ÿäº‹ä»¶çš„åŠŸèƒ½ã€‚è¿™ä¸ªå·¥å…·æ˜¯å†…æ ¸ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œåˆ©ç”¨äº† Linux å†…æ ¸ä¸­çš„æ€§èƒ½è®¡æ•°å™¨å­ç³»ç»Ÿã€‚Perf å¯ä»¥å¸®åŠ©å¼€å‘è€…å’Œç³»ç»Ÿç®¡ç†å‘˜ç›‘æ§æ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½ï¼ŒåŒ…æ‹¬ç¡¬ä»¶å’Œè½¯ä»¶å±‚é¢ã€‚Perf å·¥å…·èƒ½å¤Ÿæµ‹é‡è½¯ä»¶äº‹ä»¶å¦‚å‡½æ•°è°ƒç”¨å’Œç¨‹åºæ‰§è¡Œæ—¶é—´ï¼Œå¹¶ä¸”èƒ½å¤Ÿç›‘æ§ç¡¬ä»¶äº‹ä»¶æ¯”å¦‚ CPU å‘¨æœŸæ•°ã€æŒ‡ä»¤æ•°ä»¥åŠç¼“å­˜å‘½ä¸­å’Œæœªå‘½ä¸­çš„æƒ…å†µã€‚è¿™ä½¿å¾—å®ƒéå¸¸é€‚åˆäºæ€§èƒ½è°ƒä¼˜å’Œå¯»æ‰¾ç“¶é¢ˆã€‚æ­¤å¤–ï¼Œperf æ”¯æŒäº‹ä»¶çš„å®æ—¶è¿½è¸ªï¼Œèƒ½å¤Ÿè®°å½•å’ŒæŠ¥å‘Šç³»ç»Ÿè¿è¡Œä¸­çš„å„ç§äº‹ä»¶ï¼Œå¦‚ä¸Šä¸‹æ–‡åˆ‡æ¢ã€ç³»ç»Ÿè°ƒç”¨ã€é¡µé”™è¯¯ç­‰ã€‚è¿™äº›åŠŸèƒ½ä½¿å¾— perf æˆä¸º Linux ç³»ç»Ÿæ€§èƒ½åˆ†æå’Œé—®é¢˜è¯Šæ–­çš„é‡è¦å·¥å…·ã€‚\"\n    }), \"\\n\", _jsxs(\"center\", {\n      children: [\" \", _jsx(_components.img, {\n        src: \"../../img/perf-top.gif\",\n        alt: \"\"\n      }), \" \"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"4.3 ä½¿ç”¨çº¿ç¨‹åº“å®ç°å¹¶è¡Œ\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"å¦‚æœä½ ä¸çŸ¥é“æ€ä¹ˆå®ç°å¹¶è¡Œï¼Œå¯ä»¥ä»æˆ‘ä»¬è¯¾å ‚çš„ä»£ç å…¥æ‰‹ï¼Œä¾‹å¦‚ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ï¼š\"\n    }), \"\\n\", _jsx(Demo, {\n      path: \"concur/producer-consumer\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"æˆ‘ä»¬å·²ç»æåˆ°ï¼Œç”Ÿäº§è€…-æ¶ˆè´¹è€…å¯ä»¥è§£å†³å¤§å®¶ 99% çš„å¹¶è¡Œç¼–ç¨‹é—®é¢˜â€”â€”è¿™ä¸ªè‡ªç„¶ä¸ä¾‹å¤–ã€‚\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}},"frontmatter":{"title":"M3: GPT-2 å¹¶è¡Œæ¨ç† (gpt.c)"}},"__N_SSG":true},"page":"/[[...index]]","query":{"index":["OS","2024","labs","M3.md"]},"buildId":"a2FwJzUPGFGc0QcwaUr13","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>