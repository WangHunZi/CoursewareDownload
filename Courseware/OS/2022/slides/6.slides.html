<!DOCTYPE html><html class="h-100">


<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="../../../static/css/base.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com/"></script>
  <link href="https://fonts.font.im/css?family=Source+Serif+Pro%7CLato%7CInconsolata" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="../../../static/img/favicon.png" type="image/x-icon">

  <style>
    .font-sans {
      font-family: 'Lato', 'SimHei', 'STHeiti', 'SimHei', 'Serif';
    }
    .font-serif {
      font-family: 'Source Serif Pro', 'Songti SC', 'SimSun', 'Serif', serif;
    }
  </style>
  <link rel="stylesheet" href="../../../static/katex/katex.min.css">
  <script defer src="../../../static/katex/katex.min.js"></script>
  <script defer src="../../../static/katex/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
  <script>
      document.addEventListener("DOMContentLoaded", function() {
          renderMathInElement(document.body, {
            // customised options
            // â€¢ auto-render specific keys, e.g.:
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false},
                {left: '\\(', right: '\\)', display: false},
                {left: '\\[', right: '\\]', display: true}
            ],
            // â€¢ rendering keys, e.g.:
            throwOnError : false
          });
      });
  </script>


  

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="stylesheet" href="../../../static/reveal/reveal.css">
<link rel="stylesheet" href="../../../static/reveal/theme/simple.css" id="theme">

<style>
.reveal .slide-number {
  font-size: 26px;
  border-radius: 5px;
  background-color: rgba(0, 0, 0, .3);
}

.reveal .full-screen {
    width: 100%;
    height: 100%;
    object-fit: cover;
    position: absolute;
    top: 0;
    left: 0;
    z-index: -1;
}

.reveal .slides {
  border: 1.5px #ddd solid;
  border-radius: 7px;
  text-align: left;
  font-weight: 300;
}

.reveal h1, .reveal h2, .reveal h3, .reveal h4 {
  font-family: 'Lato', 'SimHei', 'STXihei', 'Droid Sans';
  font-weight: 400;
}

.reveal p, .reveal li, .reveal center {
  font-size: 32px;
  font-family: 'Lato', 'STHeiti', 'SimHei', 'Droid Sans';
}

.reveal li + li {
  margin-top: 10px;
}

.reveal ul {
  display: block;
  margin-right: 15px;
}

.reveal p, .reveal h1, .reveal h2, .reveal h3, .reveal h4, .reveal h5 {
  padding:  0 25px 0 25px;
}

.reveal table {
  font-size: 32px;
  font-family: 'Lato', 'STHeiti', 'SimHei', 'Sans Serif';
  margin-top: 15px;
  margin-bottom: 15px;
}

.reveal th {
  background-color: #eee;
}

.reveal tr:nth-child(even) {
  background-color: #efffff;
}

.reveal h1,
.reveal h2,
.reveal h3,
.reveal h4,
.reveal h5,
.reveal h6 {
  text-align: left;
  margin: 0 0 20px 0;
 color: #222; 
  font-weight: 400;
  line-height: 1.2;
  letter-spacing: normal;
}



.reveal h1 {
  margin: 0 10 0 10;
  font-size: 60px;
}
.reveal .middle h1 {
  text-align: center;
}

.reveal h2 {
  font-size: 48px;
  border-bottom: 2px solid rgb(106, 0, 95);
  padding-bottom: 5px;
}
.reveal h3 { font-size: 1.15em; }
.reveal h4 { font-size: 1.05em; }

.reveal .center {
  text-align: center;
}

.reveal .middle {
  height: 728px;
  display: flex;
  align-items: center;
  width: 100%;
}

.reveal pre {
  font-size: 28px;
 
  background-color: #eee;

  border-radius: 3mm;
  padding: 10px 10px 10px 10px;
}

.reveal pre code {
  max-height: none;
}

.reveal code {
  font-family: 'Inconsolata', 'AR PL Ukai CN', 'STKaiti', 'KaiTi', 'Sans Serif', Monospace;
}

.reveal .middle blockquote {
  text-align: center;
  color: rgb(106, 0, 95);
  background: none;
  box-shadow: none;
}

.reveal .middle blockquote a {
  color: inherit;
}

.reveal blockquote p, .reveal blockquote li {
  font-family: 'Lato', 'AR PL Ukai CN', 'STKaiti', 'KaiTi', 'Sans Serif';
}

section .center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.reveal .author-block {
  margin: 75px 0 35px 0;
}
.reveal .author-affiliation img {
  margin: 15px 0 0 0;
}
.reveal .author-block p, .reveal .author-affiliation p  {
  font-family: 'Kaiti', 'STKaiti', 'Serif', 'Times', 'Times New Roman';
  margin-block-start: 0em;
  margin-block-end: 0em;
}
.reveal .author-affiliation {
  display: inline-block;
  font-size: 90%;
}
.reveal hr {
  border: 10px solid rgba(0, 0, 0, 0);
}
.reveal li {
  margin-top: 10px;
}
</style>

  <title>å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥</title>
</head>

<body class="d-flex flex-column h-100">
  
  

<div class="reveal">
<div class="slides">
   
    <section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="_1" class=" text-2xl mt-2 font-sans">å¹¶å‘æ§åˆ¶ï¼šåŒæ­¥</h1>
<p class=" font-serif my-1"><include src="Slides_Author/index.html"><div><div class="py-16">
<p class=" font-serif my-1"><a href="http://ics.nju.edu.cn/~jyy" class=" text-amber-900">è’‹ç‚å²©</a></p>
</div>
<div class="row">
<div class="author-affiliation">
    <a href="http://www.nju.edu.cn/" class=" text-amber-900"><p class=" font-serif my-1">ã€€ã€€å—äº¬å¤§å­¦ã€€ã€€</p>
    <img class="inline-img h-24" src="../../../static/img/nju-logo.jpg" style="display: inline-block;"></a>
  </div>
<div class="author-affiliation">
   <a href="http://cs.nju.edu.cn/" class=" text-amber-900"><p class=" font-serif my-1">è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ç³»</p>
    <img class="inline-img h-24" src="../../../static/img/njucs-logo.jpg" style="display: inline-block;"></a>
  </div>
<div class="author-affiliation">
    <a href="https://cs.nju.edu.cn/ics/" class=" text-amber-900"><p class=" font-serif my-1">è®¡ç®—æœºè½¯ä»¶ç ”ç©¶æ‰€</p>
    <img class="inline-img h-24" src="../../../static/img/ics-logo.png" style="display: inline-block;"></a>
  </div>
</div></div></include></p></div></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="overview" class=" text-xl mt-2 pb-2 font-sans">Overview</h2>
<p class=" font-serif my-1">å¤ä¹ </p>
<ul class=" list-disc font-serif">
<li class=" ml-8">äº’æ–¥ï¼šè‡ªæ—‹é”ã€äº’æ–¥é”ã€futex</li>
<li class=" ml-8"><del>æ˜¯æ—¶å€™é¢å¯¹çœŸæ­£çš„å¹¶å‘ç¼–ç¨‹äº†</del></li>
</ul>
<hr>
<p class=" font-serif my-1">æœ¬æ¬¡è¯¾å›ç­”çš„é—®é¢˜</p>
<ul class=" list-disc font-serif">
<li class=" ml-8"><strong>Q</strong>: å¦‚ä½•åœ¨å¤šå¤„ç†å™¨ä¸ŠååŒå¤šä¸ªçº¿ç¨‹å®Œæˆä»»åŠ¡ï¼Ÿ</li>
</ul>
<hr>
<p class=" font-serif my-1">æœ¬æ¬¡è¯¾ä¸»è¦å†…å®¹</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">å…¸å‹çš„åŒæ­¥é—®é¢˜ï¼šç”Ÿäº§è€…-æ¶ˆè´¹è€…ï¼›å“²å­¦å®¶åƒé¥­</li>
<li class=" ml-8">åŒæ­¥çš„å®ç°æ–¹æ³•ï¼šä¿¡å·é‡ã€æ¡ä»¶å˜é‡</li>
</ul></div>
        
      
      </section>
    
    </section>
   
    <section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="_1" class=" text-2xl mt-2 font-sans">çº¿ç¨‹åŒæ­¥</h1></div></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="synchronization" class=" text-xl mt-2 pb-2 font-sans">åŒæ­¥ (Synchronization)</h2>
<p class=" font-serif my-1">ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šéšæ—¶é—´å˜åŒ–çš„é‡åœ¨å˜åŒ–è¿‡ç¨‹ä¸­ä¿æŒä¸€å®šçš„ç›¸å¯¹å…³ç³»</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">iPhone/iCloud åŒæ­¥ (æ‰‹æœº vs ç”µè„‘ vs äº‘ç«¯)</li>
<li class=" ml-8">å˜é€Ÿç®±åŒæ­¥å™¨ (åˆå¹¶å¿«æ…¢é€Ÿé½¿è½®)</li>
<li class=" ml-8">åŒæ­¥ç”µæœº (è½¬å­ä¸ç£åœºé€Ÿåº¦ä¸€è‡´)</li>
<li class=" ml-8">åŒæ­¥ç”µè·¯ (æ‰€æœ‰è§¦å‘å™¨åœ¨è¾¹æ²¿åŒæ—¶è§¦å‘)</li>
</ul>
<hr>
<p class=" font-serif my-1">å¼‚æ­¥ (Asynchronous) = ä¸åŒæ­¥</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">ä¸Šè¿°å¾ˆå¤šä¾‹å­éƒ½æœ‰å¼‚æ­¥ç‰ˆæœ¬ (å¼‚æ­¥ç”µæœºã€å¼‚æ­¥ç”µè·¯ã€å¼‚æ­¥çº¿ç¨‹)</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">å¹¶å‘ç¨‹åºä¸­çš„åŒæ­¥</h2>
<p class=" font-serif my-1">å¹¶å‘ç¨‹åºçš„æ­¥è°ƒå¾ˆéš¾ä¿æŒ â€œå®Œå…¨ä¸€è‡´â€</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">çº¿ç¨‹åŒæ­¥ï¼š<red>åœ¨æŸä¸ªæ—¶é—´ç‚¹å…±åŒè¾¾åˆ°äº’ç›¸å·²çŸ¥çš„çŠ¶æ€</red></li>
</ul>
<hr>
<p class=" font-serif my-1">å†æ¬¡æŠŠçº¿ç¨‹æƒ³è±¡æˆæˆ‘ä»¬è‡ªå·±</p>
<p class=" font-serif my-1"><img alt="" class="float-right" src="../../../pages/OS/img/ge.jpg" width="190px"></p>
<ul class=" list-disc font-serif">
<li class=" ml-8">NPYï¼šç­‰æˆ‘æ´—ä¸ªå¤´å°±å‡ºé—¨/ç­‰æˆ‘æ‰“å®Œè¿™å±€æ¸¸æˆå°±æ¥</li>
<li class=" ml-8">èˆå‹ï¼šç­‰æˆ‘ä¿®å¥½è¿™ä¸ª bug å°±åƒé¥­</li>
<li class=" ml-8">å¯¼å¸ˆï¼šç­‰æˆ‘å‡ºå·®å›æ¥å°±è®¨è®ºè¿™ä¸ªè¯¾é¢˜</li>
<li class=" ml-8">jyy: <del>ç­‰æˆ‘æˆä¸ºå·ç‹å°±èººå¹³</del><ul class=" list-disc font-serif">
<li class=" ml-8">â€œå…ˆåˆ°å…ˆç­‰â€</li>
</ul>
</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="-" class=" text-xl mt-2 pb-2 font-sans">ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ï¼šå­¦åºŸä½ å°±èµ¢äº†</h2>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<p class=" font-serif my-1"><red>99% çš„å®é™…å¹¶å‘é—®é¢˜éƒ½å¯ä»¥ç”¨ç”Ÿäº§è€…-æ¶ˆè´¹è€…è§£å†³</red>ã€‚</p>
</blockquote>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">Tproduce</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">printf</span><span class="p">(</span><span class="s">"("</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">Tconsume</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">printf</span><span class="p">(</span><span class="s">")"</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>

<p class=" font-serif my-1">åœ¨ <code>printf</code> å‰åå¢åŠ ä»£ç ï¼Œä½¿å¾—æ‰“å°çš„æ‹¬å·åºåˆ—æ»¡è¶³</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">ä¸€å®šæ˜¯æŸä¸ªåˆæ³•æ‹¬å·åºåˆ—çš„å‰ç¼€</li>
<li class=" ml-8">æ‹¬å·åµŒå¥—çš„æ·±åº¦ä¸è¶…è¿‡ $n$<ul class=" list-disc font-serif">
<li class=" ml-8">$n=3$, <code>((())())(((</code> åˆæ³•</li>
<li class=" ml-8">$n=3$, <code>(((())))</code>, <code>(()))</code> ä¸åˆæ³•</li>
</ul>
</li>
<li class=" ml-8">åŒæ­¥<ul class=" list-disc font-serif">
<li class=" ml-8">ç­‰åˆ°æœ‰ç©ºä½å†æ‰“å°å·¦æ‹¬å·</li>
<li class=" ml-8">ç­‰åˆ°èƒ½é…å¯¹æ—¶å†æ‰“å°å³æ‹¬å·</li>
</ul>
</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="-" class=" text-xl mt-2 pb-2 font-sans">ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ï¼šåˆ†æ</h2>
<p class=" font-serif my-1">ä¸ºä»€ä¹ˆå« â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€ è€Œä¸æ˜¯ â€œæ‹¬å·é—®é¢˜â€ï¼Ÿ</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">å·¦æ‹¬å·ï¼šç”Ÿäº§èµ„æº (ä»»åŠ¡)ã€æ”¾å…¥é˜Ÿåˆ—</li>
<li class=" ml-8">å³æ‹¬å·ï¼šä»é˜Ÿåˆ—å–å‡ºèµ„æº (ä»»åŠ¡) æ‰§è¡Œ</li>
</ul>
<hr>
<p class=" font-serif my-1">èƒ½å¦ç”¨äº’æ–¥é”å®ç°æ‹¬å·é—®é¢˜ï¼Ÿ</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">å·¦æ‹¬å·ï¼šåµŒå¥—æ·±åº¦ (é˜Ÿåˆ—) ä¸è¶³ $n$ æ—¶æ‰èƒ½æ‰“å°</li>
<li class=" ml-8">å³æ‹¬å·ï¼šåµŒå¥—æ·±åº¦ (é˜Ÿåˆ—) $>1$ æ—¶æ‰èƒ½æ‰“å°<ul class=" list-disc font-serif">
<li class=" ml-8"><red>å½“ç„¶æ˜¯ç­‰åˆ°æ»¡è¶³æ¡ä»¶æ—¶å†æ‰“å°äº†</red>ï¼š<a href="../../../pages/OS/2022/demos/pc.c" class=" text-amber-900">pc.c</a><ul class=" list-disc font-serif">
<li class=" ml-8"><red>ç”¨äº’æ–¥é”ä¿æŒæ¡ä»¶æˆç«‹</red></li>
</ul>
</li>
<li class=" ml-8">å‹åŠ›æµ‹è¯•çš„æ£€æŸ¥å½“ç„¶ä¸èƒ½å°‘ï¼š<a href="../../../pages/OS/2022/demos/pc-check.py" class=" text-amber-900">pc-check.py</a></li>
<li class=" ml-8">Model checker å½“ç„¶ä¹Ÿä¸èƒ½å°‘ (ç•™ä½œä¹ é¢˜)</li>
</ul>
</li>
</ul></div>
        
      
      </section>
    
    </section>
   
    <section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="_1" class=" text-2xl mt-2 font-sans">æ¡ä»¶å˜é‡ï¼šä¸‡èƒ½åŒæ­¥æ–¹æ³•</h1></div></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">åŒæ­¥é—®é¢˜ï¼šåˆ†æ</h2>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<p class=" font-serif my-1">ä»»ä½•åŒæ­¥é—®é¢˜éƒ½<red>æœ‰å…ˆæ¥å…ˆç­‰å¾…çš„æ¡ä»¶</red>ã€‚</p>
</blockquote>
<p class=" font-serif my-1">çº¿ç¨‹ join (<a href="../../../pages/OS/2022/demos/thread.h" class=" text-amber-900">thread.h</a>, <a href="../../../pages/OS/2022/demos/sum.c" class=" text-amber-900">sum.c</a>)</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">ç­‰æ‰€æœ‰çº¿ç¨‹ç»“æŸåç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™ç­‰å¾…</li>
</ul>
<hr>
<p class=" font-serif my-1">NPY çš„ä¾‹å­</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">æ‰“å®Œæ¸¸æˆä¸”æ´—å®Œå¤´åç»§ç»­æ‰§è¡Œ <code>date()</code>ï¼Œå¦åˆ™ç­‰å¾…</li>
</ul>
<hr>
<p class=" font-serif my-1">ç”Ÿäº§è€…/æ¶ˆè´¹è€…é—®é¢˜</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">å·¦æ‹¬å·ï¼šæ·±åº¦ $k < n$ æ—¶ <code>printf</code>ï¼Œå¦åˆ™ç­‰å¾…</li>
<li class=" ml-8">å³æ‹¬å·ï¼š$k > 0$ æ—¶ <code>printf</code>ï¼Œå¦åˆ™ç­‰å¾…<ul class=" list-disc font-serif">
<li class=" ml-8">å†çœ‹ä¸€çœ¼ <a href="../../../pages/OS/2022/demos/pc.c" class=" text-amber-900">pc.c</a></li>
</ul>
</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="conditional-variables-cv" class=" text-xl mt-2 pb-2 font-sans">Conditional Variables (æ¡ä»¶å˜é‡, CV)</h2>
<p class=" font-serif my-1">æŠŠ <a href="../../../pages/OS/2022/demos/pc.c" class=" text-amber-900">pc.c</a> ä¸­çš„è‡ªæ—‹å˜æˆç¡çœ </p>
<ul class=" list-disc font-serif">
<li class=" ml-8">åœ¨å®Œæˆæ“ä½œæ—¶å”¤é†’</li>
</ul>
<hr>
<p class=" font-serif my-1">æ¡ä»¶å˜é‡ API</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">wait(cv, mutex) ğŸ’¤<ul class=" list-disc font-serif">
<li class=" ml-8">è°ƒç”¨æ—¶å¿…é¡»ä¿è¯å·²ç»è·å¾— mutex</li>
<li class=" ml-8">é‡Šæ”¾ mutexã€è¿›å…¥ç¡çœ çŠ¶æ€</li>
</ul>
</li>
<li class=" ml-8">signal/notify(cv) ğŸ’¬ ç§ä¿¡ï¼šèµ°èµ·<ul class=" list-disc font-serif">
<li class=" ml-8">å¦‚æœæœ‰çº¿ç¨‹æ­£åœ¨ç­‰å¾… cvï¼Œåˆ™å”¤é†’å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹</li>
</ul>
</li>
<li class=" ml-8">broadcast/notifyAll(cv) ğŸ“£ æ‰€æœ‰äººï¼šèµ°èµ·<ul class=" list-disc font-serif">
<li class=" ml-8">å”¤é†’å…¨éƒ¨æ­£åœ¨ç­‰å¾… cv çš„çº¿ç¨‹</li>
</ul>
</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="-" class=" text-xl mt-2 pb-2 font-sans">æ¡ä»¶å˜é‡ï¼šå®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…</h2>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">Tproduce</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&</span><span class="n">lk</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="n">cond_wait</span><span class="p">(</span><span class="o">&</span><span class="n">cv</span><span class="p">,</span><span class="w"> </span><span class="o">&</span><span class="n">lk</span><span class="p">);</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">"("</span><span class="p">);</span><span class="w"> </span><span class="n">count</span><span class="o">++</span><span class="p">;</span><span class="w"> </span><span class="n">cond_signal</span><span class="p">(</span><span class="o">&</span><span class="n">cv</span><span class="p">);</span>
<span class="w">  </span><span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&</span><span class="n">lk</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Tconsume</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&</span><span class="n">lk</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">cond_wait</span><span class="p">(</span><span class="o">&</span><span class="n">cv</span><span class="p">,</span><span class="w"> </span><span class="o">&</span><span class="n">lk</span><span class="p">);</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">")"</span><span class="p">);</span><span class="w"> </span><span class="n">count</span><span class="o">--</span><span class="p">;</span><span class="w"> </span><span class="n">cond_signal</span><span class="p">(</span><span class="o">&</span><span class="n">cv</span><span class="p">);</span>
<span class="w">  </span><span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&</span><span class="n">lk</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p class=" font-serif my-1">å‹åŠ›æµ‹è¯•ï¼š<a href="../../../pages/OS/2022/demos/pc-cv.c" class=" text-amber-900">pc-cv.c</a>ï¼›æ¨¡å‹æ£€éªŒï¼š<a href="../../../pages/OS/2022/demos/pc-cv.py" class=" text-amber-900">pc-cv.py</a></p>
<ul class=" list-disc font-serif">
<li class=" ml-8">(Small scope hypothesis)</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">æ¡ä»¶å˜é‡ï¼šæ­£ç¡®çš„æ‰“å¼€æ–¹å¼</h2>
<p class=" font-serif my-1">éœ€è¦<red>ç­‰å¾…æ¡ä»¶æ»¡è¶³æ—¶</red></p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&</span><span class="n">mutex</span><span class="p">);</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">cond</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">wait</span><span class="p">(</span><span class="o">&</span><span class="n">cv</span><span class="p">,</span><span class="w"> </span><span class="o">&</span><span class="n">mutex</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">assert</span><span class="p">(</span><span class="n">cond</span><span class="p">);</span>
<span class="c1">// ...</span>
<span class="c1">// äº’æ–¥é”ä¿è¯äº†åœ¨æ­¤æœŸé—´æ¡ä»¶ cond æ€»æ˜¯æˆç«‹</span>
<span class="c1">// ...</span>
<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&</span><span class="n">mutex</span><span class="p">);</span>
</code></pre></div>

<p class=" font-serif my-1"><red>å…¶ä»–çº¿ç¨‹æ¡ä»¶å¯èƒ½è¢«æ»¡è¶³æ—¶</red></p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="n">broadcast</span><span class="p">(</span><span class="o">&</span><span class="n">cv</span><span class="p">);</span>
</code></pre></div>

<ul class=" list-disc font-serif">
<li class=" ml-8">ä¿®æ”¹ <a href="../../../pages/OS/2022/demos/pc-cv.c" class=" text-amber-900">pc-cv.c</a> å’Œ <a href="../../../pages/OS/2022/demos/pc-cv.py" class=" text-amber-900">pc-cv.py</a></li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">æ¡ä»¶å˜é‡ï¼šå®ç°å¹¶è¡Œè®¡ç®—</h2>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">job</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">run</span><span class="p">)(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">arg</span><span class="p">);</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">arg</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">job</span><span class="w"> </span><span class="o">*</span><span class="n">job</span><span class="p">;</span>

<span class="w">  </span><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&</span><span class="n">mutex</span><span class="p">);</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="p">(</span><span class="n">job</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_job</span><span class="p">())</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">wait</span><span class="p">(</span><span class="o">&</span><span class="n">cv</span><span class="p">,</span><span class="w"> </span><span class="o">&</span><span class="n">mutex</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&</span><span class="n">mutex</span><span class="p">);</span>

<span class="w">  </span><span class="n">job</span><span class="o">-></span><span class="n">run</span><span class="p">(</span><span class="n">job</span><span class="o">-></span><span class="n">arg</span><span class="p">);</span><span class="w"> </span><span class="c1">// ä¸éœ€è¦æŒæœ‰é”</span>
<span class="w">                      </span><span class="c1">// å¯ä»¥ç”Ÿæˆæ–°çš„ job</span>
<span class="w">                      </span><span class="c1">// æ³¨æ„å›æ”¶åˆ†é…çš„èµ„æº</span>
<span class="p">}</span>
</code></pre></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">æ¡ä»¶å˜é‡ï¼šæ›´å¤æ€ªçš„ä¹ é¢˜/é¢è¯•é¢˜</h2>
<p class=" font-serif my-1">æœ‰ä¸‰ç§çº¿ç¨‹ï¼Œåˆ†åˆ«æ‰“å° <code><</code>, <code>></code>, å’Œ <code>_</code></p>
<ul class=" list-disc font-serif">
<li class=" ml-8">å¯¹è¿™äº›çº¿ç¨‹è¿›è¡ŒåŒæ­¥ï¼Œä½¿å¾—æ‰“å°å‡ºçš„åºåˆ—æ€»æ˜¯ <code><><_</code> å’Œ <code>><>_</code> ç»„åˆ</li>
</ul>
<hr>
<p class=" font-serif my-1">ä½¿ç”¨æ¡ä»¶å˜é‡ï¼Œåªè¦å›ç­”ä¸‰ä¸ªé—®é¢˜ï¼š</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">æ‰“å° â€œ<code><</code>â€ çš„æ¡ä»¶ï¼Ÿ</li>
<li class=" ml-8">æ‰“å° â€œ<code>></code>â€ çš„æ¡ä»¶ï¼Ÿ</li>
<li class=" ml-8">æ‰“å° â€œ<code>_</code>â€ çš„æ¡ä»¶ï¼Ÿ<ul class=" list-disc font-serif">
<li class=" ml-8"><a href="../../../pages/OS/2022/demos/fish.c" class=" text-amber-900">fish.c</a></li>
</ul>
</li>
</ul></div>
        
      
      </section>
    
    </section>
   
    <section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="_1" class=" text-2xl mt-2 font-sans">ä¿¡å·é‡</h1></div></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">å¤ä¹ ï¼šäº’æ–¥é”å’Œæ›´è¡£å®¤ç®¡ç†</h2>
<p class=" font-serif my-1"><img alt="" class="float-right" src="../../../pages/OS/img/locker.jpg" width="300px"></p>
<p class=" font-serif my-1">æ“ä½œç³»ç»Ÿ = æ›´è¡£å®¤ç®¡ç†å‘˜</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">å…ˆåˆ°çš„äºº (çº¿ç¨‹)<ul class=" list-disc font-serif">
<li class=" ml-8">æˆåŠŸè·å¾—æ‰‹ç¯ï¼Œè¿›å…¥æ¸¸æ³³é¦† </li>
<li class=" ml-8"><code>*lk = ğŸ”’</code>ï¼Œç³»ç»Ÿè°ƒç”¨ç›´æ¥è¿”å›</li>
</ul>
</li>
<li class=" ml-8">ååˆ°çš„äºº (çº¿ç¨‹)<ul class=" list-disc font-serif">
<li class=" ml-8">ä¸èƒ½è¿›å…¥æ¸¸æ³³é¦†ï¼Œæ’é˜Ÿç­‰å¾…</li>
<li class=" ml-8">çº¿ç¨‹æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œæ‰§è¡Œçº¿ç¨‹åˆ‡æ¢ (yield)</li>
</ul>
</li>
<li class=" ml-8">æ´—å®Œæ¾¡å‡ºæ¥çš„äºº (çº¿ç¨‹)<ul class=" list-disc font-serif">
<li class=" ml-8">äº¤è¿˜æ‰‹ç¯ç»™ç®¡ç†å‘˜ï¼›ç®¡ç†å‘˜æŠŠæ‰‹ç¯å†äº¤ç»™æ’é˜Ÿçš„äºº</li>
<li class=" ml-8">å¦‚æœç­‰å¾…é˜Ÿåˆ—ä¸ç©ºï¼Œä»ç­‰å¾…é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªçº¿ç¨‹å…è®¸æ‰§è¡Œ</li>
<li class=" ml-8">å¦‚æœç­‰å¾…é˜Ÿåˆ—ä¸ºç©ºï¼Œ<code>*lk = âœ…</code></li>
</ul>
</li>
<li class=" ml-8"><red>ç®¡ç†å‘˜ (OS) ä½¿ç”¨è‡ªæ—‹é”ç¡®ä¿è‡ªå·±å¤„ç†æ‰‹ç¯çš„è¿‡ç¨‹æ˜¯åŸå­çš„</red></li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">æ›´è¡£å®¤ç®¡ç†</h2>
<p class=" font-serif my-1">å®Œå…¨æ²¡æœ‰å¿…è¦é™åˆ¶æ‰‹ç¯çš„æ•°é‡â€”â€”è®©æ›´å¤šåŒå­¦å¯ä»¥è¿›å…¥æ›´è¡£å®¤</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">ç®¡ç†å‘˜å¯ä»¥æŒæœ‰ä»»æ„æ•°é‡çš„æ‰‹ç¯ (æ›´è¡£å®¤å®¹é‡ä¸Šé™)<ul class=" list-disc font-serif">
<li class=" ml-8">å…ˆè¿›å…¥æ›´è¡£å®¤çš„åŒå­¦å…ˆå¾—åˆ°</li>
<li class=" ml-8">æ‰‹ç¯ç”¨å®Œåæ‰éœ€è¦ç­‰åŒå­¦å‡ºæ¥</li>
</ul>
</li>
</ul>
<p class=" font-serif my-1"></p><center><img alt="" class="inline" src="../../../pages/OS/img/locker.jpg" width="333px"> v.s. <img alt="" class="inline" src="../../../pages/OS/img/pool-2.jpg" width="330px"></center></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="by-ew-dijkstra" class=" text-xl mt-2 pb-2 font-sans">æ›´è¡£å®¤ç®¡ç† (by E.W. Dijkstra)</h2>
<p class=" font-serif my-1"><img alt="" class="float-right" src="../../../pages/OS/img/doraemon.gif" width="300px"></p>
<p class=" font-serif my-1">åšä¸€ç‚¹æ‰©å±•â€”â€”çº¿ç¨‹å¯ä»¥ä»»æ„ â€œå˜å‡ºâ€ ä¸€ä¸ªæ‰‹ç¯</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">æŠŠæ‰‹ç¯çœ‹æˆæ˜¯ä»¤ç‰Œ</li>
<li class=" ml-8">å¾—åˆ°ä»¤ç‰Œçš„å¯ä»¥è¿›å…¥æ‰§è¡Œ</li>
<li class=" ml-8">å¯ä»¥éšæ—¶åˆ›å»ºä»¤ç‰Œ</li>
</ul>
<hr>
<p class=" font-serif my-1">â€œæ‰‹ç¯â€ = â€œä»¤ç‰Œâ€ = â€œä¸€ä¸ªèµ„æºâ€ = â€œä¿¡å·é‡â€ (semaphore)</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">P(&sem) - prolaag = try + decrease; wait; down; in<ul class=" list-disc font-serif">
<li class=" ml-8">ç­‰å¾…ä¸€ä¸ªæ‰‹ç¯åè¿”å›</li>
<li class=" ml-8">å¦‚æœæ­¤æ—¶ç®¡ç†å‘˜æ‰‹ä¸Šæœ‰ç©ºé—²çš„æ‰‹ç¯ï¼Œç«‹å³è¿”å›</li>
</ul>
</li>
<li class=" ml-8">V(&sem) - verhoog = increase; post; up; out<ul class=" list-disc font-serif">
<li class=" ml-8">å˜å‡ºä¸€ä¸ªæ‰‹ç¯ï¼Œé€ç»™ç®¡ç†å‘˜</li>
</ul>
</li>
<li class=" ml-8">ä¿¡å·é‡çš„è¡Œä¸ºå»ºæ¨¡: <a href="../../../pages/OS/2022/demos/sem.py" class=" text-amber-900">sem.py</a></li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="-" class=" text-xl mt-2 pb-2 font-sans">ä¿¡å·é‡ï¼šå®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…</h2>
<p class=" font-serif my-1">ä¿¡å·é‡è®¾è®¡çš„é‡ç‚¹</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">è€ƒè™‘ â€œæ‰‹ç¯â€ (æ¯ä¸€å•ä½çš„ â€œ<red>èµ„æº</red>â€) æ˜¯ä»€ä¹ˆï¼Œè°åˆ›é€ ï¼Ÿè°è·å–ï¼Ÿ<ul class=" list-disc font-serif">
<li class=" ml-8"><a href="../../../pages/OS/2022/demos/pc-sem.c" class=" text-amber-900"><code>pc-sem.c</code></a></li>
</ul>
</li>
</ul>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">producer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">P</span><span class="p">(</span><span class="o">&</span><span class="n">empty</span><span class="p">);</span><span class="w">   </span><span class="c1">// P()è¿”å› -> å¾—åˆ°æ‰‹ç¯</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">"("</span><span class="p">);</span><span class="w"> </span><span class="c1">// å‡è®¾çº¿ç¨‹å®‰å…¨</span>
<span class="w">  </span><span class="n">V</span><span class="p">(</span><span class="o">&</span><span class="n">fill</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">consumer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">P</span><span class="p">(</span><span class="o">&</span><span class="n">fill</span><span class="p">);</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">")"</span><span class="p">);</span>
<span class="w">  </span><span class="n">V</span><span class="p">(</span><span class="o">&</span><span class="n">empty</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<ul class=" list-disc font-serif">
<li class=" ml-8">åœ¨ â€œä¸€å•ä½èµ„æºâ€ æ˜ç¡®çš„é—®é¢˜ä¸Šæ›´å¥½ç”¨</li>
</ul></div>
        
      
      </section>
    
    </section>
   
    <section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="_1" class=" text-2xl mt-2 font-sans">å“²å­¦å®¶åƒé¥­é—®é¢˜</h1></div></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="e-w-dijkstra-1960" class=" text-xl mt-2 pb-2 font-sans">å“²å­¦å®¶åƒé¥­é—®é¢˜ (E. W. Dijkstra, 1960)</h2>
<p class=" font-serif my-1">å“²å­¦å®¶ (çº¿ç¨‹) æœ‰æ—¶æ€è€ƒï¼Œæœ‰æ—¶åƒé¥­</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">åƒé¥­éœ€è¦åŒæ—¶å¾—åˆ°å·¦æ‰‹å’Œå³æ‰‹çš„å‰å­</li>
<li class=" ml-8">å½“å‰å­è¢«å…¶ä»–äººå æœ‰æ—¶ï¼Œå¿…é¡»ç­‰å¾…ï¼Œå¦‚ä½•å®ŒæˆåŒæ­¥ï¼Ÿ<ul class=" list-disc font-serif">
<li class=" ml-8">å¦‚ä½•ç”¨äº’æ–¥é”/ä¿¡å·é‡å®ç°ï¼Ÿ</li>
</ul>
</li>
</ul>
<p class=" font-serif my-1"><img alt="" class="center" src="../../../pages/OS/img/dining-philosophers.jpg" width="400px"></p></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">å¤±è´¥ä¸æˆåŠŸçš„å°è¯•</h2>
<p class=" font-serif my-1">å¤±è´¥çš„å°è¯•</p>
<ul class=" list-disc font-serif">
<li class=" ml-8"><a href="../../../pages/OS/2022/demos/philosopher.c" class=" text-amber-900">philosopher.c</a> (å¦‚ä½•è§£å†³ï¼Ÿ)</li>
</ul>
<hr>
<p class=" font-serif my-1">æˆåŠŸçš„å°è¯• (ä¸‡èƒ½çš„æ–¹æ³•)</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&</span><span class="n">mutex</span><span class="p">);</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">avail</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span><span class="w"> </span><span class="o">&&</span><span class="w"> </span><span class="n">avail</span><span class="p">[</span><span class="n">rhs</span><span class="p">]))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">wait</span><span class="p">(</span><span class="o">&</span><span class="n">cv</span><span class="p">,</span><span class="w"> </span><span class="o">&</span><span class="n">mutex</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">avail</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avail</span><span class="p">[</span><span class="n">rhs</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&</span><span class="n">mutex</span><span class="p">);</span>

<span class="n">mutex_lock</span><span class="p">(</span><span class="o">&</span><span class="n">mutex</span><span class="p">);</span>
<span class="n">avail</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avail</span><span class="p">[</span><span class="n">rhs</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="n">broadcast</span><span class="p">(</span><span class="o">&</span><span class="n">cv</span><span class="p">);</span>
<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&</span><span class="n">mutex</span><span class="p">);</span>
</code></pre></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">å¿˜äº†ä¿¡å·é‡ï¼Œè®©ä¸€ä¸ªäººé›†ä¸­ç®¡ç†å‰å­å§ï¼</h2>
<p class=" font-serif my-1">â€œLeader/followerâ€ - ç”Ÿäº§è€…/æ¶ˆè´¹è€…</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">åˆ†å¸ƒå¼ç³»ç»Ÿä¸­éå¸¸å¸¸è§çš„è§£å†³æ€è·¯ (HDFS, ...)</li>
</ul>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">Tphilosopher</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">send_request</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">EAT</span><span class="p">);</span>
<span class="w">  </span><span class="n">P</span><span class="p">(</span><span class="n">allowed</span><span class="p">[</span><span class="n">id</span><span class="p">]);</span><span class="w"> </span><span class="c1">// waiter ä¼šæŠŠå‰å­é€’ç»™å“²å­¦å®¶</span>
<span class="w">  </span><span class="n">philosopher_eat</span><span class="p">();</span>
<span class="w">  </span><span class="n">send_request</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">DONE</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Twaiter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receive_request</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EAT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DONE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">å¿˜äº†é‚£äº›å¤æ‚çš„åŒæ­¥ç®—æ³•å§ï¼</h2>
<p class=" font-serif my-1">ä½ å¯èƒ½ä¼šè§‰å¾—ï¼Œç®¡å‰å­çš„äººæ˜¯æ€§èƒ½ç“¶é¢ˆ</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">ä¸€å¤§æ¡Œäººåƒé¥­ï¼Œæ¯ä¸ªäººéƒ½å«æœåŠ¡å‘˜çš„æ„Ÿè§‰</li>
<li class=" ml-8">Premature optimization is the root of all evil (D. E. Knuth)</li>
</ul>
<hr>
<p class=" font-serif my-1"><red>æŠ›å¼€ workload è°ˆä¼˜åŒ–å°±æ˜¯è€æµæ°“</red></p>
<ul class=" list-disc font-serif">
<li class=" ml-8">åƒé¥­çš„æ—¶é—´é€šå¸¸è¿œè¿œå¤§äºè¯·æ±‚æœåŠ¡å‘˜çš„æ—¶é—´</li>
<li class=" ml-8">å¦‚æœä¸€ä¸ª manager æä¸å®šï¼Œå¯ä»¥åˆ†å¤šä¸ª (fast/slow path)<ul class=" list-disc font-serif">
<li class=" ml-8">æŠŠç³»ç»Ÿè®¾è®¡å¥½ï¼Œä½¿é›†ä¸­ç®¡ç†ä¸æˆä¸ºç“¶é¢ˆ<ul class=" list-disc font-serif">
<li class=" ml-8"><a href="https://www.usenix.org/conference/nsdi20/presentation/brooker" class=" text-amber-900">Millions of tiny databases</a> (NSDI'20)</li>
</ul>
</li>
</ul>
</li>
</ul></div>
        
      
      </section>
    
    </section>
   
    <section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="_1" class=" text-2xl mt-2 font-sans">æ€»ç»“</h1></div></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">æ€»ç»“</h2>
<p class=" font-serif my-1">æœ¬æ¬¡è¯¾å›ç­”çš„é—®é¢˜</p>
<ul class=" list-disc font-serif">
<li class=" ml-8"><strong>Q</strong>: å¦‚ä½•åœ¨å¤šå¤„ç†å™¨ä¸ŠååŒå¤šä¸ªçº¿ç¨‹å®Œæˆä»»åŠ¡ï¼Ÿ</li>
</ul>
<hr>
<p class=" font-serif my-1">Take-away message</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">å®ç°åŒæ­¥çš„æ–¹æ³•<ul class=" list-disc font-serif">
<li class=" ml-8">æ¡ä»¶å˜é‡ã€ä¿¡å·é‡ï¼›ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜</li>
<li class=" ml-8">Job queue å¯ä»¥å®ç°å‡ ä¹ä»»ä½•å¹¶è¡Œç®—æ³•</li>
</ul>
</li>
<li class=" ml-8">ä¸è¦ â€œè‡ªä½œèªæ˜â€ è®¾è®¡ç®—æ³•ï¼Œå°å¿ƒæ±‚è¯</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="end" class=" text-2xl mt-2 font-sans">End.</h1></div></div></div>
        
      
      </section>
    
    </section>
  
</div>
</div>

<script src="../../../static/reveal/reveal.js"></script>
<script>
  Reveal.initialize({
    
    width: 1024, height: 768,
    
    slideNumber: 'c/t',
    controlsTutorial: false,
    progress: false,
    hash: true,
    center: false,
    autoAnimateUnmatched: true,
    autoAnimateEasing: 'ease-out',
    autoAnimateDuration: 0.3,
    transitionSpeed: 'fast'
  });
</script>


</body>


</html>