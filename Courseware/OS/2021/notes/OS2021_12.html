<!DOCTYPE html><html class="h-100">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="../../../static/css/base.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.font.im/css?family=Source+Serif+Pro%7CLato%7CInconsolata" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="../../../static/img/favicon.png" type="image/x-icon">

  <style>
    .font-sans {
      font-family: 'Lato', 'SimHei', 'STHeiti', 'SimHei', 'Serif';
    }
    .font-serif {
      font-family: 'Source Serif Pro', 'Songti SC', 'SimSun', 'Serif', serif;
    }
  </style>
  <link rel="stylesheet" href="../../../static/katex/katex.min.css">
  <script defer src="../../../static/katex/katex.min.js"></script>
  <script defer src="../../../static/katex/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
  <script>
      document.addEventListener("DOMContentLoaded", function() {
          renderMathInElement(document.body, {
            // customised options
            // &#8226; auto-render specific keys, e.g.:
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false},
                {left: '\\(', right: '\\)', display: false},
                {left: '\\[', right: '\\]', display: true}
            ],
            // &#8226; rendering keys, e.g.:
            throwOnError : false
          });
      });
  </script>


  

<style>
.article {
  -webkit-hyphens: auto;
}
form {
  margin-block-end: 0;
}
img {
  display: inline-block;
}
code { font-size: 85%; }
pre {
  font-size: 95%;
  line-height: 120%;
}
blockquote {
  font-size: 95%;
}
p {
  font-size: 105%;
  text-indent: 2em;
}
li {
  font-size: 105%;
}
blockquote p {
  text-indent: 0em;
}
.float-right {
  padding-left: 10px;
}
.float-left {
  padding-right: 10px;
}
a {
  color: rgb(29 78 216);
}
strong {
  font-family: 'Lato', 'SimHei', 'STHeiti', 'SimHei', 'Serif';
}
.box        {
  border-radius: 2px; padding: 1px 4px 2px 4px;
  font-family: 'Lato', 'SimHei', 'STHeiti', 'SimHei', 'Serif';
  font-size: 95%;
}
.box-blue,  .badge-primary  { background-color: rgba(66, 139, 202, 0.5); color: #1d4ed8; }
.box-green, .badge-success  { background-color: rgba(92, 184, 92, 0.5);  color: #15803d; }
.box-red,   .badge-danger   { background-color: rgba(217, 83, 79, 0.5);  color: #b91c1c; }
.box-yellow,.badge-warning  { background-color: rgba(240, 173, 78, 0.5); color: #a16207; }
.box-gray   { background-color: #a0a0a0; }

.badge {
  padding: 1 4 1 4;
  display: inline-block;
  border-radius: 0.25rem;
  border: 1px solid;
}
.message p {
  text-indent: 0em;
  margin-top: 1px;
}
.message h1, h2, h3, h4, h5 {
  font-family: 'Lato', 'SimHei', 'STHeiti', 'SimHei', 'Serif';
}
.message h2 {
  font-size: 120%;
  margin-top: 5px;
  margin-bottom: 2px;
}
.message li {
  list-style: disc;
  margin-left: 2em;
}
li > p {
  text-indent: 0em;
}
block-quote h4 {
  float: left;
  display: inline-block;
}
.center {
  display: block;
  margin: auto;
}
hr {
  margin-top: 20px;
  padding-bottom: 20px;
}

.fa-gradient {
	background: -webkit-gradient(linear, left top, left bottom, from(rgb(99, 27, 103)), to(#333));
	-webkit-background-clip: text;
	-webkit-text-fill-color: transparent;
}

</style>


  <title>&#25991;&#20214;&#31995;&#32479; API</title>
</head>

<body class="d-flex flex-column h-100">
  
  

<div>

<div class="px-2 py-1 w-full fixed z-50 bg-gradient-to-r from-black via-purple-700 via-purple-500 shadow-lg" style="-webkit-backdrop-filter: saturate(150%) blur(4px); backdrop-filter: saturate(150%) blur(4px)">
  <form>
    <a href="../../../index.html"><span class="text-lg px-2 text-white">Yanyan's Wiki</span></a>
    <a href="../../2023/index.html"><span class="text-sm px-2 text-white">&#25805;&#20316;&#31995;&#32479; (2023)</span></a>
    <input maxlength="9" id="token-input" class="float-right appearance-none border border-transparent px-2 py-1 w-20 bg-white text-gray-700 placeholder-gray-400 shadow-md rounded text-xs focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent font-mono" type="text" placeholder="TOKEN" oninput="login();">
  </form>
</div>

<div class="article container mx-auto md:px-8 lg:px-8 xl:px-8 2xl:px-8 shadow-lg border pb-8 pt-10 max-w-screen-md text-justify divide-y-2 divide-white">
  <div><h1 id="api" class=" text-2xl mt-2 font-sans">&#25991;&#20214;&#31995;&#32479; API</h1>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<h4 id="_1" class=" pt-2 pb-2 font-sans float-left text-sm box border mr-1 mt-1 box-blue" style=" padding-bottom: 0;">&#26412;&#35762;&#38405;&#35835;&#26448;&#26009;</h4>
<p class=" font-serif my-1"><a href="http://pages.cs.wisc.edu/~remzi/OSTEP/" class=" text-amber-900">&#25945;&#31185;&#20070; (Operating Systems: Three Easy Pieces, OSTEP)</a> &#31532; 39 &#31456;&#12290;</p>
</blockquote>
<h2 id="1" class=" text-xl mt-2 pb-2 font-sans">1. &#25991;&#20214;&#31995;&#32479;&#27010;&#24565;</h2>
<p class=" font-serif my-1">&#35753;&#24212;&#29992;&#31243;&#24207;&#30452;&#25509;&#31649;&#29702;&#30913;&#30424;&#24182;&#19981;&#26159;&#20010;&#22909;&#20027;&#24847;&#8212;&#8212;&#20320;&#21487;&#20197;&#24819;&#35937;&#31243;&#24207;&#20043;&#38388;&#38656;&#35201;&#21327;&#35843;&#30913;&#30424;&#30340;&#24182;&#21457;&#35775;&#38382;&#65292;&#24182;&#19988;&#22914;&#26524;&#26377;&#31243;&#24207;&#20986;&#20102; bug&#65292;&#20854;&#20182;&#31243;&#24207;&#30340;&#25968;&#25454;&#23601;&#21487;&#33021;&#34987;&#26080;&#25925; &#8220;&#25703;&#27585;&#8221;&#12290;&#22240;&#27492;&#65292;&#20026;&#20102;&#26356;&#22909;&#22320;&#24110;&#21161;&#24212;&#29992;&#31243;&#24207;&#31649;&#29702;&#25345;&#20037;&#25968;&#25454;&#65292;&#19968;&#20010;&#24456;&#33258;&#28982;&#30340;&#24819;&#27861;&#23601;&#26159;&#23545;&#30913;&#30424;&#36827;&#34892; &#8220;&#34394;&#25311;&#21270;&#8221;&#65292;&#35753;&#24212;&#29992;&#31243;&#24207;&#35775;&#38382; &#8220;&#34394;&#25311;&#8221; &#30340;&#30913;&#30424;&#65292;&#23454;&#29616;&#24212;&#29992;&#19982;&#24212;&#29992;&#20043;&#38388;&#30340;&#38548;&#31163;&#12290;</p>
<p class=" font-serif my-1">&#25991;&#20214;&#31995;&#32479;&#23601;&#27492;&#35806;&#29983;&#65306;&#23427;&#21487;&#20197;&#30475;&#25104;&#26159;&#19968;&#20010;&#20174; &#8220;&#36335;&#24452;&#8221; &#21040; &#8220;&#34394;&#25311;&#30913;&#30424;&#8221; &#30340;&#26144;&#23556;&#8212;&#8212;&#27599;&#19968;&#20010;&#36335;&#24452;&#65292;&#20363;&#22914;&#33509;&#24178;&#22823;&#23478;&#29087;&#24713;&#30340;&#25991;&#20214;&#65292;&#34429;&#28982;&#21487;&#20197;&#25353;&#29031; &#8220;&#30446;&#24405;&#26641;&#8221; &#26469;&#29702;&#35299;&#65292;&#20294;&#20063;&#21487;&#20197;&#29702;&#35299;&#25104; key-value mapping (key &#26159;&#36335;&#24452;&#21517;&#65292;value &#26159; &#8220;&#34394;&#25311;&#30913;&#30424;&#8221; &#20013;&#30340;&#25968;&#25454;)&#65306;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8"><code>/proc/1234/maps</code> &#26144;&#23556;&#21040;&#19968;&#32452;&#25991;&#26412;&#25968;&#25454;&#65292;&#26631;&#35760;&#20102;pid = 1234&#36827;&#31243;&#30340;&#20869;&#23384;&#26144;&#23556;&#24773;&#20917;&#65307;</li>
<li class=" ml-8"><code>/dev/sda</code> &#26144;&#23556;&#21040;&#23454;&#38469;&#30340;&#29289;&#29702;&#30913;&#30424;&#65307;</li>
<li class=" ml-8"><code>/home/jyy/Projects/wiki/server.py</code> &#26144;&#23556;&#21040;&#25991;&#20214;&#31995;&#32479;&#20013;&#30340;&#19968;&#20010;&#25991;&#20214; (&#34394;&#25311;&#30913;&#30424;)&#12290;</li>
</ul>
<p class=" font-serif my-1">&#20174;&#21478;&#19968;&#20010;&#35282;&#24230;&#65292;&#25991;&#20214;&#31995;&#32479;&#20013;&#30340;&#27599;&#20010;&#25991;&#20214; (&#30446;&#24405;) &#20063;&#37117;&#26159;&#25805;&#20316;&#31995;&#32479;&#20013;&#30340;&#23545;&#35937;&#65292;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#25805;&#20316;&#31995;&#32479;&#30340; API &#31649;&#29702;&#23427;&#20204;&#12290;</p>
<h2 id="2" class=" text-xl mt-2 pb-2 font-sans">2. &#30446;&#24405;&#26641;&#30340;&#21019;&#24314;</h2>
<p class=" font-serif my-1">&#22312; Linux (UNIX) &#20013;&#65292;&#25991;&#20214;&#31995;&#32479;&#30340;&#26681;&#26159; &#8220;<code>/</code>&#8221;&#65292;&#19968;&#20999;&#30446;&#24405;/&#25991;&#20214;&#37117;&#20174;&#26681;&#25991;&#20214;&#31995;&#32479;&#21487;&#36798;&#12290;&#25991;&#20214;&#31995;&#32479;&#20013;&#30340;&#30446;&#24405;&#26500;&#25104;&#19968;&#20010;&#26641;&#29366;&#30340;&#32467;&#26500;&#12290;&#19979;&#22270;&#26159; Linux <a href="https://refspecs.linuxfoundation.org/FHS_3.0/fhs/index.html" class=" text-amber-900">Filesystem Hierarchy Standard</a> &#20013;&#35268;&#23450;&#30340;&#19968;&#20123;&#30446;&#24405;&#21644;&#25991;&#20214;&#12290;</p>
<p class=" font-serif my-1"><img alt="" class="center" src="../../../pages/OS/img/FHS.png" width="640px"></p>
<p class=" font-serif my-1">&#36825;&#23601;&#24341;&#21457;&#20102;&#19968;&#20010;&#24456;&#26377;&#36259;&#30340;&#38382;&#39064;&#65306;&#31995;&#32479;&#30340;&#30446;&#24405;&#26641;&#21040;&#24213;&#26159;&#24590;&#20040;&#26469;&#30340;&#21602;&#65311;&#25105;&#20204;&#36825;&#37324;&#26377;&#19968;&#20221;&#26368;&#23567;&#30340; <a href="https://box.nju.edu.cn/f/3f67e092e1ba441187d9/?dl=1" class=" text-amber-900">Linux &#31995;&#32479;&#38236;&#20687;</a>&#65292;&#35299;&#21387;&#32553;&#21518;&#20250;&#24471;&#21040;&#33509;&#24178;&#25991;&#20214;&#65306;</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code>.
&#9500;&#9472;&#9472; initramfs
&#9474;&#160;&#160; &#9500;&#9472;&#9472; busybox
&#9474;&#160;&#160; &#9492;&#9472;&#9472; init
&#9500;&#9472;&#9472; Makefile
&#9492;&#9472;&#9472; vmlinuz-minimal
</code></pre></div>

<p class=" font-serif my-1">&#20320;&#21487;&#20197;&#21019;&#24314;&#33258;&#24049;&#30340; &#8220;&#21551;&#21160;&#26102;&#30340;&#26681;&#25991;&#20214;&#31995;&#32479;&#38236;&#20687;&#8221; (initramfs)&#65292;&#27491;&#30830;&#30340;&#26029;&#21477;&#30340;&#26041;&#27861;&#26159; &#8220;init-ram-fs&#8221;&#65306;&#22312;&#21021;&#22987;&#21270;&#26102;&#20869;&#23384;&#20013;&#21152;&#36733;&#30340;&#25991;&#20214;&#31995;&#32479;&#12290;&#22312;&#25105;&#20204;&#32473;&#20986;&#30340;&#20363;&#23376;&#37324;&#65292;Linux &#22312;&#31995;&#32479;&#21551;&#21160;&#21518;&#20250;&#26377; <code>/busybox</code> &#21644; <code>/init</code> &#20004;&#20010;&#25991;&#20214; (&#24403;&#28982;&#36824;&#26377; <code>/dev/</code> &#20013;&#30340;&#35774;&#22791;)&#12290;&#32780;&#25972;&#20010;&#31995;&#32479;&#20013;&#25152;&#26377;&#30340;&#37096;&#20998;&#8212;&#8212;&#27604;&#22914;&#22823;&#23478;&#29087;&#24713;&#30340; <code>/home</code> &#31561;&#65292;&#37117;&#21487;&#20197;&#29702;&#35299;&#25104;&#26159;&#31995;&#32479;&#21551;&#21160;&#21518;&#65292;&#30001;&#21021;&#22987;&#30340;&#26681;&#25991;&#20214;&#31995;&#32479;&#20013;&#30340;&#31243;&#24207;&#21019;&#24314;&#30340;&#12290;</p>
<p class=" font-serif my-1">&#22914;&#26524;&#20320;&#20351;&#29992; <code>make run</code> &#36816;&#34892;&#25105;&#20204;&#30340; &#8220;&#26368;&#23567; Linux&#8221;&#65292;&#20320;&#20250;&#24471;&#21040;&#19968;&#20010;&#20960;&#20046;&#20160;&#20040;&#20063;&#27809;&#26377;&#30340;&#31995;&#32479;&#65292;&#36830; <code>ls</code> &#37117;&#27809;&#26377;&#65306;</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code>/ # ls
sh: ls: not found
</code></pre></div>

<p class=" font-serif my-1">&#19981;&#36807;&#31995;&#32479;&#37324;&#36824;&#26159;&#24471;&#26377;&#19968;&#20123;&#21487;&#20197;&#29992;&#30340;&#19996;&#35199;&#65292;&#20363;&#22914;&#21487;&#25191;&#34892;&#25991;&#20214; <code>/busybox</code>&#65292;&#20320;&#21487;&#20197;&#29992;&#23427;&#26597;&#30475;&#31995;&#32479;&#37324;&#25152;&#26377;&#30340;&#25991;&#20214;&#8212;&#8212;&#30495;&#30340;&#26159;&#20010; &#8220;&#26368;&#23567;&#8221; &#30340;&#31995;&#32479;&#65306;</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code>/ # /busybox find /
/
/.ash_history
/busybox
/root
/dev
/dev/console
</code></pre></div>

<p class=" font-serif my-1">&#25509;&#19979;&#26469;&#25105;&#20204;&#23601;&#21487;&#20197;&#21464;&#39764;&#26415;&#20102;&#12290;&#22312;&#32456;&#31471;&#20013;&#25191;&#34892;&#20197;&#19979;&#21629;&#20196;&#65306;</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code>/busybox mkdir -p /bin &amp;&amp; /busybox mv /busybox /bin/
c1="arch ash base64 cat chattr chgrp chmod chown conspy cp cpio cttyhack date dd df dmesg dnsdomainname dumpkmap echo ed egrep false fatattr fdflush fgrep fsync getopt grep gunzip gzip hostname hush ionice iostat ipcalc kbd_mode kill link linux32 linux64 ln login ls lsattr lzop makemime mkdir mknod mktemp more mount mountpoint mpstat mt mv netstat nice nuke pidof ping ping6 pipe_progress printenv ps pwd reformime resume rev rm rmdir rpm run-parts scriptreplay sed setarch setpriv setserial sh sleep stat stty su sync tar touch true umount uname usleep vi watch zcat"
c2="[ [[ awk basename bc beep blkdiscard bunzip2 bzcat bzip2 cal chpst chrt chvt cksum clear cmp comm crontab cryptpw cut dc deallocvt diff dirname dos2unix dpkg dpkg-deb du dumpleases eject env envdir envuidgid expand expr factor fallocate fgconsole find flock fold free ftpget ftpput fuser groups hd head hexdump hexedit hostid id install ipcrm ipcs killall last less logger logname lpq lpr lsof lspci lsscsi lsusb lzcat lzma man md5sum mesg microcom mkfifo mkpasswd nc nl nmeter nohup nproc nsenter nslookup od openvt passwd paste patch pgrep pkill pmap printf pscan"
c3="pstree pwdx readlink realpath renice reset resize rpm2cpio runsv runsvdir rx script seq setfattr setkeycodes setsid setuidgid sha1sum sha256sum sha3sum sha512sum showkey shred shuf smemcap softlimit sort split ssl_client strings sum sv svc svok tac tail taskset tcpsvd tee telnet test tftp time timeout top tr traceroute traceroute6 truncate ts tty ttysize udhcpc6 udpsvd unexpand uniq unix2dos unlink unlzma unshare unxz unzip uptime users uudecode uuencode vlock volname w wall wc wget which who whoami whois xargs xxd xz xzcat yes"
for cmd in $c1 $c2 $c3; do
  /bin/busybox ln -s /bin/busybox /bin/$cmd
done
mkdir -p /proc &amp;&amp; mount -t proc  none /proc
mkdir -p /sys  &amp;&amp; mount -t sysfs none /sys
</code></pre></div>

<p class=" font-serif my-1">&#28982;&#21518;&#20320;&#24573;&#28982;&#23601;&#24471;&#21040;&#20102;&#19968;&#20010;&#21487;&#29992;&#30340; Linux &#31995;&#32479;&#65281;&#20320;&#21487;&#20197;&#35797;&#35797;&#20320;&#24120;&#29992;&#30340;&#21629;&#20196;&#8212;&#8212;top, ps, ls, vi&#65292;&#20840;&#37096;&#37117;&#21487;&#20197;&#27491;&#24120;&#20351;&#29992;&#20102;&#12290;</p>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<h4 id="_2" class=" pt-2 pb-2 font-sans float-left text-sm box border mr-1 mt-1 box-blue" style=" padding-bottom: 0;">&#24863;&#21040;&#24778;&#35766;&#65311;</h4>
<p class=" font-serif my-1">&#25972;&#20010;&#25805;&#20316;&#31995;&#32479;&#19990;&#30028;&#37117;&#26159; &#8220;&#31995;&#32479;&#35843;&#29992;&#8221; &#21019;&#24314;&#30340;&#12290;&#25105;&#20204;&#30340; Linux &#31995;&#32479;&#20165;&#20165;&#25552;&#20379;&#19968;&#20010;&#26368;&#23567;&#30340;&#21021;&#22987;&#31995;&#32479;&#29366;&#24577; (initramfs) &#21644;&#19968;&#32452;&#31995;&#32479;&#35843;&#29992;&#65292;&#21097;&#19979;&#30340;&#19968;&#20999;&#37117;&#26159;&#24212;&#29992;&#31243;&#24207;&#36890;&#36807;&#35775;&#38382;&#25805;&#20316;&#31995;&#32479; API &#35775;&#38382;&#25805;&#20316;&#31995;&#32479;&#23545;&#35937;&#23454;&#29616;&#30340;&#12290;</p>
</blockquote>
<p class=" font-serif my-1">&#24403;&#28982;&#65292;&#22312;&#30495;&#23454;&#30340;&#31995;&#32479;&#20013;&#65292;initramfs &#27604;&#25105;&#20204;&#30340; &#8220;&#26368;&#23567;&#38236;&#20687;&#8221; &#21253;&#21547;&#26356;&#22810;&#30340;&#20869;&#23481;&#65306;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#24517;&#35201;&#30340;&#20869;&#26680;&#27169;&#22359; (&#20363;&#22914;&#35774;&#22791;&#39537;&#21160;&#12289;&#25991;&#20214;&#31995;&#32479;&#31561;)&#12290;&#20869;&#26680;&#27169;&#22359;&#21487;&#20197;&#29702;&#35299;&#25104;&#25805;&#20316;&#31995;&#32479;&#20869;&#26680;&#36816;&#34892;&#26102;&#38656;&#35201;&#21152;&#36733;&#30340;&#21160;&#24577;&#38142;&#25509;&#24211;&#12290;&#27169;&#22359;&#30340;&#21368;&#36733;&#26426;&#21046;&#36824;&#21487;&#20197;&#29992;&#20110;&#20869;&#26680;&#20195;&#30721;&#30340;&#26356;&#26032;&#12290;</li>
<li class=" ml-8">&#37197;&#32622;&#25991;&#20214;&#12289;&#21551;&#21160;&#31995;&#32479;&#25152;&#38656;&#30340;&#20108;&#36827;&#21046;&#25991;&#20214; (&#22914; bash)&#12289;&#21160;&#24577;&#38142;&#25509;&#24211; (&#22914; libc) &#31561;&#12290;</li>
</ul>
<p class=" font-serif my-1">&#25105;&#20204;&#30340;&#28436;&#31034;&#31243;&#24207;&#20013;&#22788;&#20110;&#31616;&#21333;&#36215;&#35265;&#65292;&#20351;&#29992;&#38745;&#24577;&#38142;&#25509;&#26041;&#24335;&#36830;&#25509;&#20102; busybox, &#20063;&#19981;&#38656;&#35201;&#39069;&#22806;&#30340;&#39537;&#21160;&#31243;&#24207;&#65292;&#22240;&#27492;&#23601;&#21482;&#26377;&#20004;&#20010;&#25991;&#20214;&#12290;&#22312;&#30495;&#23454;&#30340; Linux &#31995;&#32479;&#20013;&#30340; <code>/boot/</code> &#30446;&#24405;&#20013;&#21487;&#20197;&#30475;&#21040; initrd.img &#25991;&#20214;&#65292;&#37324;&#38754;&#26377;&#20960;&#21313; MB &#30340;&#25968;&#25454;&#8212;&#8212;&#21516;&#23398;&#20204;&#22312;&#26356;&#26032;&#31995;&#32479;&#36935;&#21040; Linux &#20869;&#26680;&#25110;&#19968;&#20123;&#30456;&#20851;&#26356;&#26032;&#30340;&#26102;&#20505;&#65292;&#37117;&#20250;&#36973;&#36935; Generate initramfs &#36825;&#19968;&#32791;&#26102;&#25805;&#20316;&#65292;&#23601;&#26159;&#20026;&#20102;&#26356;&#26032;&#36825;&#20010;&#21021;&#22987;&#30340;&#25991;&#20214;&#31995;&#32479;&#12290;</p>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<h4 id="initrdimg" class=" pt-2 pb-2 font-sans float-left text-sm box border mr-1 mt-1 box-blue" style=" padding-bottom: 0;">&#24819;&#30693;&#36947; initrd.img &#37324;&#26377;&#20160;&#20040;&#65311;</h4>
<p class=" font-serif my-1"><code>initrd.img</code> &#26159;&#20010;cpio archive (&#23454;&#38469;&#26159; cpio archive &#25340;&#25509;&#32780;&#25104;&#30340;)&#12290;&#22914;&#26524;&#20320;&#26377;&#20852;&#36259;&#30475;&#30475; Linux &#21021;&#22987;&#25991;&#20214;&#31995;&#32479;&#20013;&#21253;&#21547;&#21738;&#20123;&#25991;&#20214;&#65292;&#35831; STFW&#12290;</p>
</blockquote>
<p class=" font-serif my-1">&#20294;&#26080;&#35770;&#22914;&#20309;&#36825;&#20960;&#21313; MiB &#30340; &#8220;&#21021;&#22987;&#38236;&#20687;&#8221; &#37117;&#19981;&#26159;&#25105;&#20204;&#30475;&#21040;&#30340;&#23436;&#25972;&#30340;&#25991;&#20214;&#31995;&#32479;&#8212;&#8212;&#23601;&#20687;&#25105;&#20204;&#30340;&#26368;&#23567; Linux &#21551;&#21160;&#21518;&#65292;&#22823;&#23478;&#29087;&#24713;&#30340; <code>/proc</code>, <code>/dev</code>, <code>/sys</code>&#65292;&#22312;&#31995;&#32479;&#20013;&#37117;&#27809;&#26377;&#12290;&#36825;&#20123;&#25991;&#20214;&#31995;&#32479;&#37117;&#26159; init &#21644;&#20043;&#21518;&#30340;&#24212;&#29992;&#31243;&#24207;&#20351;&#29992; mount &#31995;&#32479;&#35843;&#29992;&#25346;&#36733;&#30340;&#12290;mount &#23436;&#25104;&#30340;&#24037;&#20316;&#26159;<strong>&#25226;&#19968;&#20010;&#35774;&#22791;&#21644;&#19968;&#20010;&#25991;&#20214;&#31995;&#32479;&#23454;&#29616;&#32852;&#31995;&#36215;&#26469;&#65292;&#22312;&#35774;&#22791;&#19978;&#21019;&#24314;&#19968;&#20010;&#25991;&#20214;&#31995;&#32479;&#23454;&#20363;&#65292;&#24182;&#19988;&#25226;&#21019;&#24314;&#30340;&#25991;&#20214;&#31995;&#32479; &#8220;&#26367;&#25442;&#8221; &#21040;&#25991;&#20214;&#31995;&#32479;&#20013;&#30340;&#19968;&#20010;&#30446;&#24405;&#20013;</strong>&#12290;</p>
<p class=" font-serif my-1"><img alt="" class="center" src="../../../pages/OS/img/mount.jpg" width="400px"></p>
<p class=" font-serif my-1">&#22914;&#27492;&#19968;&#26469;&#65292;&#31995;&#32479;&#20013;&#30340;&#19968;&#20010;&#30446;&#24405;&#23601;&#25104;&#20026;&#20102;&#26576;&#20010;&#35774;&#22791;&#19978;&#25991;&#20214;&#31995;&#32479;&#30340; &#8220;&#26681;&#8221;&#12290;&#36825;&#26679;&#25105;&#20204;&#23601;&#21487;&#20197;&#25226;&#22810;&#20010;&#35774;&#22791; (&#30828;&#30424;&#12289;USB Flash Disk, ...) &#37117;&#25918;&#32622;&#21040;&#21516;&#19968;&#20010;&#25991;&#20214;&#31995;&#32479;&#20013;&#12290;&#32780;&#22312; Windows &#20013;&#65292;&#8220;&#25346;&#36733;&#8221; &#36890;&#24120;&#26159;&#21457;&#29983;&#22312; &#8220;&#39537;&#21160;&#22120;&#8221; &#23618;&#38754;&#30340; (drive letter assignment)&#65292;&#20363;&#22914;&#25554;&#20837; USB Flash Disk &#20197;&#21518;&#20250;&#20998;&#37197;&#19968;&#20010;&#26032;&#30340; &#8220;&#30424;&#31526;&#8221;&#12290;&#20351;&#29992; <code>mount -l</code> &#21629;&#20196;&#21487;&#20197;&#26597;&#30475;&#31995;&#32479;&#20013;&#24050;&#32463;&#25346;&#36733;&#30340;&#35774;&#22791;&#65306;</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code>sysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime)
proc on /proc type proc (rw,nosuid,nodev,noexec,relatime)
udev on /dev type devtmpfs (rw,nosuid,relatime,size=4052568k,nr_inodes=1013142,mode=755)
devpts on /dev/pts type devpts (rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=000)
tmpfs on /run type tmpfs (rw,nosuid,noexec,relatime,size=816800k,mode=755)
/dev/sda2 on / type ext4 (rw,relatime,data=ordered)
...
</code></pre></div>

<p class=" font-serif my-1">&#25346;&#36733;&#26159;&#36890;&#36807; <code>mount</code> &#31995;&#32479;&#35843;&#29992;&#23454;&#29616;&#30340;&#65306;</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">mount</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">target</span><span class="p">,</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">filesystemtype</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">mountflags</span><span class="p">,</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">);</span>
</code></pre></div>

<ul class=" list-disc font-serif">
<li class=" ml-8"><code>mount()</code>  attaches  the filesystem specified by source (which is often a pathname referring to a device, but can also be the pathname of a directory or file, or a dummy string) to the location (a directory or file) specified by the pathname in target.</li>
</ul>
<p class=" font-serif my-1">&#20363;&#22914;&#65292;<code>mount /dev/sdb1 /mnt</code> &#21487;&#20197;&#23558;&#26576;&#20010;&#30913;&#30424;&#35774;&#22791; (&#36890;&#24120;&#26159; USB) &#25346;&#36733;&#21040;<code>/mnt</code>&#12290;mount &#20063;&#21487;&#20197;&#25226;&#19968;&#20010;&#25991;&#20214;&#30452;&#25509;&#25346;&#36733;&#21040;&#25991;&#20214;&#31995;&#32479;&#20013;&#65292;&#19981;&#36807;&#26159;&#36890;&#36807;&#21019;&#24314;&#19968;&#20010; loopback device (&#22238;&#29615;&#35774;&#22791;&#65292;&#23558;&#21040;&#35774;&#22791;&#30340;&#35835;/&#20889;&#35831;&#27714;&#37325;&#26032;&#36716;&#25442;&#20026;&#21040;&#25991;&#20214;&#30340;&#35835;/&#20889;) &#23454;&#29616;&#30340;&#8212;&#8212;&#36825;&#24688;&#22909;&#20307;&#29616;&#20102; &#8220;&#25991;&#20214;&#26159;&#34394;&#25311;&#21270;&#30340;&#30913;&#30424;&#8221; &#30340;&#24605;&#24819;&#65292;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807; strace &#35266;&#23519; mount &#21629;&#20196;&#30340;&#34892;&#20026;&#65306;</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code>openat(AT_FDCWD, "/dev/loop-control", O_RDWR|O_CLOEXEC) = 3
ioctl(3, LOOP_CTL_GET_FREE)                             = 3
...
mount("/dev/loop3", "/mnt", "ext4", MS_MGC_VAL, NULL)   = 0
</code></pre></div>

<p class=" font-serif my-1">&#22312; loop (4) &#30340;&#25163;&#20876;&#20013;&#65306;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8"><code>LOOP_CTL_GET_FREE</code>: Allocate or find a free loop device for use.  On success, the device number is returned as the result of the call.  This operation takes no argument.</li>
</ul>
<p class=" font-serif my-1"><code>ioctl</code>() &#36820;&#22238;&#20102;&#19968;&#20010;&#26032;&#30340; loopback device &#32534;&#21495; (3)&#12290;&#20043;&#21518;&#30340;&#31995;&#32479;&#35843;&#29992;&#24207;&#21015;&#33258;&#21160;&#26816;&#27979;&#25991;&#20214;&#31995;&#32479;&#30340;&#31867;&#22411;&#20026; ext4&#65292;&#28982;&#21518;&#20351;&#29992; <code>mount</code> &#31995;&#32479;&#35843;&#29992;&#23436;&#25104;&#25346;&#36733;&#12290;</p>
<h2 id="3" class=" text-xl mt-2 pb-2 font-sans">3. &#30446;&#24405;/&#25991;&#20214;&#31649;&#29702;</h2>
<p class=" font-serif my-1">&#26377;&#20102;&#23436;&#25972;&#30340;&#25991;&#20214;&#31995;&#32479;&#26641;&#65292;&#30446;&#24405;&#25805;&#20316;&#22823;&#23478;&#23601;&#38750;&#24120;&#29087;&#24713;&#20102;&#8212;&#8212;&#22312; Windows &#8220;&#36164;&#28304;&#31649;&#29702;&#22120;&#8221;&#12289;Linux &#21457;&#34892;&#29256;&#20013;&#30340; &#8220;&#25991;&#20214;&#31649;&#29702;&#22120;&#8221; &#20013;&#65292;&#25105;&#20204;&#27599;&#22825;&#37117;&#23545;&#30446;&#24405;&#23436;&#25104;&#21508;&#31181;&#25805;&#20316;&#65306;&#21019;&#24314;&#30446;&#24405; (mkdir)&#12289;&#21024;&#38500;&#30446;&#24405; (rmdir)&#12289;&#37325;&#21629;&#21517;&#8230;&#8230;Linux &#25552;&#20379;&#20102;&#19968;&#31995;&#21015;&#30340;&#31995;&#32479;&#35843;&#29992;&#26469;&#31649;&#29702;&#25991;&#20214;&#31995;&#32479;&#20013;&#30340;&#30446;&#24405;&#21644;&#25991;&#20214;&#12290;&#36825;&#20123;&#31995;&#32479;&#35843;&#29992;&#20250;&#34987; Linux &#31995;&#32479;&#36716;&#21457;&#32473;&#20855;&#20307;&#30340;&#25991;&#20214;&#31995;&#32479;&#23454;&#29616;&#65292;&#35831;&#22823;&#23478;&#38405;&#35835;&#25945;&#31185;&#20070;&#23398;&#20064;&#30456;&#20851;&#30340;&#20869;&#23481;&#12290;</p>
<p class=" font-serif my-1">&#25991;&#20214; (&#34394;&#25311;&#30913;&#30424;) &#30340;&#35775;&#38382;&#26102;&#36890;&#36807;&#25991;&#20214;&#25551;&#36848;&#31526;&#23436;&#25104;&#30340;&#12290;&#20170;&#22825;&#25991;&#20214;&#25551;&#36848;&#31526;&#26159;&#35775;&#38382;&#25805;&#20316;&#31995;&#32479;&#23545;&#35937;&#30340; &#8220;handle&#8221;&#65292;&#20294;&#26368;&#26089;&#30340;&#26102;&#20505;&#25991;&#20214;&#25551;&#36848;&#31526;&#30340;&#20027;&#35201;&#21151;&#33021;&#23601;&#26159;&#35775;&#38382;&#25991;&#20214;&#12290;&#25105;&#20204;&#21487;&#20197;&#23545;&#25991;&#20214;&#25551;&#36848;&#31526;&#25191;&#34892;&#25991;&#20214;&#35775;&#38382;&#25805;&#20316;&#65306;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">mmap&#65292;&#23558;&#25991;&#20214;&#25968;&#25454;&#26144;&#23556;&#21040;&#22320;&#22336;&#31354;&#38388;&#20013;&#30340;&#36830;&#32493;&#19968;&#27573;&#65307;</li>
<li class=" ml-8">read&#65292;&#35835;&#21462;&#25968;&#25454;&#24182;&#26356;&#26032;&#20559;&#31227;&#37327;&#65307;</li>
<li class=" ml-8">write&#65292;&#20889;&#20837;&#25968;&#25454;&#24182;&#26356;&#26032;&#20559;&#31227;&#37327;&#65307;</li>
<li class=" ml-8">lseek&#65292;&#20462;&#25913;&#25991;&#20214;&#25551;&#36848;&#31526;&#20559;&#31227;&#37327;&#12290;&#20351;&#29992; <code>SEEK_CUR</code>, <code>SEEK_SET</code> &#21644; <code>SEEK_END</code> &#20998;&#21035;&#20174;&#24403;&#21069;&#20301;&#32622;&#12289;&#25991;&#20214;&#22836;&#37096;&#12289;&#25991;&#20214;&#23614;&#37096;&#26356;&#26032;&#20559;&#31227;&#37327;&#65307;</li>
<li class=" ml-8">ftruncate&#65292;&#25913;&#21464;&#25991;&#20214;&#30340;&#22823;&#23567;&#12290;</li>
</ul>
<p class=" font-serif my-1">&#25991;&#20214;&#25551;&#36848;&#31526;&#31649;&#29702;&#20013;&#65292;&#27604;&#36739;&#20196;&#20154;&#22256;&#24785;&#30340;&#37096;&#20998;&#26159;&#25991;&#20214;&#25551;&#36848;&#31526;&#22312; fork/execve &#20043;&#21518;&#30340;&#34892;&#20026;&#12290;&#20026;&#20102;&#35753;&#29238;&#36827;&#31243;&#33021;&#28789;&#27963;&#37197;&#32622;&#23376;&#36827;&#31243;&#30340;&#36755;&#20837;&#36755;&#20986;&#25991;&#20214;&#65292;UNIX &#31995;&#32479;&#24456;&#33258;&#28982;&#22320;&#35774;&#35745; execve() &#31995;&#32479;&#35843;&#29992;&#30340;&#34892;&#20026;&#26159;&#32487;&#25215;&#36827;&#31243;&#21407;&#20808;&#30340;&#25991;&#20214;&#25551;&#36848;&#31526; (&#33258;&#28982;&#20063;&#32487;&#25215;&#20559;&#31227;&#37327;)&#12290;&#20294; fork &#20043;&#21518;&#65292;&#25991;&#20214;&#25551;&#36848;&#31526;&#20013;&#20559;&#31227;&#37327;&#30340;&#34892;&#20026;&#23601;&#27809;&#26377;&#37027;&#20040;&#31616;&#21333;&#20102;&#65306;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#31995;&#32479;&#20013;&#22914;&#26524;&#26377;&#22810;&#20010; <code>O_APPEND</code> &#30340;&#36827;&#31243;&#65292;&#23427;&#20204;&#23558;&#22987;&#32456;&#20889;&#20837;&#25991;&#20214;&#30340;&#26411;&#23614;&#65307;</li>
<li class=" ml-8">&#29238;&#23376;&#36827;&#31243;&#20849;&#20139;&#20559;&#31227;&#37327;&#12290;&#20363;&#22914;&#29238;&#23376;&#36827;&#31243;&#37117;&#29992; <code>printf()</code> &#25171;&#21360;&#26085;&#24535;&#12290;&#24403; <code>./a.out &gt; a.log</code> &#26102;&#65292;&#29238;&#23376;&#36827;&#31243;&#38656;&#35201;&#20849;&#20139;&#20559;&#31227;&#37327;&#20197;&#20445;&#35777;&#23427;&#20204;&#30340;&#26085;&#24535;&#19981;&#20250;&#20114;&#30456;&#35206;&#30422;&#12290;</li>
</ul>
<p class=" font-serif my-1">&#21478;&#19968;&#20010;&#40635;&#28902;&#20043;&#22788;&#26159; <code>dup()</code> &#22797;&#21046;&#30340;&#25991;&#20214;&#25551;&#36848;&#31526;&#65292;&#23427;&#20284;&#20046;&#20063;&#24212;&#35813;&#21644;&#21407;&#20808;&#30340;&#25991;&#20214;&#25551;&#36848;&#31526;&#20849;&#20139;&#20559;&#31227;&#37327;&#65306;&#25105;&#20204;&#21487;&#20197;&#29992; dup &#23454;&#29616;&#25991;&#20214;&#25551;&#36848;&#31526;&#30340;&#22791;&#20221; (&#20363;&#22914; stdout)&#65306;</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kt">int</span><span class="w"> </span><span class="n">stdout_fd_bak</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dup</span><span class="p">(</span><span class="n">STDOUT_FILENO</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#22791;&#20221;</span>
<span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">)</span><span class="o">:</span>

<span class="n">freopen</span><span class="p">(...,</span><span class="w"> </span><span class="n">stdout</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#26367;&#25442;stdout&#23545;&#24212;&#30340;&#25991;&#20214;&#25551;&#36848;&#31526;</span>
<span class="p">...</span>
<span class="n">fclose</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

<span class="n">dup2</span><span class="p">(</span><span class="n">stdout_fd_bak</span><span class="p">,</span><span class="w"> </span><span class="n">STDOUT_FILENO</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#24674;&#22797;</span>
</code></pre></div>

<p class=" font-serif my-1">&#20851;&#20110;&#36825;&#20123;&#32454;&#33410;&#65292;&#35831;&#22823;&#23478;&#38405;&#35835;&#25945;&#31185;&#20070;&#31532; 39 &#31456;&#20869;&#23481;&#12290;&#23454;&#38469;&#19978;&#65292;&#25805;&#20316;&#31995;&#32479;&#20869;&#30340; API &#38543;&#30528;&#25805;&#20316;&#31995;&#32479;&#30340;&#28436;&#21270;&#12290;&#25105;&#20204;&#30475;&#21040; Linux &#32463;&#21382;&#20102;&#21333;&#22788;&#29702;&#22120;&#21040;&#22810;&#22788;&#29702;&#22120;&#12289;&#20114;&#32852;&#32593;&#30340;&#34028;&#21187;&#21457;&#23637;&#12289;&#21333;&#26426;&#21040;&#20113;&#35745;&#31639;/&#25968;&#25454;&#20013;&#24515;&#30340;&#21464;&#36801;&#65292;&#20063;&#21457;&#29983;&#20102;&#24456;&#22810;&#21464;&#21270;&#12290;&#38543;&#30528;&#35745;&#31639;&#26426;&#36719;&#20214;&#31995;&#32479; (&#29978;&#33267;&#32534;&#31243;&#35821;&#35328;&#65292;&#20363;&#22914; C++ &#21644; Java) &#30340;&#25104;&#38271;&#65292;&#24456;&#22810;&#32769;&#30340;&#26426;&#21046;&#22312;&#20445;&#25345;&#20860;&#23481;&#24615;&#30340;&#21516;&#26102;&#65292;API &#20043;&#38388;&#20132;&#20114;&#30340;&#22797;&#26434;&#24615;&#20063;&#29190;&#28856;&#24335;&#22320;&#22686;&#38271;&#8212;&#8212;&#20363;&#22914;&#25805;&#20316;&#31995;&#32479;&#20013;&#26032;&#22686;&#20219;&#20309;&#26426;&#21046;&#65292;&#37117;&#38656;&#35201;&#32771;&#34385;&#21644; fork &#30340;&#20132;&#20114;&#65307;&#26377;&#20123;&#26426;&#21046;&#29978;&#33267; &#8220;&#25918;&#24323;&#8221; &#20102;&#23545; fork &#30340;&#25903;&#25345;&#65292;&#20363;&#22914;&#32447;&#31243; (pthreads) &#22312; fork &#20043;&#21518;&#21482;&#26377;&#25191;&#34892; fork &#30340;&#32447;&#31243;&#33021;&#32487;&#32493;&#25191;&#34892;&#12290;</p></div>
</div>

<div class="container text-xs py-3">
  <span class="text-muted">
    <center><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="../../../static/img/cc-4.0.png"></a>
    &#160;&#160;&#160;<a style="color:inherit" href="https://beian.miit.gov.cn/">&#33487; ICP &#22791; 2020049101 &#21495;</a>
    </center>
  </span>
</div>

</div>

<script src="../../../static/js/jquery.min.js"></script>

<script>
function get_token() {
  var match = document.cookie.match(new RegExp('(^| )token=([^;]+)'));
  if (match) return match[2];
  else return "";
}
var token = get_token();
var hint = "token", box = $("#token-input");

if (token == "") { }
else { box.val(token); }

function login() {
  var token = box.val()
  if (!token) {
    document.cookie = ''
  } else {
    document.cookie = 'token=' + token + '; expires=Fri, 31 Dec 9999 23:59:59 GMT;'
  }
}
</script>


</body>

</html>