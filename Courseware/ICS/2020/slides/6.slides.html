<!DOCTYPE html><html class="h-100">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="../../../static/css/base.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.font.im/css?family=Source+Serif+Pro%7CLato%7CInconsolata" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="../../../static/img/favicon.png" type="image/x-icon">

  <style>
    .font-sans {
      font-family: 'Lato', 'SimHei', 'STHeiti', 'SimHei', 'Serif';
    }
    .font-serif {
      font-family: 'Source Serif Pro', 'Songti SC', 'SimSun', 'Serif', serif;
    }
  </style>
  <link rel="stylesheet" href="../../../static/katex/katex.min.css">
  <script defer src="../../../static/katex/katex.min.js"></script>
  <script defer src="../../../static/katex/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
  <script>
      document.addEventListener("DOMContentLoaded", function() {
          renderMathInElement(document.body, {
            // customised options
            // &#8226; auto-render specific keys, e.g.:
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false},
                {left: '\\(', right: '\\)', display: false},
                {left: '\\[', right: '\\]', display: true}
            ],
            // &#8226; rendering keys, e.g.:
            throwOnError : false
          });
      });
  </script>


  

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="stylesheet" href="../../../static/reveal/reveal.css">
<link rel="stylesheet" href="../../../static/reveal/theme/simple.css" id="theme">

<style>
.reveal .slide-number {
  font-size: 26px;
  border-radius: 5px;
  background-color: rgba(0, 0, 0, .3);
}

.reveal .full-screen {
    width: 100%;
    height: 100%;
    object-fit: cover;
    position: absolute;
    top: 0;
    left: 0;
    z-index: -1;
}

.reveal .slides {
  border: 1.5px #ddd solid;
  border-radius: 7px;
  text-align: left;
  font-weight: 300;
}

.reveal h1, .reveal h2, .reveal h3, .reveal h4 {
  font-family: 'Lato', 'SimHei', 'STXihei', 'Droid Sans';
  font-weight: 400;
}

.reveal p, .reveal li, .reveal center {
  font-size: 32px;
  font-family: 'Lato', 'STHeiti', 'SimHei', 'Droid Sans';
}

.reveal li + li {
  margin-top: 10px;
}

.reveal ul {
  display: block;
  margin-right: 15px;
}

.reveal p, .reveal h1, .reveal h2, .reveal h3, .reveal h4, .reveal h5 {
  padding:  0 25px 0 25px;
}

.reveal table {
  font-size: 32px;
  font-family: 'Lato', 'STHeiti', 'SimHei', 'Sans Serif';
  margin-top: 15px;
  margin-bottom: 15px;
}

.reveal th {
  background-color: #eee;
}

.reveal tr:nth-child(even) {
  background-color: #efffff;
}

.reveal h1,
.reveal h2,
.reveal h3,
.reveal h4,
.reveal h5,
.reveal h6 {
  text-align: left;
  margin: 0 0 20px 0;
 color: #222; 
  font-weight: 400;
  line-height: 1.2;
  letter-spacing: normal;
}



.reveal h1 {
  margin: 0 10 0 10;
  font-size: 60px;
}
.reveal .middle h1 {
  text-align: center;
}

.reveal h2 {
  font-size: 48px;
  border-bottom: 2px solid rgb(106, 0, 95);
  padding-bottom: 5px;
}
.reveal h3 { font-size: 1.15em; }
.reveal h4 { font-size: 1.05em; }

.reveal .center {
  text-align: center;
}

.reveal .middle {
  height: 728px;
  display: flex;
  align-items: center;
  width: 100%;
}

.reveal pre {
  font-size: 28px;
 
  background-color: #eee;

  border-radius: 3mm;
  padding: 10px 10px 10px 10px;
}

.reveal pre code {
  max-height: none;
}

.reveal code {
  font-family: 'Inconsolata', 'AR PL Ukai CN', 'STKaiti', 'KaiTi', 'Sans Serif', Monospace;
}

.reveal .middle blockquote {
  text-align: center;
  color: rgb(106, 0, 95);
  background: none;
  box-shadow: none;
}

.reveal .middle blockquote a {
  color: inherit;
}

.reveal blockquote p, .reveal blockquote li {
  font-family: 'Lato', 'AR PL Ukai CN', 'STKaiti', 'KaiTi', 'Sans Serif';
}

section .center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.reveal .author-block {
  margin: 75px 0 35px 0;
}
.reveal .author-affiliation img {
  margin: 15px 0 0 0;
}
.reveal .author-block p, .reveal .author-affiliation p  {
  font-family: 'Kaiti', 'STKaiti', 'Serif', 'Times', 'Times New Roman';
  margin-block-start: 0em;
  margin-block-end: 0em;
}
.reveal .author-affiliation {
  display: inline-block;
  font-size: 90%;
}
.reveal hr {
  border: 10px solid rgba(0, 0, 0, 0);
}
.reveal li {
  margin-top: 10px;
}
</style>

  <title>&#25968;&#25454;&#30340;&#26426;&#22120;&#32423;&#34920;&#31034;</title>
</head>

<body class="d-flex flex-column h-100">
  
  

<div class="reveal">
<div class="slides">
   
    <section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="_1" class=" text-2xl mt-2 font-sans">&#25968;&#25454;&#30340;&#26426;&#22120;&#32423;&#34920;&#31034;</h1>
<p class=" font-serif my-1"><include src="Slides_Author"><div><div class="py-16">
<p class=" font-serif my-1"><a href="http://ics.nju.edu.cn/~jyy" class=" text-amber-900">&#33931;&#28814;&#23721;</a></p>
</div>
<div class="row">
<div class="author-affiliation">
    <a href="http://www.nju.edu.cn/" class=" text-amber-900"><p class=" font-serif my-1">&#12288;&#12288;&#21335;&#20140;&#22823;&#23398;&#12288;&#12288;</p>
    <img class="inline-img h-24" src="../../../static/img/nju-logo.jpg" style="display: inline-block;"></a>
  </div>
<div class="author-affiliation">
   <a href="http://cs.nju.edu.cn/" class=" text-amber-900"><p class=" font-serif my-1">&#35745;&#31639;&#26426;&#31185;&#23398;&#19982;&#25216;&#26415;&#31995;</p>
    <img class="inline-img h-24" src="../../../static/img/njucs-logo.jpg" style="display: inline-block;"></a>
  </div>
<div class="author-affiliation">
    <a href="https://cs.nju.edu.cn/ics/" class=" text-amber-900"><p class=" font-serif my-1">&#35745;&#31639;&#26426;&#36719;&#20214;&#30740;&#31350;&#25152;</p>
    <img class="inline-img h-24" src="../../../static/img/ics-logo.png" style="display: inline-block;"></a>
  </div>
</div></div></include></p></div></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">&#25552;&#37266;</h2>
<p class=" font-serif my-1">&#35831;&#22823;&#23478;&#21450;&#26102;&#20851;&#27880;&#35838;&#31243;&#32593;&#31449;&#21457;&#24067;&#30340;&#20316;&#19994;</p>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<p class=" font-serif my-1">HW2/Lab2 &#24050;&#21457;&#24067;</p>
<p class=" font-serif my-1">PA2.2 &#24050;&#20020;&#36817;&#25130;&#27490;</p>
</blockquote>
<hr>
<p class=" font-serif my-1">&#20197;&#21508;&#20301;&#30340;&#24179;&#22343;&#27700;&#20934;&#26469;&#30475;&#65292;&#23436;&#25104; PA &#30340;&#26102;&#38388;&#26159;&#38271;&#20110;&#39044;&#20272;&#26102;&#38388;&#30340;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#22914;&#26524;&#36824;&#27809;&#26377;&#24320;&#22987;&#8230;&#8230;</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">&#26412;&#35762;&#27010;&#36848;</h2>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<p class=" font-serif my-1">&#25105;&#20204;&#24050;&#32463;&#30693;&#36947;&#25968;&#25454;&#26159;&#22914;&#20309;&#22312;&#35745;&#31639;&#26426;&#20013;&#34920;&#31034;&#30340;&#12290;&#20294;&#20026;&#20160;&#20040;&#35201;&#36825;&#26679;&#34920;&#31034;&#65311;&#36825;&#26679;&#30340;&#34920;&#31034;&#26377;&#20160;&#20040;&#22909;&#22788;&#21644;&#29992;&#27861;&#65311;</p>
</blockquote>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#20301;&#36816;&#31639;&#19982;&#21333;&#25351;&#20196;&#22810;&#25968;&#25454;</li>
<li class=" ml-8">&#25972;&#25968;&#28322;&#20986;&#19982; Undefined Behavior</li>
<li class=" ml-8">IEEE754 &#28014;&#28857;&#25968;</li>
</ul></div>
        
      
      </section>
    
    </section>
   
    <section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="_1" class=" text-2xl mt-2 font-sans">&#20301;&#36816;&#31639;&#19982;&#21333;&#25351;&#20196;&#22810;&#25968;&#25454;</h1></div></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">&#20026;&#20160;&#20040;&#20250;&#26377;&#20301;&#36816;&#31639;&#65311;</h2>
<p class=" font-serif my-1">&#36923;&#36753;&#38376;&#21644;&#23548;&#32447;&#26159;&#26500;&#25104;&#35745;&#31639;&#26426; (&#32452;&#21512;&#36923;&#36753;&#30005;&#36335;) &#30340;&#22522;&#26412;&#21333;&#20803;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#20301;&#36816;&#31639;&#26159;&#29992;&#30005;&#36335;&#26368;&#23481;&#26131;&#23454;&#29616;&#30340;&#36816;&#31639;<ul class=" list-disc font-serif">
<li class=" ml-8"><code>&amp;</code> (&#19982;), <code>|</code> (&#25110;), <code>~</code> (&#38750;)</li>
<li class=" ml-8"><code>^</code> (&#24322;&#25110;)</li>
<li class=" ml-8"><code>&lt;&lt;</code> (&#24038;&#31227;&#20301;), <code>&gt;&gt;</code> (&#21491;&#31227;&#20301;)</li>
<li class=" ml-8">&#20363;&#23376;&#65306;&#19968;&#20195;&#20256;&#22855;&#22788;&#29702;&#22120; 8-bit <a href="https://www.masswerk.at/6502/6502_instruction_set.html" class=" text-amber-900">MOS 6502</a><ul class=" list-disc font-serif">
<li class=" ml-8">3510 &#26230;&#20307;&#31649;&#65307;56 &#26465;&#25351;&#20196;&#65292;&#31639;&#25968;&#25351;&#20196;&#20165;&#26377;&#21152;&#20943;&#27861;&#21644;&#20301;&#36816;&#31639;</li>
</ul>
</li>
</ul>
</li>
<li class=" ml-8">&#25968;&#23398;&#19978;&#33258;&#28982;&#30340;&#25972;&#25968;&#38656;&#35201;&#23454;&#29616;&#25104;&#22266;&#23450;&#38271;&#24230;&#30340; 01 &#23383;&#31526;&#20018;</li>
</ul></div>
        
      
         <div class="fragment"> 
        <div><hr>
<p class=" font-serif my-1">&#20064;&#39064;&#65306;&#29992;&#19978;&#36848;&#20301;&#36816;&#31639;&#21644;&#24120;&#25968;&#23454;&#29616; 4 &#20301;&#25972;&#25968;&#30340;&#21152;&#27861;&#36816;&#31639;/Lab1</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#21152;&#27861;&#27604;&#19978;&#36848;&#36816;&#31639;&#22312;&#30005;&#36335;&#19978;&#23454;&#29616; fundamentally &#26356;&#22256;&#38590; (&#20026;&#20160;&#20040;&#65311;)<ul class=" list-disc font-serif">
<li class=" ml-8">&#8220;Circuit Complexity&#8221;</li>
</ul>
</li>
</ul></div>
         </div> 
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="bit-string" class=" text-xl mt-2 pb-2 font-sans">&#25972;&#25968;&#65306;&#22266;&#23450;&#38271;&#24230;&#30340; Bit String</h2>
<p class=" font-serif my-1"><code>142857 -&gt; 0000 0000 0000 0010 0010 1110 0000 1001</code></p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#20551;&#35774; 32-bit &#25972;&#25968;&#65307;&#32422;&#23450; MSB &#22312;&#24038;&#65292;LSB &#22312;&#21491;</li>
</ul>
<hr>
<p class=" font-serif my-1">&#28909;&#36523;&#38382;&#39064;&#65306;&#23383;&#31526;&#20018;&#25805;&#20316;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#20998;&#21035;&#21462;&#20986; 4 &#20010;&#23383;&#33410;</li>
<li class=" ml-8">&#20132;&#25442;&#39640;/&#20302; 16 &#20301;</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">&#21333;&#25351;&#20196;&#22810;&#25968;&#25454;</h2>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<p class=" font-serif my-1"><code>&amp;</code>, <code>|</code>, <code>~</code>, ... &#23545;&#20110;&#25972;&#25968;&#37324;&#30340;&#27599;&#19968;&#20010; bit &#26469;&#35828;&#26159;<red>&#29420;&#31435;</red> (&#24182;&#34892;) &#30340;</p>
</blockquote>
<p class=" font-serif my-1">&#22914;&#26524;&#25105;&#20204;&#25805;&#20316;&#30340;&#23545;&#35937;&#21018;&#22909;&#27599;&#19968;&#20010; bit &#26159;&#29420;&#31435;&#30340;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#25105;&#20204;&#22312;&#19968;&#26465;&#25351;&#20196;&#37324;&#23601;&#23454;&#29616;&#20102;&#22810;&#20010;&#25805;&#20316;</li>
<li class=" ml-8">SIMD (Single Instruction, Multiple Data)</li>
</ul>
<hr>
<p class=" font-serif my-1">&#20363;&#23376;&#65306;Bit Set</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">32-bit &#25972;&#25968; $x \to S \subseteq \{0,1,2,\ldots,31\}$</li>
<li class=" ml-8">&#20301;&#36816;&#31639;&#26159;&#23545;&#25152;&#26377; bit <red>&#21516;&#26102;</red>&#23436;&#25104;&#30340;<ul class=" list-disc font-serif">
<li class=" ml-8">C++ &#20013;&#26377; <code>bitset</code>&#65292;&#24615;&#33021;&#38750;&#24120;&#21487;&#35266;</li>
</ul>
</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="bit-set" class=" text-xl mt-2 pb-2 font-sans">Bit Set: &#22522;&#26412;&#25805;&#20316;</h2>
<p class=" font-serif my-1">&#27979;&#35797; $x\in S$</p>
<ul class=" list-disc font-serif">
<li class=" ml-8"><code>(S &gt;&gt; x) &amp; 1</code></li>
</ul>
<p class=" font-serif my-1">&#27714; $S' = S\cup{x}$</p>
<ul class=" list-disc font-serif">
<li class=" ml-8"><code>S | (1 &lt;&lt; x)</code></li>
</ul>
<p class=" font-serif my-1">&#26356;&#22810;&#20064;&#39064;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#27714; $|S|$</li>
<li class=" ml-8">&#27714; $S_1 \cup S_2$, $S_1 \cap S_2$</li>
<li class=" ml-8">&#27714; $S_1 \setminus S_2$</li>
<li class=" ml-8">&#36941;&#21382; $S$ &#20013;&#30340;&#25152;&#26377;&#20803;&#32032; (foreach)</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="bit-set-s" class=" text-xl mt-2 pb-2 font-sans">Bit Set: &#27714; $|S|$</h2>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">bitset_size</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">32</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">bitset_contains</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">bitset_size1</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// SIMD</span>
<span class="w">  </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x55555555</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">S</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x55555555</span><span class="p">);</span>
<span class="w">  </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x33333333</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">S</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x33333333</span><span class="p">);</span>
<span class="w">  </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0F0F0F0F</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">S</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0F0F0F0F</span><span class="p">);</span>
<span class="w">  </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x00FF00FF</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">S</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x00FF00FF</span><span class="p">);</span>
<span class="w">  </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0000FFFF</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">S</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0000FFFF</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">S</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="bit-set-snevarnothing" class=" text-xl mt-2 pb-2 font-sans">Bit Set: &#36820;&#22238; $S\ne\varnothing$ &#20013;&#30340;&#26576;&#20010;&#20803;&#32032;</h2>
<p class=" font-serif my-1">&#26377;&#20108;&#36827;&#21046;&#25968;<code>x = 0b+++++100</code>&#65292;&#25105;&#20204;&#24076;&#26395;&#24471;&#21040;&#26368;&#21518;&#37027;&#20010;<code>100</code></p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#24819;&#27861;&#65306;&#20351;&#29992;&#22522;&#26412;&#25805;&#20316;&#26500;&#36896;&#19968;&#20123;&#32467;&#26524;&#65292;&#33021;&#25226;<code>+++++</code>&#30340;&#37096;&#20998;&#32473;&#25269;&#28040;&#25481;</li>
</ul>
<table>
<thead>
<tr>
<th>&#34920;&#36798;&#24335;</th>
<th>&#32467;&#26524;</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code></td>
<td><code>0b+++++100</code></td>
</tr>
<tr>
<td><code>x-1</code></td>
<td><code>0b+++++011</code></td>
</tr>
<tr>
<td><code>~x</code></td>
<td><code>0b-----011</code></td>
</tr>
<tr>
<td><code>~x+1</code></td>
<td><code>0b-----100</code></td>
</tr>
</tbody>
</table></div>
        
      
         <div class="fragment"> 
        <div><p class=" font-serif my-1">&#19968;&#20123;&#26377;&#36259;&#30340;&#24335;&#23376;&#65306;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8"><code>x &amp; (x-1)</code> &#8594; <code>0b+++++000</code>&#65307;<code>x ^ (x-1)</code> &#8594; <code>0b00000111</code></li>
<li class=" ml-8"><code>x &amp; (~x+1)</code> &#8594; <code>0b00000100</code> (lowbit&#65039;)<ul class=" list-disc font-serif">
<li class=" ml-8"><code>x &amp; -x</code>, <code>(~x &amp; (x-1)) + 1</code> &#37117;&#21487;&#20197;&#23454;&#29616; lowbit</li>
<li class=" ml-8">&#21482;&#36941;&#21382;&#23384;&#22312;&#30340;&#20803;&#32032;&#21487;&#20197;&#21152;&#36895;&#27714; $|S|$</li>
</ul>
</li>
</ul></div>
         </div> 
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="bit-set-lfloor-log_2x-rfloor" class=" text-xl mt-2 pb-2 font-sans">Bit Set: &#27714; $\lfloor \log_2(x) \rfloor$</h2>
<p class=" font-serif my-1">&#31561;&#21516;&#20110; $31 - \mathrm{clz}(x)$</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">clz</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0x0000ffff</span><span class="p">)</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;=</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0x00ffffff</span><span class="p">)</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+=</span><span class="w">  </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0x0fffffff</span><span class="p">)</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+=</span><span class="w">  </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0x3fffffff</span><span class="p">)</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+=</span><span class="w">  </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0x7fffffff</span><span class="p">)</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<hr>
<p class=" font-serif my-1">(&#22855;&#24618;&#30340;&#20195;&#30721;) &#20551;&#35774; $x$ &#26159; <code>lowbit</code> &#24471;&#21040;&#30340;&#32467;&#26524;&#65311;</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="cp">#define LOG2(x) \</span>
<span class="cp">  ("-01J2GK-3@HNL;-=47A-IFO?M:&lt;6-E&gt;95D8CB"[(x) % 37] - '0')</span>
</code></pre></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="bit-set-lfloor-log_2x-rfloor-contd" class=" text-xl mt-2 pb-2 font-sans">Bit Set: &#27714; $\lfloor \log_2(x) \rfloor$ (cont'd)</h2>
<p class=" font-serif my-1">&#29992;&#19968;&#28857;&#28857;&#20803;&#32534;&#31243; (meta-programming)&#65307;&#35797;&#19968;&#35797; <a href="../../../pages/ICS/2020/demos/log2.c" class=" text-amber-900">log2.c</a></p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kn">import</span> <span class="nn">json</span>

<span class="n">n</span><span class="p">,</span> <span class="n">base</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="s1">'0'</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">10000</span><span class="p">):</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">({</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">m</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">})</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
    <span class="n">M</span> <span class="o">=</span> <span class="p">{</span> <span class="n">j</span><span class="p">:</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">base</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">m</span> <span class="o">==</span> <span class="n">j</span> <span class="p">}</span>
    <span class="k">break</span>

<span class="n">magic</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
  <span class="p">[</span> <span class="n">M</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="p">]</span>
  <span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">'"'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'#define LOG2(x) ("</span><span class="si">{</span><span class="n">magic</span><span class="si">}</span><span class="s1">"[(x) % </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s1">] - </span><span class="se">\'</span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="se">\'</span><span class="s1">)'</span><span class="p">)</span>
</code></pre></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">&#19968;&#26412;&#26377;&#36259;&#30340;&#21442;&#32771;&#20070;</h2>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<p class=" font-serif my-1">Henry S. Warren, Jr. <em>Hacker's Delight</em> (2ed), Addison-Wesley, 2012.</p>
</blockquote>
<p class=" font-serif my-1"><img alt="" class="float-right" src="../../../pages/ICS/2020/slides/img/hackers-delight.jpg" width="200px"></p>
<p class=" font-serif my-1">&#35753;&#20320;&#29702;&#35299;&#20889;&#20986;&#26356;&#24555;&#30340;&#20195;&#30721;&#24182;&#19981;&#26159; &#8220;&#30606;&#29468;&#8221;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#20027;&#35201;&#20869;&#23481;&#26159;&#21508;&#31181;&#25968;&#23398; (&#24102;&#26469;&#30340;&#20195;&#30721;&#20248;&#21270;)</li>
<li class=" ml-8">&#23448;&#26041;&#32593;&#31449;&#65306;<a href="http://hackersdelight.org/" class=" text-amber-900">hackersdelight.org</a></li>
<li class=" ml-8">&#35265;&#35782;&#19968;&#19979;&#30495;&#27491;&#30340; &#8220;&#22855;&#25216;&#28139;&#24039;&#8221;</li>
</ul></div>
        
      
      </section>
    
    </section>
   
    <section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="undefined-behavior" class=" text-2xl mt-2 font-sans">&#25972;&#25968;&#28322;&#20986;&#19982; Undefined Behavior</h1></div></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="undefined-behavior-ub" class=" text-xl mt-2 pb-2 font-sans">Undefined Behavior (UB)</h2>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<p class=" font-serif my-1"><em>Undefined behavior</em> (UB) is the result of executing computer code whose behavior is not prescribed by the language specification to which the code adheres, for the current state of the program. This happens when the translator of the source code makes certain assumptions, but these assumptions are not satisfied during execution. -- Wikipedia</p>
</blockquote>
<p class=" font-serif my-1">C &#23545; UB &#30340;&#34892;&#20026;&#26159;&#19981;&#20570;&#20219;&#20309;&#32422;&#26463;&#30340;&#65292;&#25226;<font color="red">&#30005;&#33041;&#28856;&#20102;</font>&#37117;&#34892;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#24120;&#35265;&#30340; UB&#65306;&#38750;&#27861;&#20869;&#23384;&#35775;&#38382; (&#31354;&#25351;&#38024;&#35299;&#24341;&#29992;&#12289;&#25968;&#32452;&#36234;&#30028;&#12289;&#20889;&#21482;&#35835;&#20869;&#23384;&#31561;)&#12289;&#34987;&#38646;&#38500;&#12289;&#26377;&#31526;&#21495;&#25972;&#25968;&#28322;&#20986;&#12289;&#20989;&#25968;&#27809;&#26377;&#36820;&#22238;&#20540;&#8230;&#8230;<ul class=" list-disc font-serif">
<li class=" ml-8">&#36890;&#24120;&#30340;&#21518;&#26524;&#27604;&#36739;&#36731;&#24494;&#65292;&#27604;&#22914; wrong answer, crash</li>
</ul>
</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="cc-ub" class=" text-xl mt-2 pb-2 font-sans">&#20026;&#20160;&#20040; C/C++ &#20250;&#26377; UB&#65311;</h2>
<p class=" font-serif my-1">&#20026;&#20102;&#23613;&#21487;&#33021;&#39640;&#25928; (zero-overhead)</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#19981;&#21512;&#27861;&#30340;&#20107;&#24773;&#30340;&#21518;&#26524;&#21482;&#22909; undefined &#20102;</li>
<li class=" ml-8">Java, js, python, ... &#36873;&#25321;&#25152;&#26377;&#25805;&#20316;&#37117;&#36827;&#34892;&#21512;&#27861;&#24615;&#26816;&#26597;</li>
</ul>
<hr>
<p class=" font-serif my-1">&#20026;&#20102;&#20860;&#23481;&#22810;&#31181;&#30828;&#20214;&#20307;&#31995;&#32467;&#26500;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#26377;&#20123;&#30828;&#20214; <code>/0</code> &#20250;&#20135;&#29983;&#22788;&#29702;&#22120;&#24322;&#24120;</li>
<li class=" ml-8">&#26377;&#20123;&#30828;&#20214;&#21861;&#20063;&#19981;&#21457;&#29983;</li>
<li class=" ml-8">&#21482;&#22909; undefined &#20102;</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="undefined-behavior" class=" text-xl mt-2 pb-2 font-sans">Undefined Behavior: &#19968;&#20010;&#21382;&#21490;&#24615;&#30340;&#21253;&#34993;</h2>
<p class=" font-serif my-1">&#22475;&#19979;&#20102;&#28798;&#38590;&#30340;&#31181;&#23376;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">CVE: <em>Common Vulnerabilities and Exposures</em>&#65292;&#20844;&#24320;&#21457;&#24067;&#36719;&#20214;&#20013;&#30340;&#28431;&#27934;<ul class=" list-disc font-serif">
<li class=" ml-8">buffer/integer overflow &#24120;&#24180;&#21344;&#25454; CVE &#30340;&#19968;&#24109;&#20043;&#22320;</li>
<li class=" ml-8">&#39640;&#21361;&#28431;&#27934;&#35753;&#27809;&#26377;&#20462;&#34917;&#30340;&#26426;&#22120;&#31435;&#39532;&#23445;&#128020;/&#21464;&#25104;&#32905;&#128020;</li>
</ul>
</li>
</ul>
<hr>
<p class=" font-serif my-1">&#20363;&#23376;&#65306;<a href="https://nvd.nist.gov/vuln/detail/CVE-2018-7445" class=" text-amber-900">CVE-2018-7445</a> (RouterOS), &#20165;&#20165;&#26159;&#24536;&#35760;&#26816;&#26597;&#32531;&#20914;&#21306;&#22823;&#23567;&#8230;&#8230;</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">offset</span><span class="p">;</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">offset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">dst</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">src</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">src</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="p">...</span>
<span class="w">  </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="undefined-behavior" class=" text-xl mt-2 pb-2 font-sans">Undefined Behavior: &#35686;&#24789;&#25972;&#25968;&#28322;&#20986;</h2>
<table>
<thead>
<tr>
<th style="text-align: center;">&#34920;&#36798;&#24335;</th>
<th style="text-align: center;">&#20540;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>UINT_MAX+1</code></td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><code>INT_MAX+1; LONG_MAX+1</code></td>
<td style="text-align: center;"><font color="red">undefined</font></td>
</tr>
<tr>
<td style="text-align: center;"><code>char c = CHAR_MAX; c++;</code></td>
<td style="text-align: center;"><font color="blue">varies</font> (???)</td>
</tr>
<tr>
<td style="text-align: center;"><code>1 &lt;&lt; -1</code></td>
<td style="text-align: center;"><font color="red">undefined</font></td>
</tr>
<tr>
<td style="text-align: center;"><code>1 &lt;&lt; 0</code></td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;"><code>1 &lt;&lt; 31</code></td>
<td style="text-align: center;"><font color="red">undefined</font></td>
</tr>
<tr>
<td style="text-align: center;"><code>1 &lt;&lt; 32</code></td>
<td style="text-align: center;"><font color="red">undefined</font></td>
</tr>
<tr>
<td style="text-align: center;"><code>1 / 0</code></td>
<td style="text-align: center;"><font color="red">undefined</font></td>
</tr>
<tr>
<td style="text-align: center;"><code>INT_MAX % -1</code></td>
<td style="text-align: center;"><font color="red">undefined</font></td>
</tr>
</tbody>
</table>
<ul class=" list-disc font-serif">
<li class=" ml-8">W. Dietz, et al. Understanding integer overflow in C/C++. In <em>Proceedings of ICSE</em>, 2012.</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">&#25972;&#25968;&#28322;&#20986;&#21644;&#32534;&#35793;&#20248;&#21270;</h2>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">f</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>

<p class=" font-serif my-1">&#26681;&#25454;&#25163;&#20876;&#65292;&#36825;&#26159;&#20010; UB&#65292;&#20110;&#26159; clang &#36825;&#26679;&#22788;&#32622;&#8230;&#8230;</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code>0000000000000000 &lt;f&gt;:
   0:   c3      retq
</code></pre></div>

<hr>
<p class=" font-serif my-1">&#32534;&#35793;&#22120;&#25226;&#36825;&#20010;&#35745;&#31639;&#30452;&#25509;&#21024;&#38500;&#20102;</p>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<p class=" font-serif my-1">W. Xi, et al. Towards optimization-safe systems: Analyzing the impact of undefined behavior. In <em>Proceedings of SOSP</em>, 2013.</p>
</blockquote></div>
        
      
      </section>
    
    </section>
   
    <section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="ieee-754" class=" text-2xl mt-2 font-sans">&#28014;&#28857;&#25968;&#65306;IEEE 754</h1></div></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">&#23454;&#25968;&#30340;&#35745;&#31639;&#26426;&#34920;&#31034;</h2>
<p class=" font-serif my-1">&#23454;&#25968;&#38750;&#24120;&#38750;&#24120;&#22810; ($\aleph_0 &lt; \mathfrak c$)</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#21482;&#33021;&#29992; 32/64-bit 01 &#20018;&#26469;&#34920;&#31034;<red>&#19968;&#23567;&#37096;&#20998;</red>&#23454;&#25968;<ul class=" list-disc font-serif">
<li class=" ml-8">&#30830;&#23450;&#19968;&#31181;&#26144;&#23556;&#26041;&#27861;&#65292;&#25226;&#19968;&#20010; 01 &#20018;&#26144;&#23556;&#21040;&#19968;&#20010;&#23454;&#25968;<ul class=" list-disc font-serif">
<li class=" ml-8">&#36816;&#31639;&#36215;&#26469;&#19981;&#22826;&#40635;&#28902;</li>
<li class=" ml-8">&#35745;&#31639;&#35823;&#24046;&#19981;&#22826;&#21487;&#24597;</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<p class=" font-serif my-1">&#20110;&#26159;&#26377;&#20102; IEEE754 (1bit S, 23/52bits Fraction, 8/11bits Exponent)</p>
<p class=" font-serif my-1">$$x = (-1)^S \times (1.F) \times 2^{E - B}$$</p>
<p class=" font-serif my-1"><img alt="" class="center" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e8/IEEE_754_Single_Floating_Point_Format.svg/1200px-IEEE_754_Single_Floating_Point_Format.svg.png"></p></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="ieee754" class=" text-xl mt-2 pb-2 font-sans">IEEE754: &#20320;&#21487;&#33021;&#19981;&#30693;&#36947;&#30340;&#20107;&#23454;</h2>
<p class=" font-serif my-1">&#19968;&#20010;&#26377;&#20851;&#28014;&#28857;&#25968;&#22823;&#23567;/&#23494;&#24230;&#30340;&#23454;&#39564; (<a href="../../../pages/ICS/2020/demos/float.c" class=" text-amber-900">float.c</a>)</p></div>
        
      
         <div class="fragment"> 
        <div><hr>
<p class=" font-serif my-1">&#36234;&#22823;&#30340;&#25968;&#23383;&#65292;&#36317;&#31163;&#19979;&#19968;&#20010;&#23454;&#25968;&#30340;&#36317;&#31163;&#23601;&#36234;&#22823;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#21487;&#33021;&#20250;&#24102;&#26469;&#30456;&#24403;&#30340;&#32477;&#23545;&#35823;&#24046;</li>
<li class=" ml-8">&#22240;&#27492;&#24456;&#22810;&#25968;&#23398;&#24211;&#37117;&#20250;&#39057;&#32321;&#20570;&#24402;&#19968;&#21270;</li>
</ul>
<hr>
<p class=" font-serif my-1">&#20363;&#23376;&#65306;&#35745;&#31639; $1 + \frac{1}{2} + \frac{1}{3} + \ldots + \frac{1}{n}$</p>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="cp">#define SUM(T, st, ed, d) ({ \</span>
<span class="cp">  T s = 0; \</span>
<span class="cp">  for (int i = st; i != ed + d; i += d) \</span>
<span class="cp">    s += (T)1 / i; \</span>
<span class="cp">  s; \</span>
<span class="cp">})</span>
</code></pre></div>

<ul class=" list-disc font-serif">
<li class=" ml-8">&#28014;&#28857;&#25968;&#65306;$ (a + b) + c \ne a + (b + c)$</li>
</ul></div>
         </div> 
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="ieee754-contd" class=" text-xl mt-2 pb-2 font-sans">IEEE754: &#20320;&#21487;&#33021;&#19981;&#30693;&#36947;&#30340;&#20107;&#23454; (cont'd)</h2>
<p class=" font-serif my-1">&#27604;&#36739;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8"><code>a == b</code> &#38656;&#35201;&#35880;&#24910;&#21028;&#26029; (&#35201;&#20551;&#35774;&#33258;&#24102; $\varepsilon$)</li>
</ul>
<hr>
<p class=" font-serif my-1">&#38750;&#35268;&#26684;&#21270;&#25968; (Exponent == 0)</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">$x = (-1)^S \times (0.F) \times 2^{-126}$</li>
</ul>
<hr>
<p class=" font-serif my-1">&#38646;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8"><code>+0.0</code>, <code>-0.0</code> &#30340; $S$ bit &#26159;&#19981;&#19968;&#26679;&#30340;&#65292;&#20294; <code>+0.0 == -0.0</code></li>
</ul>
<hr>
<p class=" font-serif my-1">Inf/NaN (Not a Number)</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">Inf: &#28014;&#28857;&#25968;&#28322;&#20986;&#24456;&#24120;&#35265;&#65292;&#19981;&#24212;&#35813;&#20316;&#20026; undefined behavior</li>
<li class=" ml-8">NaN (<code>0.0/0.0</code>): &#33021;&#22815;&#28385;&#36275; <code>x != x</code> &#34920;&#36798;&#24335;&#30340;&#20540;</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="ieee754" class=" text-xl mt-2 pb-2 font-sans">IEEE754&#65306;&#24322;&#24120;&#22797;&#26434;</h2>
<p class=" font-serif my-1">&#38500;&#20102; $x = (-1)^S \times (1.F) \times 2^{E - B}$&#65292;&#36824;&#35201;&#32771;&#34385;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#38750;&#35268;&#26684;&#21270;&#25968;, +0.0/-0.0, Inf, NaN<ul class=" list-disc font-serif">
<li class=" ml-8">&#19968;&#24230;&#24341;&#36215;&#20102;&#30828;&#20214;&#21378;&#21830;&#30340;&#20247;&#24594; (&#30896;&#21040;&#38750;&#35268;&#26684;&#25968;&#24178;&#33030;&#36719;&#20214;&#27169;&#25311;&#21543;)</li>
<li class=" ml-8">&#24456;&#22810;&#8220;&#23545;&#28014;&#28857;&#25968;&#31934;&#24230;&#35201;&#27714;&#19981;&#39640;&#8221;&#30828;&#20214;&#21378;&#21830;&#36873;&#25321;&#19981;&#20860;&#23481; IEEE 754 (&#27604;&#22914;&#21508;&#31181; GPU &#21046;&#36896;&#21830;)</li>
<li class=" ml-8">Nvidia &#20174; Fermi &#25165;&#24320;&#22987;&#23436;&#25972;&#25903;&#25345; IEEE754 (2010)</li>
</ul>
</li>
</ul>
<hr>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<p class=" font-serif my-1"><a href="https://people.eecs.berkeley.edu/~wkahan/ieee754status/754story.html" class=" text-amber-900">An interview with the old man of floating-point</a>. Reminiscences elicited from <a href="http://http.cs.berkeley.edu/~wkahan/" class=" text-amber-900">William Kahan </a>by <a href="http://www.dr-chuck.com/" class=" text-amber-900">Charles Severance</a>.</p>
</blockquote></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="frac-b-sqrtb2-4ac2a" class=" text-xl mt-2 pb-2 font-sans">&#20363;&#23376;&#65306;&#35745;&#31639; $\frac{-b - \sqrt{b^2-4ac}}{2a}$</h2>
<p class=" font-serif my-1">&#22914;&#26524;&#32771;&#34385;&#27604;&#36739;&#26497;&#31471;&#30340;&#25968;&#20540;&#26465;&#20214;&#65311;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#28040;&#21435;&#35823;&#24046;: $-b$ v.s. $ \sqrt{b^2-4ac} $ (catastrophic cancellation)<ul class=" list-disc font-serif">
<li class=" ml-8">&#36824;&#35760;&#24471; <code>x + 1.0 == x</code> &#30340;&#20363;&#23376;&#21527;</li>
</ul>
</li>
<li class=" ml-8">&#28322;&#20986;: $b^2$</li>
</ul>
<hr>
<p class=" font-serif my-1">&#19968;&#20010;&#26356;&#22909;&#30340;&#19968;&#20803;&#20108;&#27425;&#26041;&#31243;&#27714;&#26681;&#20844;&#24335;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">$\frac{(-b)^2 - (\sqrt{b^2-4ac})^2}{ (-b) + \sqrt{b^2-4ac}} /2a = \frac{4ac}{(-b)+\sqrt{b^2-4ac}}/2a $ ($b &lt; 0$)</li>
<li class=" ml-8">$(-b-\sqrt{b^2-4ac}) \cdot \frac{1}{2a}$ ($0\le b\le 10^{127}$)</li>
<li class=" ml-8">$-\frac{b}{a}+\frac{c}{b}$ ($b &gt; 10^{127}$)<ul class=" list-disc font-serif">
<li class=" ml-8">P. Panchekha, et al. Automatically improving accuracy for floating point expressions. In <em>Proc. of PLDI</em>, 2015.</li>
</ul>
</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">&#20973;&#20160;&#20040;&#65311;</h2>
<blockquote class=" bg-gray-200 p-2 rounded mb-2 mt-2 mx-4">
<p class=" font-serif my-1">It looked pretty complicated. On the other hand, we had a rationale for everything. -- <a href="http://http.cs.berkeley.edu/~wkahan/" class=" text-amber-900">William Kahan</a>, 1989 ACM Turing Award Winner for his <em>fundamental contributions to numerical analysis</em>.</p>
</blockquote>
<p class=" font-serif my-1"></p><center>&#28014;&#28857;&#25968;&#21487;&#20197;&#30452;&#25509;&#24403;&#25104;&#25972;&#25968;&#27604;&#36739;&#22823;&#23567;</center>
<p class=" font-serif my-1"></p><center><code>+0.0/-0.0</code> &#21644; Inf &#20445;&#35777; $(1/x)/x$ &#19981;&#20250;&#21457;&#29983; sign shift</center>
<p class=" font-serif my-1"></p><center>&#8230;&#8230;</center>
<p class=" font-serif my-1">IEEE754 &#22825;&#25165;&#30340;&#35774;&#35745;&#20445;&#35777;&#20102;&#25968;&#20540;&#35745;&#31639;&#30340;&#31283;&#23450;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#22914;&#26524;&#24819;&#20102;&#35299; IEEE754&#65292;&#35831;&#38405;&#35835; D. Goldberg. <a href="https://dl.acm.org/citation.cfm?id=103163" class=" text-amber-900">What every computer scientist should know about floating-point arithmetic</a>. <em>ACM Computing Surveys</em>, 23(1), 1991.</li>
</ul></div>
        
      
      </section>
    
    </section>
   
    <section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="_1" class=" text-2xl mt-2 font-sans">&#25968;&#25454;&#30340;&#26426;&#22120;&#32423;&#34920;&#31034;&#65306;&#32508;&#21512;&#26696;&#20363;</h1></div></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="1sqrtx" class=" text-xl mt-2 pb-2 font-sans">&#26696;&#20363;&#65306;&#35745;&#31639; $1/\sqrt{x}$</h2>
<p class=" font-serif my-1">&#24212;&#29992;&#65306;Surface Norm</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#24179;&#38754;&#30340;&#27861;&#21521;&#37327;<ul class=" list-disc font-serif">
<li class=" ml-8">&#29992;&#20110;&#35745;&#31639;&#20809;&#29031;/&#21453;&#23556;</li>
<li class=" ml-8"><del>&#31532;&#19968;&#27425;&#24863;&#35273;&#25968;&#23398;&#27966;&#19978;&#20102;&#29992;&#22330;</del></li>
</ul>
</li>
<li class=" ml-8">&#35745;&#31639;&#26041;&#27861;<ul class=" list-disc font-serif">
<li class=" ml-8">&#24130;&#32423;&#25968;&#23637;&#24320;</li>
<li class=" ml-8">&#20108;&#20998;&#27861;</li>
<li class=" ml-8">&#29275;&#39039;&#27861;&#8230;&#8230;</li>
</ul>
</li>
</ul>
<hr>
<p class=" font-serif my-1">&#22914;&#20309;&#19981;&#20511;&#21161;&#30828;&#20214;&#25351;&#20196;&#65292;&#24555;&#36895; (&#36817;&#20284;) &#35745;&#31639; $f(x)$&#65311;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#20154;&#30524;&#23545;&#20687;&#32032;&#32423;&#30340;&#35823;&#24046;&#24182;&#19981;&#25935;&#24863;&#65292;&#22240;&#27492;&#31639;&#38169;&#19968;&#28857;&#20063;&#27809;&#20107;</li>
<li class=" ml-8">&#24555; 1.5 &#20493;: $ 640 \times 480 \to 800 \times 600 $ (&#36825;&#20010;&#25512;&#23548;&#19981;&#20005;&#26684;)</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="o1" class=" text-xl mt-2 pb-2 font-sans">&#31070;&#22855;&#30340; $O(1)$ &#20195;&#30721;</h2>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kt">float</span><span class="w"> </span><span class="nf">Q_rsqrt</span><span class="p">(</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">union</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">f</span><span class="p">;</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">conv</span><span class="p">;</span>
<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5F</span><span class="p">;</span>
<span class="w">  </span><span class="n">conv</span><span class="p">.</span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="p">;</span>
<span class="w">  </span><span class="n">conv</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x5f3759df</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conv</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">);</span><span class="w"> </span><span class="c1">// ???</span>
<span class="w">  </span><span class="n">conv</span><span class="p">.</span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conv</span><span class="p">.</span><span class="n">f</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">1.5F</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">conv</span><span class="p">.</span><span class="n">f</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">conv</span><span class="p">.</span><span class="n">f</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">conv</span><span class="p">.</span><span class="n">f</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<hr>
<p class=" font-serif my-1">&#30475;&#30475;&#21035;&#20154;&#30340;&#27605;&#19994;&#35774;&#35745;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">Matthew Robertson. <a href="http://localhost:5001/static/wiki/ics/rsqrt.pdf" class=" text-amber-900">A Brief History of InvSqrt</a>, <em>Bachelor Thesis, The University of New Brunswick</em>, 2012.</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="atimes-b-bmod-m" class=" text-xl mt-2 pb-2 font-sans">&#26696;&#20363;&#65306;&#35745;&#31639; $(a\times b) \bmod m$</h2>
<div class="codehilite"><pre class=" bg-gray-100 overflow-x-auto rounded p-2 mb-2 mt-2"><span></span><code><span class="kt">int64_t</span><span class="w"> </span><span class="nf">multimod_fast</span><span class="p">(</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int64_t</span><span class="p">)((</span><span class="kt">double</span><span class="p">)</span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<hr>
<p class=" font-serif my-1">&#20196; $a \times b = p \cdot m + q$</p>
<ul class=" list-disc font-serif">
<li class=" ml-8"><code>a * b</code> &#8594; $(p \cdot m + q) \bmod 2^{64}$</li>
<li class=" ml-8"><code>x</code> &#8594; $(\lfloor \frac{p\cdot m+q}{m} \rfloor \cdot m) \bmod 2^{64}$<ul class=" list-disc font-serif">
<li class=" ml-8">&#22914;&#26524;&#28014;&#28857;&#25968;&#30340;&#31934;&#24230;&#26159;&#26080;&#38480;&#30340;&#65292;$x = (p\cdot m) \bmod 2^{64}$</li>
<li class=" ml-8">&#21516;&#20313;&#23601;&#24471;&#21040;&#20102; $q$</li>
</ul>
</li>
</ul></div>
        
      
      </section>
    
    </section>
   
    <section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="_1" class=" text-2xl mt-2 font-sans">&#24635;&#32467;</h1></div></div></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><h2 id="_1" class=" text-xl mt-2 pb-2 font-sans">&#25968;&#25454;&#30340;&#26426;&#22120;&#32423;&#34920;&#31034;</h2>
<p class=" font-serif my-1"><em>Everything</em> is a bit-string!</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#20294;&#21364;&#33021;&#29609;&#20986;&#24456;&#22810;&#33457;&#26679;&#26469;<ul class=" list-disc font-serif">
<li class=" ml-8">bit-set/SIMD</li>
<li class=" ml-8">&#28014;&#28857;&#25968;&#30340;&#34920;&#31034;</li>
</ul>
</li>
</ul>
<hr>
<p class=" font-serif my-1">PA: &#31105;&#27490;&#20889;&#20986;&#19981;&#21487;&#32500;&#25252;&#30340;&#20195;&#30721;</p>
<ul class=" list-disc font-serif">
<li class=" ml-8">&#22914;&#26524;&#20320;&#24819;&#29609;&#20986;&#33457;&#65292;&#35831;&#20570;&#21512;&#36866;&#30340;&#23553;&#35013;&#21644;&#20805;&#20998;&#30340;&#27979;&#35797;</li>
</ul></div>
        
      
      </section>
    
      
      <section>
      

      
        
        <div><div class="center middle"><div style="width:100%"><h1 id="end" class=" text-2xl mt-2 font-sans">End.</h1></div></div></div>
        
      
      </section>
    
    </section>
  
</div>
</div>

<script src="../../../static/reveal/reveal.js"></script>
<script>
  Reveal.initialize({
    
    width: 1024, height: 768,
    
    slideNumber: 'c/t',
    controlsTutorial: false,
    progress: false,
    hash: true,
    center: false,
    autoAnimateUnmatched: true,
    autoAnimateEasing: 'ease-out',
    autoAnimateDuration: 0.3,
    transitionSpeed: 'fast'
  });
</script>


</body>

</html>